(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[331],{6608:function(e,t,o){"use strict";o.d(t,{Kw:function(){return a},Ky:function(){return i},We:function(){return l}});var n,i,r=o(9107),s=o(9158);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Default,o=t&(i.Default|i.Mono),n=(0,r.yE)(t,i.Italic)?"italic ":"";switch(o){case i.Default:n+="".concat(e,"px Arial");break;case i.Mono:n+="".concat(e,"px monospace")}return n}function a(e,t,o){let n,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#aaa";arguments.length>4&&void 0!==arguments[4]&&arguments[4];let a=e.mulVec3Inv(o.region.min),d=e.mulVec3Inv(o.region.max),c=(0,r.Dw)(o.tileCanvases,"grid1",()=>document.createElement("canvas"));c.width=64,c.height=64;let u=c.getContext("2d");u.save(),u.clearRect(0,0,c.width,c.height),u.beginPath(),u.moveTo(32,32),u.arc(32,32,2,0,2*Math.PI),u.fillStyle=l,u.fill(),u.restore();let p=t.createPattern(c,"repeat");t.save(),t.fillStyle=p,t.translate(.5,.5),t.scale(.015625,.015625),n=a.sub(new s.AO(.5,.5)).mul(64),i=d.sub(new s.AO(.5,.5)).mul(64),t.fillRect(n.x,n.y,i.x-n.x,i.y-n.y),t.restore()}(n=i||(i={}))[n.None=0]="None",n[n.Default=1]="Default",n[n.Mono=2]="Mono",n[n.Italic=4]="Italic"},8293:function(e,t,o){"use strict";o.r(t),o.d(t,{CpuCanvas:function(){return e_}});var n,i,r,s=o(7437),l=o(2265),a=o(5064),d=o(9158),c=o(8035),u=o.n(c),p=o(2343),m=o(9107),f=o(2442),h=o(4603),x=o(8022),g=o(527);function y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.executionSteps;for(let t of(e.runArgs.halt=!1,e.comps))for(let e of t.ports)(0,m.yE)(e.type,h.bS.Tristate)&&(e.ioEnabled=!1);for(let t=0;t<o.length;t++){let n=o[t];if(n.compIdx>=0){let t=e.comps[n.compIdx];t.phases[n.phaseIdx].func(t,e.runArgs)}else{let t=e.nets[n.netIdx];!function(e,t){if(t.tristate){let e=0,o=0;for(let n of t.outputs){let t=n.exePort;n.valid&&t.ioEnabled&&(!(0,m.yE)(t.type,h.bS.InOutTri)||t.ioDir===h.H.Out)&&(e++,o=t.value)}t.enabledCount=e,t.value=1===e?o:0}else if(1!==t.outputs.length)t.value=0;else{let e=t.outputs[0].exePort;t.value=e.value}for(let e of t.inputs)e.exePort.value=t.value}(e.comps,t)}}t||function(e){for(let t of e.comps)for(let e of t.phases)for(let o of[...e.readPortIdxs,...e.writePortIdxs]){let e=t.ports[o];e.dataUsed=(0,m.yE)(e.type,h.bS.Ctrl)||e.ioEnabled}for(let t=e.executionSteps.length-1;t>=0;t--){let o=e.executionSteps[t];if(-1!==o.compIdx){let t=e.comps[o.compIdx],n=t.phases[o.phaseIdx],i=n.writePortIdxs.length>0;for(let e of n.writePortIdxs)if(t.ports[e].dataUsed){i=!1;break}for(let e of[...n.readPortIdxs,...n.writePortIdxs]){let o=t.ports[e];if((0,m.yE)(o.type,h.bS.InOutTri)&&o.ioDir!==h.H.None){i=!1;break}}if(i)for(let e of n.readPortIdxs){let o=t.ports[e];(0,m.yE)(o.type,h.bS.Ctrl)||(o.dataUsed=!1)}}else if(-1!==o.netIdx){let t=e.nets[o.netIdx];if((0,m.yE)(t.type,h.bS.Ctrl))continue;let n=!0;for(let e of t.inputs)if(e.exePort.dataUsed){n=!1;break}if(n)for(let e of t.outputs)e.exePort.dataUsed=!1}}}(e)}function v(e){let t=e.latchSteps;for(let o=0;o<t.length;o++){let n=t[o],i=e.comps[n.compIdx];i.phases[n.phaseIdx].func(i,e.runArgs)}}function b(e,t){for(let n of e.comps){var o;let i=e.compLibrary.getCompDef(n.comp.defId);null===(o=i.reset)||void 0===o||o.call(i,n,t)}}var S=o(9611),w=o.n(S),I=o(6554);let C=()=>{let{editorState:e,setEditorState:t}=(0,f._i)(),{compLibrary:o}=e,n=[...new Set([...o.libraryLookup.values()])],[,i]=(0,I.se)(function(e,o,n){t(e=>{var t;return(null===(t=e.dragCreateComp)||void 0===t?void 0:t.applyFunc)&&(e=(0,f.yC)(n,e.dragCreateComp.applyFunc)(e)),n&&(e=(0,m.v4)(e,{dragCreateComp:void 0})),e})});return(0,s.jsxs)("div",{className:w().libraryView,children:[(0,s.jsx)("div",{className:w().header,children:"Components"}),(0,s.jsx)("div",{className:w().body,children:n.map((o,n)=>(0,s.jsx)("div",{className:w().entry,onMouseDown:n=>{var r;let s;return r=o.compDef,s=e.compLibrary.create(r.defId),void(t(e=>(0,m.v4)(e,{dragCreateComp:{compOrig:s}})),n.preventDefault(),n.stopPropagation(),i(n,0))},children:o.name},n))})]})};var N=o(5945),P=o.n(N),j=o(2845),A=o(2695),O=o(1279),D=o(2759);let T=()=>{let{editorState:e,setEditorState:t,exeModel:o}=(0,f._i)(),[n,i]=(0,l.useState)([]),[r,a]=(0,l.useState)(0);function d(e){let t=u("core/mem/rom0");if(t){let o=t.data.rom;o.set(e.elfSection.arr),o.fill(0,e.elfSection.arr.length),t.data.updateCntr+=1}}async function c(){for(let r of n){d(r),b(o,{hardReset:!1}),y(o);let n=!1;for(let s=0;s<200;s++){if(await new Promise(e=>setTimeout(e,10)),t(e=>({...e})),y(o),o.runArgs.halt){var e,i;let t=p(),o=null!==(e=null==t?void 0:t.data.file[10])&&void 0!==e?e:0,s=null!==(i=null==t?void 0:t.data.file[11])&&void 0!==i?i:0;44!==o&&911!==o?console.log("--- test '".concat(r.name,"' halted with unknown result in reg[a0]: ").concat((0,A.Vw)(o)," ---")):44===o!==r.expectFail||console.log("--- test '".concat(r.name,"' halted with FAILURE (test ").concat(s,") ---")),n=!0;break}v(o)}n||console.log("--- test '".concat(r.name,"' halted after too many instructions ---"))}}function u(e){return o.comps.find(t=>t.comp.defId===e)}function p(){return u("core/riscv/reg32")}return(0,l.useEffect)(()=>{!async function(){let e=await fetch("/riscv/examples/add_tests.elf");if(e.ok){let t=new Uint8Array(await e.arrayBuffer()),o=(0,j.X4)(t);i((0,j.Qf)(t,o).map(e=>{let t=e.name.slice(6)||e.name;return{name:t,elfSection:e,expectFail:t.startsWith("must_fail")}}))}}()},[r]),(0,s.jsxs)("div",{className:P().exampleView,children:[(0,s.jsxs)("div",{className:P().header,children:["Examples",(0,s.jsx)("div",{className:P().reloadBtn,onClick:()=>a(e=>e+1),children:(0,s.jsx)(O.G,{icon:D.go9})})]}),(0,s.jsx)("div",{className:P().body,children:n.map((e,n)=>(0,s.jsx)("div",{className:P().entry,onClick:()=>{d(e),y(o),t(e=>({...e}))},children:e.name},n))}),(0,s.jsx)("div",{className:P().divider}),(0,s.jsxs)("div",{className:P().body,children:[(0,s.jsx)("button",{className:P().btn,disabled:o.runArgs.halt,onClick:function(){o.runArgs.halt||v(o),o.runArgs.halt||y(o),t(e=>({...e}))},children:"Step"}),(0,s.jsx)("button",{className:P().btn,onClick:function(){b(o,{hardReset:!1}),y(o),t(e=>({...e}))},children:"Reset"}),(0,s.jsx)("button",{className:P().btn,onClick:function(){console.log("Running all tests...");let e=performance.now(),i=0,r=0,s=0,l=0;for(;l<100&&i===r;l++)for(let e of n){d(e),b(o,{hardReset:!1}),y(o,!0),r+=1;let t=!1;for(let n=0;n<400;n++){if(o.runArgs.halt){var a,c;let o=p(),n=null!==(a=null==o?void 0:o.data.file[10])&&void 0!==a?a:0,r=null!==(c=null==o?void 0:o.data.file[11])&&void 0!==c?c:0;44!==n&&911!==n?console.log("--- test '".concat(e.name,"' halted with unknown result in reg[a0]: ").concat((0,A.Vw)(n)," ---")):44===n!==e.expectFail?i+=1:console.log("--- test '".concat(e.name,"' halted with FAILURE (test ").concat(r,") ---")),t=!0;break}s+=1,v(o),y(o,!0)}t||console.log("--- test '".concat(e.name,"' halted after too many instructions ---"))}let u=performance.now()-e;console.log("All tests done in ".concat(u.toFixed(1),"ms. Success: ").concat(i,"/").concat(r," (repeats=").concat(l,"). Instructions: ").concat(s," (").concat((s/u).toFixed(0)," kHz)")),y(o),t(e=>({...e}))},children:"Run all"}),(0,s.jsx)("button",{className:P().btn,onClick:c,children:"Run all (slow)"})]})]})};var L=o(9225),k=o(8122),E=o.n(k);let R=e=>{let{canvasEl:t}=e,{editorState:o,exeModel:n,setEditorState:i}=(0,f._i)(),r=o.hovered,l=null;if(r){var a;let e=null;if(r.ref.type===h.ru.WireSeg||r.ref.type===h.ru.WireNode){let t=n.lookup.wireIdToNetIdx.get(r.ref.id),o=n.nets[null!=t?t:-1];if(o){let t,i,r=o.width,l=[];if(32===o.width){r=8;for(let e=3;e>=0;e--)l.push(o.value>>>e*r&255)}else l.push(o.value);i=(0,m.yE)(o.type,h.bS.Ctrl)?(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:E().numVal,children:["0x",o.value.toString(16).padStart(o.width>>>2,"0")]}),(0,s.jsxs)("span",{className:E().bitWidth,children:[" "," ",o.width," bits"]})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:E().numVal,children:(0,A.Vw)(o.value).toString().padStart(2,"0")}),"\xa0",(0,s.jsxs)("span",{className:E().hexVal,children:["0x",(0,A.aj)(o.value).toString(16).padStart(o.width>>>2,"0")]})]}),e=(0,s.jsxs)("div",{children:[i,l.map((e,t)=>(0,s.jsx)("div",{className:E().bitVal,children:e.toString(2).padStart(r,"0")},t)),(0,s.jsx)("div",{className:E().compId,children:(n.comps,t=e=>{var t,o;let n=e.exeComp,i=e.comp,r=e.exePort,s=(0,m.yE)(r.type,h.bS.Tristate)?"(ts)":"",l=null!==(o=null===(t=i.ports[e.portIdx])||void 0===t?void 0:t.id)&&void 0!==o?o:"??";return"".concat(n.compFullId,".").concat(l).concat(s)},"(".concat(o.outputs.map(e=>t(e)).join(", "),") --> (").concat(o.inputs.map(e=>t(e)).join(", "),")"))}),(0,s.jsx)("div",{className:E().compId,children:o.wire.id})]})}else e=(0,s.jsxs)("div",{children:["net ",r.ref.id," ","=>"," ",t," not found"]})}else{let t=n.lookup.compIdToIdx.get(r.ref.id),o=(0,m.DX)(t),i=n.comps[null!=t?t:-1],l=null,a=null;if(r.ref.type===h.ru.CompNode){let e=function(e,t){var o;let n=null!==(o=e.lookup.compIdToIdx.get(t.id))&&void 0!==o?o:-1,i=e.comps[n];if(!i)return null;let r=i.comp.ports.findIndex(e=>e.id===t.compNodeId);if(r<0)return null;let s=i.ports[r],l=i.comp;return{compIdx:n,portIdx:r,compExe:i,portExe:s,comp:l,port:l.ports[r]}}(n,r.ref);if(e){let{portExe:t,port:o}=e,n=t.type,i="";(0,m.yE)(n,h.bS.In)&&(i+="in"),(0,m.yE)(n,h.bS.Out)&&(i+="out"),(0,m.yE)(n,h.bS.Ctrl)&&(i+=" ctrl"),(0,m.yE)(n,h.bS.Data)&&(i+=" data"),(0,m.yE)(n,h.bS.Tristate)&&(i+=" tristate"),(0,m.yE)(n,h.bS.Addr)&&(i+=" addr");let r=(0,m.yE)(n,h.bS.In)&&(0,m.yE)(n,h.bS.Out),d="";r&&(d=", dir="+h.H[t.ioDir]),l=(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("span",{children:["\xa0 Port ",o.name," (",i,") io:",t.ioEnabled?"1":"0",", du:",t.dataUsed?"1":"0",d," V:0x",t.value.toString(16)]})}),a=(0,s.jsxs)("span",{className:E().portId,children:["/",o.id]})}}e=i?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:null!=l?l:i.comp.name}),(0,s.jsxs)("div",{className:E().compId,children:[i.comp.id,"/",i.comp.defId,a]})]}):(0,s.jsxs)("div",{children:["comp ",r.ref.id," not found ",o?"but has idx ".concat(o):"and exeComp idx not found"]})}let i=o.mtx,c=o.snapshot.mainSchematic,u=r.ref.id.split("|");for(let e=0;e<u.length-1;e++){let t=c.comps.find(t=>t.id===u[e]),n=o.compLibrary.getCompDef(null!==(a=null==t?void 0:t.defId)&&void 0!==a?a:"");if(!t||!n)break;let r=(0,g.N_)(o,t);if(!r)break;let s=(0,g.hz)(t,r);i=i.mul(s),c=r}let p=new d.AO(20,20),f=i.mulVec3(r.modelPt).add(p);l=(0,s.jsx)(L.GI,{placement:L.O6.TopLeft,targetEl:t,className:E().hoverDisplay,offsetX:f.x,offsetY:f.y,children:(0,s.jsx)("div",{children:e})})}return(0,s.jsx)(s.Fragment,{children:l})};var _=o(6608),B=o(7104),M=o(3915),z=o.n(M),W=o(8602);let V=()=>{let{editorState:e,setEditorState:t}=(0,f._i)(),o=e.compLibrary,n=e.schematicLibrary,i=(0,l.useCallback)(()=>{let t=e.activeSchematicId;if(t){let i=n.getSchematic(t);if(i&&(i.model=e.snapshot,i.undoStack=e.undoStack,i.redoStack=e.redoStack,i.mtx=e.mtx,i.compArgs)){let e=(0,W.n6)(i.id,i.name,i.model.mainSchematic,i.compArgs);o.addLibraryItem(e)}n.saveToLocalStorage(t)}},[e.activeSchematicId,e.snapshot,e.undoStack,e.redoStack,e.mtx,n,o]);function r(o){t(()=>(0,m.v4)(e,{desiredSchematicId:o.id}))}let[a,d]=(0,l.useState)(null);async function c(e,o){confirm('Are you sure you want to delete schematic "'.concat(o.name,'"?'))&&n.deleteCustomSchematic(o.id),t(e=>({...e}))}return(0,l.useEffect)(()=>{i()},[i]),(0,s.jsxs)("div",{className:z().libraryView,children:[(0,s.jsx)("div",{className:z().header,children:"Schematics"}),(0,s.jsxs)("div",{className:z().body,children:[[...n.builtinSchematics].map((e,t)=>{let[o,n]=e;return(0,s.jsx)("div",{className:z().entry,children:(0,s.jsx)("div",{className:z().name,onMouseDown:e=>{i(),r(n)},children:n.name})},t)}),(0,s.jsx)("div",{className:z().divider}),[...n.customSchematics].map((e,t)=>{let[o,l]=e,u=(null==a?void 0:a.id)===l.id;return(0,s.jsxs)("div",{className:z().entry,children:[!u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{onMouseDown:e=>{i(),r(l)},className:z().name,children:l.name}),(0,s.jsx)("button",{className:z().btnIcon,onClick:e=>{d({id:l.id,name:l.name,schematic:l})},children:(0,s.jsx)(O.G,{icon:D.TzT})}),(0,s.jsx)("button",{className:z().btnIcon,onClick:e=>c(e,l),children:(0,s.jsx)(O.G,{icon:D.$aW})})]}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{className:z().input,value:a.name,onChange:e=>d(t=>(0,m.v4)(t,{name:e.target.value}))}),(0,s.jsx)("button",{className:z().btnIcon,onClick:e=>void(a&&(a.schematic.name=a.name,n.saveToLocalStorage(a.id),d(null))),children:(0,s.jsx)(O.G,{icon:D.LEp})}),(0,s.jsx)("button",{className:z().btnIcon,onClick:e=>void d(null),children:(0,s.jsx)(O.G,{icon:D.NBC})})]})]},t)}),(0,s.jsx)("div",{className:z().divider}),(0,s.jsx)("button",{className:z().btn,onClick:function(e){let t=n.addCustomSchematic("New Schematic");i(),r(t)},children:"Add new"})]})]})};var H=o(6425),U=o(1969),F=o(2348),Z=o(6624);function G(e,t){let[o,n]=function(e,t){let o;if(0===e.selected.length)return["",[]];if(t)o=t.idPrefix;else{let t=e.selected[e.selected.length-1],n=t.id.lastIndexOf("|");o=-1===n?"":t.id.substring(0,n+1)}let n=o.length-1,i=e.selected.filter(e=>e.id.startsWith(o)&&e.id.lastIndexOf("|")===n).map(e=>(0,m.v4)(e,{id:e.id.substring(n+1)}));return[o,i]}(t.snapshot),i=new Set(n.map(e=>(0,B.sH)(e))),r=new Map;for(let e of n)(e.type===h.ru.WireNode||e.type===h.ru.WireSeg)&&(0,m.Dw)(r,e.id,()=>[]).push(e);let s=(0,f.WR)(t,{idPrefix:o},e,e=>(0,m.v4)(e,{comps:e.comps.filter(e=>{var t,o;return t=e.id,o=h.ru.Comp,!i.has((0,B.sH)({id:t,type:o}))}),wires:e.wires.map(e=>{let t=r.get(e.id);if(t){for(let o of(e=(0,B.x0)(e),t))if(o.type===h.ru.WireNode){let t=e.nodes[o.wireNode0Id];for(let o of t.edges)(0,B.kV)(t,e.nodes[o])}else if(o.type===h.ru.WireSeg){let t=e.nodes[o.wireNode0Id],n=e.nodes[o.wireNode1Id];(0,B.kV)(t,n)}return(0,B.U0)(e)}let o=e.nodes.map(e=>(0,m.v4)(e,{ref:e.ref&&!i.has((0,B.sH)(e.ref))?e.ref:void 0}));return(0,m.v4)(e,{nodes:o})})}));return(0,m.v4)(s,{selected:[]})}function q(e){navigator.clipboard.writeText(e)}function X(e){let t=e.snapshot.selected,o=new Set(t.filter(e=>e.type===h.ru.Comp).map(e=>e.id)),n=new Map;for(let e of t)(e.type===h.ru.WireNode||e.type===h.ru.WireSeg)&&(0,m.Dw)(n,e.id,()=>[]).push(e);let i=[];for(let t of e.snapshot.mainSchematic.wires){if(!n.has(t.id))continue;let e=n.get(t.id),r=new Set;for(let t of e)r.add(t.wireNode0Id),t.type===h.ru.WireSeg&&r.add(t.wireNode1Id);let s={...t,nodes:t.nodes.map(e=>{let t=r.has(e.id);return{...e,edges:t?e.edges.filter(e=>r.has(e)):[],ref:t&&e.ref&&o.has(e.ref.id)?e.ref:void 0}})};for(let e of(0,B.Jp)((0,B.U0)(s)))i.push(e)}return{compBbox:e.snapshot.mainSchematic.compBbox,comps:e.snapshot.mainSchematic.comps.filter(e=>o.has(e.id)),wires:i}}let K=(0,l.memo)(function(e){var t,o;let n,i,{cvsState:r,embedded:a,children:c}=e,[x,y]=(0,l.useState)(!1),[v,b]=(0,l.useState)(null),{editorState:S,setEditorState:w}=(0,f._i)();(0,H.qi)(H.Cf.MainPage,e=>{if("Control"===e.key&&y("keydown"===e.type),"keydown"===e.type){if((0,H.Kc)(e,"o",H.qn.None)&&w(e=>(0,m.v4)(e,{showExeOrder:!e.showExeOrder})),(0,H.Kc)(e,"p",H.qn.None)&&w(e=>(0,m.v4)(e,{transparentComps:!e.transparentComps})),(0,H.Kc)(e,"x",H.qn.CtrlOrCmd)){let e;e=X(S),q((0,Z.u1)(e)),w((0,f.yC)(!0,G))}if((0,H.Kc)(e,"c",H.qn.CtrlOrCmd)){let e;e=X(S),q((0,Z.u1)(e))}(0,H.Kc)(e,"v",H.qn.CtrlOrCmd)&&navigator.clipboard.readText().then(e=>{console.log("gonna paste",e);let t=(0,Z.dk)(e);if(t.issues){console.log("paste issues",t.issues);return}t.schematic&&(console.log("want to merge in schematic",t.schematic),S.snapshot,w((0,f.yC)(!0,(e,o)=>{var n;let i={idPrefix:null!==(n=e.focusedIdPrefix)&&void 0!==n?n:""},r=[],s=(0,f.WR)(o,i,e,e=>{let[n,i]=function(e,t,o){if(0===t.comps.length&&0===t.wires.length)return[e,[]];e={...e,comps:[...e.comps],wires:[...e.wires]};let n=new Map,i=[],r=new d.AO(10,10);for(let s of t.comps){let t=""+e.nextCompId++,l=o.create(s.defId,s.args);l.id=t,l.pos=s.pos.add(r),n.set(s.id,t),e.comps.push(l),i.push({id:t,type:h.ru.Comp})}for(let o of t.wires){let t=(0,B.x0)(o);for(let e of t.nodes)e.ref&&(e.ref={...e.ref,id:n.get(e.ref.id)||e.ref.id}),e.pos=e.pos.add(r);let s=""+e.nextWireId++;for(let e of t.nodes)for(let t of(i.push({id:s,type:h.ru.WireNode,wireNode0Id:e.id}),e.edges))t>e.id&&i.push({id:s,type:h.ru.WireSeg,wireNode0Id:e.id,wireNode1Id:t});e.wires.push({...t,id:s})}return[e,i]}(e,t.schematic,o.compLibrary);return r=i,n});return(0,m.v4)(s,{selected:r})})))}),"Delete"===e.key&&w((0,f.yC)(!0,G))}},{receiveKeyUp:!0});let C=(0,F.tR)(function(e){w(t=>{let o=t.mtx.a,n=(0,m.uZ)(o*Math.pow(1.0013,-e.deltaY),.01,1e5)/o,i=D(e,t.mtx),r=p.t.multiply(t.mtx,p.t.translateVec(i),p.t.scale1(n),p.t.translateVec(i.mul(-1)));return(0,m.v4)(t,{mtx:r})}),e.stopPropagation(),e.preventDefault()});(0,l.useEffect)(()=>{if(v){function e(e){(!a||(0,H.rE)(e,H.qn.CtrlOrCmd))&&C.current(e)}return v.addEventListener("wheel",e,{passive:!1}),()=>{v.removeEventListener("wheel",e)}}},[v,C,a]),(0,I.oG)(v,{mtx:S.mtx},{alwaysSendDragEvent:!0},function(e,t){let o=new d.AO(t.touches[0].clientX,t.touches[0].clientY),n=new d.AO(e.touches[0].clientX,e.touches[0].clientY).sub(o),i=p.t.multiply(p.t.translateVec(n),t.data.mtx);e.stopPropagation(),e.preventDefault(),w(e=>(0,m.v4)(e,{mtx:i}))},function(e,t){let o=new d.AO(t.touches[0].clientX,t.touches[0].clientY),n=new d.AO(t.touches[1].clientX,t.touches[1].clientY),i=new d.AO(e.touches[0].clientX,e.touches[0].clientY),r=new d.AO(e.touches[1].clientX,e.touches[1].clientY),s=o.lerp(n,.5),l=i.lerp(r,.5),a=o.dist(n),c=i.dist(r),u=p.t.multiply(p.t.translateVec(l),p.t.scale1(c/a),p.t.translateVec(s.mul(-1)),t.data.mtx);e.stopPropagation(),e.preventDefault(),w(e=>(0,m.v4)(e,{mtx:u}))});let[N,P]=(0,I.gU)(null!==(o=null==r?void 0:r.canvas)&&void 0!==o?o:null,e=>{var t;let o=0===e.button?S.hovered:null,n=o?(0,g.TM)(o.ref):{idPrefix:null!==(t=S.snapshot.focusedIdPrefix)&&void 0!==t?t:""},i=(0,g.C8)(n,S);return{baseMtx:S.mtx,mtx:i,hovered:o,modelPos:D(e,i),ctrlDown:x,isSelecting:0===e.button&&x||2===e.button}},function(e,t,o){let n=document.getSelection();null==n||n.removeAllRanges();let i=new d.AO(e.clientX-t.clientX,e.clientY-t.clientY);if(t.data.isSelecting){let n=D(e,t.data.mtx),i=t.data.modelPos,r=new d.bR(i,n),[s,l]=(0,g.c5)(S),a=l.comps.filter(e=>{let t=new d.bR(e.pos,e.pos.add(e.size));return r.intersects(t)}).map(e=>({type:h.ru.Comp,id:s+e.id})),c=l.wires.flatMap(e=>{let t=[];for(let o of e.nodes)r.contains(o.pos)&&t.push({type:h.ru.WireNode,id:s+e.id,wireNode0Id:o.id});let o=[];return(0,B.Tb)(e,(t,n)=>{let i=new d.bR(t.pos,n.pos);r.intersects(i)&&o.push({type:h.ru.WireSeg,id:s+e.id,wireNode0Id:t.id,wireNode1Id:n.id})}),[...t,...o]});w(e=>(0,m.v4)(e,{selectRegion:o?null:{bbox:r,idPrefix:""},snapshot:(0,m.v4)(e.snapshot,{selected:[...a,...c]})}))}else if(t.data.hovered){var r,s,l,a,c,u,x,y;let n,i,p,v,b,I,C=t.data.mtx,N=t.data.hovered.ref;N.type===h.ru.Comp?S.snapshot.selected.find(e=>e.type===h.ru.Comp&&e.id===N.id)&&(r=t.data.modelPos,s=D(e,C),w((0,f.pd)(o,(e,t,o)=>{let n=O(s.sub(r));return(0,B.M5)(e,o.selected,n)}))):N.type===h.ru.CompNode?(t.data.modelPos,a=D(e,C),n=(0,g.TM)(N),i=(0,g.UB)(N),w((0,f.Rq)(n,o,e=>{let t=e.comps.find(e=>e.id===i.id);if(!t)return console.log("WARN: handleWireCreateDrag: comp '".concat(i.id,"' not found")),e;let o=t.ports.find(e=>e.id===i.compNodeId);if(!o)return console.log("WARN: handleWireCreateDrag: comp '".concat(i.id,"' does not have the port '").concat(i.compNodeId,"'")),e;let n=t.pos.add(o.pos),r=O(a),s=0===o.pos.x||o.pos.x===t.size.x,l=[];s?(l.push({p0:n,p1:new d.AO(r.x,n.y),comp0Ref:i}),l.push({p0:new d.AO(r.x,n.y),p1:r})):(l.push({p0:n,p1:new d.AO(n.x,r.y),comp0Ref:i}),l.push({p0:new d.AO(n.x,r.y),p1:r}));let c=(0,B.Vn)((0,B.uT)({id:""+e.nextWireId,segments:l})),u=[...e.wires,c];return(0,B.AW)((0,m.v4)(e,{nextWireId:e.nextWireId+1,wires:u}),u,u.length-1)}))):N.type===h.ru.WireSeg?(c=t.data.modelPos,u=D(e,C),p=(0,g.TM)(N),v=(0,g.UB)(N),w((0,f.Rq)(p,o,e=>{let t=e.wires.findIndex(e=>e.id===v.id);if(-1===t)return console.log("WARN: handleWireDrag: wire ".concat(v.id," not found")),e;let o=e.wires[t],n=u.sub(c),i=o.nodes[v.wireNode0Id],r=o.nodes[v.wireNode1Id];if(i.ref||r.ref)return e;n=i.pos.y===r.pos.y?new d.AO(0,n.y):new d.AO(n.x,0);let s=(0,B.qs)(o,v.wireNode0Id,v.wireNode1Id,n),l=[...e.wires];return l[t]=s,(0,B.AW)(e,l,t)}))):N.type===h.ru.WireNode&&(x=t.data.modelPos,y=D(e,C),b=(0,g.TM)(N),I=(0,g.UB)(N),w((0,f.Rq)(b,o,function(e){var t;(0,B.C9)(e.wires,"handleWireExtendDrag (pre edit)");let n=e.wires.findIndex(e=>e.id===I.id);if(-1===n)return console.log("WARN: handleWireExtendDrag: wire '".concat(I.id,"' not found")),e;let i=(0,B.x0)(e.wires[n]),r=y.sub(x),s=i.nodes[I.wireNode0Id],l=s.pos,a=L(l,C),c=L(y,C).sub(a),u=c.normalize().round();0!==u.x&&0!==u.y&&(u.y=0),!A.current&&c.len()>20?A.current=u:20>c.len()&&(A.current=null);let p=null!==(t=A.current)&&void 0!==t?t:u;o&&(A.current=null);let m=O(l.add(r)),f=m.sub(l),h=!1,g=[];for(let e of s.edges){let t=i.nodes[e],o=t.pos.sub(l).normalize();if(o.dot(p)>1-B.Ib){let o=i.nodes.length,n=i.nodes.length+1,r=l.add((0,d.n3)(f,p));t.edges.push(o),t.edges=t.edges.filter(e=>e!==s.id),s.edges=s.edges.filter(e=>e!==t.id),i.nodes.push({id:o,pos:r,edges:[e,n]}),i.nodes.push({id:n,pos:m,edges:[o]}),h=!0;break}g.push(o)}if(!h){if(1===s.edges.length&&p.dot(i.nodes[s.edges[0]].pos.sub(l))<-1+B.Ib){let e=i.nodes.length,t=l.add((0,d.n3)(f,p));s.pos=t,s.edges.push(e),i.nodes.push({id:e,pos:m,edges:[s.id]})}else{let e=i.nodes.length,t=i.nodes.length+1,o=l.add((0,d.n3)(f,p));s.edges.push(e),i.nodes.push({id:e,pos:o,edges:[s.id,t]}),i.nodes.push({id:t,pos:m,edges:[e]})}}let v=[...e.wires];return v[n]=i,(0,B.C9)(v,"handleWireExtendDrag"),(0,B.AW)(e,v,n)})))}else{let e=p.t.translateVec(i).mul(t.data.baseMtx);w(t=>(0,m.v4)(t,{mtx:e}))}e.stopPropagation(),e.preventDefault()},function(e,t){if(t.data.hovered){let e=t.data.hovered.ref;w(t=>(0,m.v4)(t,{snapshot:(0,m.v4)(t.snapshot,{selected:[e]})}))}else w(e=>(0,m.v4)(e,{snapshot:(0,m.v4)(e.snapshot,{selected:[]})}));e.stopPropagation(),e.preventDefault()}),j=(null==N?void 0:N.data.ctrlDown)||x||S.transparentComps,A=(0,l.useRef)(null);if(N&&(null===(t=N.data.hovered)||void 0===t?void 0:t.ref.type)===h.ru.Comp)n="move";else if(S.hovered){let e=S.hovered.ref;if(e.type===h.ru.CompNode)n="crosshair";else if(e.type===h.ru.WireSeg){let[t,o]=(0,g.yM)(S,e),i=o.wires.find(e=>e.id===t.id);if(i){let e=i.nodes[t.wireNode0Id],o=i.nodes[t.wireNode1Id];e&&o&&(n=e.pos.y===o.pos.y?"ns-resize":"ew-resize")}}else e.type===h.ru.WireNode?n="crosshair":e.type===h.ru.Comp&&S.snapshot.selected.find(t=>t.type===h.ru.Comp&&t.id===e.id)&&(n="move")}function O(e){return e.round()}function D(e,t){return t.mulVec3Inv(T(e))}function T(e){var t,o;let n=null==r?void 0:r.canvas.getBoundingClientRect();return new d.AO(e.clientX-(null!==(t=null==n?void 0:n.x)&&void 0!==t?t:0),e.clientY-(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:0))}function L(e,t){return t.mulVec3(e)}function k(e,t){return t.mulVec3Inv(e)}return N&&!N.data.hovered&&(i="cursor-grabbing"),(0,s.jsxs)("div",{className:u().canvasEventSurface,ref:b,onMouseDown:function(e){S&&P(e)},onMouseMove:function(e){if(S.dragCreateComp){let t=S.dragCreateComp.compOrig,o=O(D(e,S.mtx)),n=e=>{let n=(0,m.v4)(t,{id:""+e.mainSchematic.nextCompId,pos:o});return(0,m.v4)(e,{mainSchematic:(0,m.v4)(e.mainSchematic,{nextCompId:e.mainSchematic.nextCompId+1,comps:[...e.mainSchematic.comps,n]})})};w(e=>(0,m.v4)(e,{dragCreateComp:(0,m.v4)(e.dragCreateComp,{applyFunc:n})}));return}let t=function e(t,o,n,i){var r;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";null!=i||(i=t.mtx),null!=n||(n=t.snapshot.mainSchematic);let l=D(o,i),a=T(o),c=n.comps,u=[];for(let e=c.length-1;e>=0;e--){let t=c[e];for(let e of t.ports){let o=t.pos.add(e.pos),n=L(o,i),r=o.dist(l),d=n.dist(a);(d<10||r<.2)&&u.push({ref:{type:h.ru.CompNode,id:s+t.id,compNodeId:e.id},distPx:d,modelPt:o})}}if(!j)for(let n=c.length-1;n>=0;n--){let r=c[n],p=new d.bR(r.pos,r.pos.add(r.size));if(p.contains(l)){if((r.hasSubSchematic||r.subSchematicId)&&t.maskHover!==r.id&&i.mulBb(p).shrinkInPlaceXY(20).contains(a)){let n=t.compLibrary.getCompDef(r.defId),l=(0,g.N_)(t,r);if(l&&n){let n=i.mul((0,g.hz)(r,l)),a=e(t,o,l,n,s+r.id+"|");a&&u.push(a)}continue}u.push({ref:{type:h.ru.Comp,id:s+r.id},distPx:0,modelPt:l})}}let p=n.wires;for(let e=p.length-1;e>=0;e--){let t=p[e];for(let e of t.nodes){let o=L(e.pos,i),n=o.dist(a);n<10&&u.push({ref:{type:h.ru.WireNode,id:s+t.id,wireNode0Id:e.id},distPx:n,modelPt:k(o,i)})}for(let e of t.nodes){let o=L(e.pos,i);for(let n of e.edges){if(n<=e.id)continue;let r=t.nodes[n],l=L(r.pos,i),c=(0,d.s4)(o,l,a),p=c.dist(a);p<10&&u.push({ref:{type:h.ru.WireSeg,id:s+t.id,wireNode0Id:e.id,wireNode1Id:r.id},distPx:p,modelPt:k(c,i)})}}}return null!==(r=u[0])&&void 0!==r?r:null}(S,e);w(e=>(0,m.v4)(e,{hovered:(0,m.EH)(e.hovered,t)}))},onMouseEnter:function(e){},onMouseLeave:function(e){w(e=>(0,m.v4)(e,{hovered:null,dragCreateComp:e.dragCreateComp?(0,m.v4)(e.dragCreateComp,{applyFunc:void 0}):void 0}))},onContextMenu:e=>e.preventDefault(),style:{cursor:n},children:[c,i&&(0,s.jsx)(U.z,{className:i})]})});var Y=o(7188),Q=o(7042);function J(e,t){return 1===t?e:e+"s"}var $=o(1409);function ee(e){let[t,o]=e.split(":"),n=t.split("/"),i=n.slice(0,n.length-1).join("/"),r=n[n.length-1];return{path:n,version:o,dir:i,name:r}}function et(e,t){return{id:e.id,name:e.name,schematic:e.model.mainSchematic}}let eo=()=>{let{editorState:e,setEditorState:t}=(0,f._i)(),[o,n]=(0,l.useState)(null),[i,r]=(0,l.useState)(null),a=e.schematicLibrary.builtinSchematics,d=e.schematicLibrary.customSchematics,c=e.compLibrary.libraryLookup,u=function(e){let t=new Map,o=new Map;for(let t of e)o.set(t.id,t);for(let e of o.values()){let{dir:o,name:n,path:i,version:r}=ee(e.id),s=(0,m.Dw)(t,o,()=>({id:o,items:[],groups:new Map}));s.items.push(e);let l=i.join("/");(0,m.Dw)(s.groups,l,()=>({id:l,name:n,items:[]})).items.push(e)}return[...t.values()]}((0,l.useMemo)(()=>[...[...a.values()].map(e=>et(e,!0)),...[...d.values()].map(e=>et(e,!1)),...c.values()],[c,a,d]));(0,H.qi)(H.Cf.Modal,e=>{(0,H.Kc)(e,"Escape",H.qn.None)&&y()});let p=u.find(e=>e.id===o),h=i?ee(i).path.join("/"):null,x=p&&h?p.groups.get(h):null,g=x&&i?x.items.find(e=>e.id===i):null;function y(){t(e=>(0,m.v4)(e,{compLibraryVisible:!1}))}return(0,l.useLayoutEffect)(()=>{(0,m.kK)(o)&&n(u[0].id),!g&&p&&r([...p.groups.values()][0].items[0].id)},[o,g,u,p]),(0,s.jsxs)(L.Ge,{className:"pointer-events-auto dialog-fade-in overscroll-none touch-none",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-opacity-40 bg-black pointer-events-auto",onClick:y}),(0,s.jsxs)("div",{className:"flex flex-col bg-white rounded shadow-2xl absolute inset-10 overflow-hidden pointer-events-auto m-auto max-w-[80rem] max-h-[50rem]",children:[(0,s.jsxs)("div",{className:"px-2 py-1 text-center border-b text-2xl bg-gray-500 text-white relative",children:["Component Library",(0,s.jsx)("button",{className:"cursor-pointer absolute top-0 right-0 bottom-0",onClick:y,children:(0,s.jsx)(O.G,{icon:D.NBC,className:"px-3"})})]}),(0,s.jsxs)($.w,{id:"libraryBrowser",className:"flex-1 overflow-hidden border",defaultFraction:.3,children:[(0,s.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden",children:[(0,s.jsx)("h2",{className:"text-center p-1 border-b",children:"Folders"}),(0,s.jsx)("div",{className:"flex flex-col overflow-y-auto flex-1",children:(0,s.jsx)("div",{className:"flex flex-col bg-white flex-1",children:u.map(e=>{let t=e.id===o,i=e.items.length,r=e.groups.size;return(0,s.jsxs)("div",{className:(0,Q.Z)("px-2 py-1 w-full flex cursor-pointer items-center",t?"bg-blue-200 hover:bg-blue-300":"bg-white hover:bg-slate-100"),onClick:()=>n(e.id),children:[e.id||"<no folder>",(0,s.jsxs)("div",{className:"ml-auto text-gray-500 text-sm",children:[r," (",i,")"]})]},e.id)})})})]}),(0,s.jsxs)($.w,{id:"fileInfoSplit",vertical:!0,className:"flex-1",defaultFraction:.5,children:[(0,s.jsx)("div",{className:"flex-1 overflow-y-auto bg-gray-100 shadow-inner",children:(0,s.jsx)("div",{className:"grid p-2",style:{gridTemplateColumns:"repeat(auto-fit, 230px)"},children:p&&(0,s.jsx)(s.Fragment,{children:[...p.groups.entries()].map(e=>{let[t,o]=e,n=t===h;return(0,s.jsx)(en,{group:o,isActive:n,setSelectedItemId:r},t)})})})}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,s.jsx)("h2",{className:"text-center p-1 border-b",children:"File Info"}),x&&(0,s.jsx)(es,{group:x,item:null!=g?g:null,setSelectedItemId:r})]})]})]})]})]})},en=e=>{let{group:t,isActive:o,setSelectedItemId:n}=e,i=t.items.length;return(0,s.jsxs)(er,{isSelected:o,onClick:()=>n(t.items[0].id),children:[(0,s.jsx)("h2",{className:"text-center p-1 text-lg",children:t.items[0].name}),(0,s.jsxs)("div",{className:"flex flex-row flex-1",children:[(0,s.jsx)("div",{className:"flex-1 relative p-1",children:(0,s.jsx)(el,{className:"w-full h-full"})}),(0,s.jsxs)("div",{className:"px-2 text-slate-500 text-sm flex items-center flex-col",children:[(0,s.jsx)("div",{className:"mb-auto",children:i>1&&(0,s.jsxs)(s.Fragment,{children:[i," ",J("version",i)]})}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)(ei,{icon:D.TzT,onClick:function(e){e.stopPropagation()}}),(0,s.jsx)(ei,{icon:Y.WM4,onClick:function(e){e.stopPropagation()}}),(0,s.jsx)(ei,{icon:Y.I7k,onClick:function(e){e.stopPropagation()}})]})]})]})]})},ei=e=>{let{className:t,icon:o,onClick:n,...i}=e;return(0,s.jsx)("button",{...i,className:(0,Q.Z)("text-gray-500 hover:text-black p-1",t),onClick:n,children:(0,s.jsx)(O.G,{icon:o})})},er=e=>{let{onClick:t,children:o,className:n,isSelected:i}=e;return(0,s.jsx)("div",{className:(0,Q.Z)("shadow border h-[7.5rem] m-2 flex-none flex flex-col cursor-pointer",n,i?"bg-blue-200 hover:bg-blue-300":"bg-white hover:bg-slate-100"),onClick:t,children:o})},es=e=>{var t,o;let{group:n,item:i,setSelectedItemId:r}=e,l=null==i?void 0:i.id;return(0,s.jsxs)("div",{className:"flex flex-1 flex-row overflow-hidden",children:[(0,s.jsxs)("div",{className:"w-[14rem] flex flex-col border-r",children:[(0,s.jsx)("div",{className:"px-2 py-1 text-center border-b",children:"Versions"}),(0,s.jsx)("div",{className:"overflow-y-auto bg-gray-100 flex-1",children:(0,s.jsx)("div",{className:"flex flex-1 flex-col",children:n.items.map(e=>{let{version:t}=ee(e.id),o=e.id===l;return(0,s.jsxs)("div",{className:(0,Q.Z)("px-2 py-1 flex items-center cursor-pointer",o?"bg-blue-200 hover:bg-blue-300":"bg-white hover:bg-slate-100"),onClick:()=>r(e.id),children:[(0,s.jsx)("div",{className:"mr-1",children:"Version"}),(0,s.jsx)("div",{className:"pr-2 mr-auto",children:t}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(ei,{icon:D.TzT,onClick:()=>{}}),(0,s.jsx)(ei,{icon:Y.WM4,onClick:()=>{}}),(0,s.jsx)(ei,{icon:Y.I7k,onClick:()=>{}})]})]},e.id)})})})]}),(0,s.jsxs)("div",{className:"flex flex-col flex-1 px-3 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex flex-col py-1",children:[(0,s.jsx)("h1",{className:"text-lg",children:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:n.name}),(0,s.jsx)("h2",{className:"text-sm text-slate-500 font-mono pt-1",children:null!==(o=null==i?void 0:i.id)&&void 0!==o?o:n.id})]}),(0,s.jsx)("div",{className:"flex-1 flex-shrink overflow-hidden max-w-[20rem]",children:(0,s.jsx)(el,{className:"flex-grow-0 pb-[66%]"})})]})]})},el=e=>{let{className:t,url:o}=e;return(0,s.jsxs)("div",{className:(0,Q.Z)("bg-gray-200 flex items-center justify-center rounded relative overflow-hidden bg-opacity-30 shadow",t),children:[o&&(0,s.jsx)("img",{src:o,className:"absolute inset-0 max-h-full max-w-full object-cover w-full h-full",alt:"Component"}),!o&&(0,s.jsx)("div",{className:"absolute inset-0 flex justify-center items-center bg-gray-200 bg-opacity-0",children:(0,s.jsx)(O.G,{icon:Y.VmB,className:"mr-2 text-6xl text-gray-400"})})]})};function ea(e,t){let o=e.map((e,o)=>[...t.map(t=>t(e)),o]),n=t.length+1;return o.sort((e,t)=>{for(let o=0;o<n;o++){if(e[o]<t[o])return -1;if(e[o]>t[o])return 1}return 0}),o.map(t=>e[t[n-1]])}var ed=o(3589);let ec=(0,l.memo)(function(e){var t;let{className:o}=e,{editorState:n,setEditorState:i}=(0,f._i)(),[r,a]=(0,l.useState)(!1),c=(null!==(t=n.snapshotTemp)&&void 0!==t?t:n.snapshot).mainSchematic,u=c.compSize.x>0&&c.compSize.y>0,p=(0,l.useMemo)(()=>{let e=0;for(let t of n.snapshot.mainSchematic.comps)t.defId===x.rS&&e++;return e},[n.snapshot]);return(0,s.jsxs)("div",{className:(0,Q.Z)("flex flex-col bg-white shadow-md border m-6 rounded items-stretch overflow-hidden",o),children:[(0,s.jsx)("div",{className:"flex flex-row h-10",children:(0,s.jsxs)("div",{className:"p-3 hover:bg-blue-300 cursor-pointer flex-1 flex justify-end items-center",onClick:function(e){a(e=>!e),u||i((0,f.yC)(!0,(e,t)=>(0,m.v4)(e,{mainSchematic:(0,m.v4)(e.mainSchematic,{compSize:new d.AO(4,4)})}))),e.preventDefault(),e.stopPropagation()},children:[!u&&(0,s.jsxs)(s.Fragment,{children:["Create Component (",p," ",J("port",p),")",(0,s.jsx)(O.G,{icon:D.r8p,className:"ml-2"})]}),u&&(0,s.jsxs)(s.Fragment,{children:["Edit Component (",p," ",J("port",p),")",(0,s.jsx)(O.G,{icon:D.I4f,className:"ml-3 transition-transform",rotation:r?90:void 0})]})]})}),r&&(0,s.jsx)(eu,{})]})}),eu=(0,l.memo)(function(e){var t,o;let{}=e,{editorState:n,setEditorState:i}=(0,f._i)(),[r,c]=(0,l.useState)(null),[u,g]=(0,l.useState)(null),[y,v]=(0,l.useState)(new d.AO),[b,S]=(0,l.useState)(null),[,w]=(0,l.useReducer)(e=>e+1,0),[C,N]=(0,l.useState)(()=>new p.t(40,0,0,40,1,1));(0,a.T)(null==u?void 0:u.parentElement,e=>{w()});let P=(0,l.useRef)({extraCanvases:new Map}),j=(0,F.tR)(function(e){let t,o,n=C.a,i=(0,m.uZ)(n*Math.pow(1.0013,-e.deltaY),.01,1e5)/n,r=(t=u.getBoundingClientRect(),o=new d.AO(e.clientX-t.left,e.clientY-t.top),C.mulVec3Inv(o));N(p.t.multiply(C,p.t.translateVec(r),p.t.scale1(i),p.t.translateVec(r.mul(-1)))),e.stopPropagation(),e.preventDefault()});(0,l.useEffect)(()=>{if(r){function e(e){j.current(e)}return r.addEventListener("wheel",e,{passive:!1}),()=>{r.removeEventListener("wheel",e)}}},[r,j]);let[A,O]=(0,I.gU)(r,e=>({mtx:C}),function(e,t,o){let n=new d.AO(e.clientX-t.clientX,e.clientY-t.clientY);N(p.t.translateVec(n).mul(t.data.mtx))});(0,l.useLayoutEffect)(()=>{if(!u)return;P.current;let e=u.getContext("2d"),t=window.devicePixelRatio,o=Math.floor(u.parentElement.clientWidth*t),n=Math.floor(u.parentElement.clientHeight*t);(u.width!==o||u.height!==n)&&(u.width=o,u.height=n),e.save(),e.clearRect(0,0,u.width,u.height),e.scale(t,t),e.transform(...C.toTransformParams()),e.restore()});let D=(null!==(o=n.snapshotTemp)&&void 0!==o?o:n.snapshot).mainSchematic,T=(0,l.useMemo)(()=>ea(D.comps.filter(e=>e.defId===x.rS),[e=>e.args.type]),[D.comps]);return(0,l.useEffect)(()=>{let e=new Set(D.compPorts.map(e=>e.id)),t=new Set(T.map(e=>e.args.portId));D.compPorts.filter(e=>!t.has(e.id));let o=T.filter(t=>!e.has(t.args.portId)),n=D.compPorts.map(e=>e.pos),r=[];for(let e of o){let t=null;for(let e of function*(e){for(let t=1;t<e.x;t++)yield new d.AO(t,0);for(let t=1;t<e.y;t++)yield new d.AO(e.x,t);for(let t=e.x-1;t>=1;t--)yield new d.AO(t,e.y);for(let t=e.y-1;t>=1;t--)yield new d.AO(0,t)}(D.compSize))if(!n.some(t=>.001>t.dist(e))){t=e;break}t&&(r.push({id:e.args.portId,pos:t,name:e.args.name,type:e.args.type,width:e.args.bitWidth}),n.push(t))}let s=[...D.compPorts,...r];r.length>0&&i((0,f.DG)(e=>(0,m.v4)(e,{mainSchematic:(0,m.v4)(e.mainSchematic,{compPorts:s})})))},[T,D.compPorts,D.compSize,i]),(0,s.jsxs)("div",{className:"h-[30rem] w-[20rem] bg-white flex flex-col",children:[(0,s.jsx)(f.rA.Provider,{value:{el:u,mtx:C},children:(0,s.jsxs)("div",{className:"bg-white flex-1 border-y relative shadow-inner cursor-grab",ref:c,onMouseDown:O,children:[(0,s.jsx)("canvas",{className:"absolute w-full h-full",ref:g}),(0,s.jsx)("div",{className:"overflow-hidden absolute left-0 top-0 w-full h-full pointer-events-none",children:(0,s.jsxs)("div",{className:"absolute origin-top-left",style:{transform:"matrix(".concat(C.toTransformParams().join(","),")")},children:[(0,s.jsx)(ep,{size:D.compSize,pos:y,setPos:function(e,t){v(t)}}),D.compPorts.map((e,t)=>{var o;let n=e.id,i=null!==(o=T.find(e=>e.args.portId===n))&&void 0!==o?o:null;return(0,s.jsx)(em,{portIdx:t,compPos:y,compSize:D.compSize,schematicComp:i,port:e,draggingPortIdx:b,setDraggingPortIdx:S},t)})]})})]})}),(0,s.jsx)("div",{className:"x-compProps flex flex-col border-t",children:null===(t=n.schematicLibrary.getSchematic(n.activeSchematicId))||void 0===t?void 0:t.name}),(0,s.jsx)("div",{className:"x-compListViewport h-[12rem] overflow-y-auto bg-gray-100",children:(0,s.jsx)("div",{className:"x-compListBody flex-1 border-y",children:T.map((e,t)=>{let o=e.args,n=(0,m.yE)(o.type,h.bS.In);return(0,s.jsxs)("div",{className:"x-compListItem flex flex-row items-center py-1 border-b bg-white",children:[(0,s.jsx)("div",{className:(0,Q.Z)("mx-2 w-[1.2rem] text-center font-mono rounded",n?ed.$.portInputBg:ed.$.portOutputBg),children:n?"I":"O"}),(0,s.jsx)("div",{className:"flex font-mono text-xs ml-1 w-[3rem]",children:o.portId}),(0,s.jsx)("div",{className:"flex-1",children:o.name}),(0,s.jsx)("div",{className:"px-2",children:o.bitWidth})]},t)})})}),A&&(0,s.jsx)(U.z,{className:"cursor-grabbing"})]})}),ep=(0,l.memo)(function(e){let{pos:t,size:o,setPos:n}=e,{setEditorState:i}=(0,f._i)(),{mtx:r,el:a}=(0,f.kt)(),[c,u]=(0,l.useState)(null);function p(e,t,o){n(e,t),i((0,f.yC)(e,e=>(0,m.v4)(e,{mainSchematic:function(e,t){let o=e.compSize,n=[...e.compPorts];for(let i of[0,1,2,3]){let{edgeLen:r,fixedXPos:s}=eh(i,e.compSize),{edgeLen:l,fixedPos:a}=eh(i,t),c=ex(e.compPorts,i,o),u=[];for(let t of c){let o=t.linePos/r*l;if(!ef(t,o,l,u))return e}for(let e of u){let t=e.srcIdx;n[t]=(0,m.v4)(n[t],{pos:new d.AO().setAt(s?0:1,a).setAt(s?1:0,e.linePos)})}}return(0,m.v4)(e,{compSize:t,compPorts:n})}(e.mainSchematic,o)})))}let h=r.a;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{ref:u,className:(0,Q.Z)("x_compRect absolute border border-black rounded origin-top-left cursor-move",ed.$.compBg),style:{width:o.x*h,height:o.y*h,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px) scale(").concat(1/h,")")},children:(0,m.VL)(4).map((e,n)=>(0,s.jsx)(x.t2,{gripPos:n,pos:t,size:o,onResize:p},n))})})}),em=(0,l.memo)(function(e){let{portIdx:t,compPos:o,compSize:n,schematicComp:r,port:a,draggingPortIdx:c,setDraggingPortIdx:u}=e,{setEditorState:p}=(0,f._i)(),{mtx:x,el:g}=(0,f.kt)(),[y,v]=(0,l.useState)(null);function b(e){let t=g.getBoundingClientRect(),o=new d.AO(e.clientX-t.left,e.clientY-t.top);return x.mulVec3Inv(o)}let[S,w]=(0,I.gU)(y,()=>a.pos,function(e,o,n){let i=b(e).sub(b(o)),r=o.data.add(i);u(n?null:t),p((0,f.yC)(n,e=>(0,m.v4)(e,{mainSchematic:function(e,t,o){let n=e.compSize,i=n.x-.55,r=n.y-.55,s=0,l=null,a=0;for(let e of[0,1,2,3]){let t;let c=(t=0===e?new d.AO((0,m.uZ)(o.x,.55,i),0):1===e?new d.AO(n.x,(0,m.uZ)(o.y,.55,r)):2===e?new d.AO((0,m.uZ)(o.x,.55,i),n.y):new d.AO(0,(0,m.uZ)(o.y,.55,r))).dist(o);(!l||c<a)&&(l=t,s=e,a=c)}if(!l)return e;let{fixedXPos:c,edgeLen:u,fixedPos:p}=eh(s,n),f=ex(e.compPorts,s,n).filter(e=>e.srcIdx!==t);if(f.length>=u-1)return e;let h={linePos:c?l.y:l.x,pos:l,srcIdx:t};if(!ef(h,h.linePos,u,f))return e;let x=[...e.compPorts];for(let e of f){let t=e.srcIdx,o=x[t];x[t]=(0,m.v4)(o,{pos:new d.AO().setAt(c?0:1,p).setAt(c?1:0,e.linePos)})}return(0,m.v4)(e,{compPorts:x})}(e.mainSchematic,t,r)}))),e.stopPropagation(),e.preventDefault()}),C=(0,m.yE)(a.type,h.bS.In),N=o.add(a.pos),P=x.a,j=function(e,t){let{x:o,y:n}=e.pos;if(0===o)return i.Left;if(o===t.x)return i.Right;if(0===n)return i.Top;if(n===t.y)return i.Bottom;throw Error("Port ".concat(e.id," is not on the edge of the component"))}(a,n);return(0,s.jsxs)("div",{ref:v,className:(0,Q.Z)("x_compPortHit group absolute origin-top-left cursor-crosshair flex items-center justify-center pointer-events-auto",(0,m.DX)(c)&&"transition-transform"),style:{width:12,height:12,transform:"translate(".concat(N.x,"px, ").concat(N.y,"px) scale(").concat(1/P,") translate(-50%, -50%)")},onMouseDown:e=>{w(e),e.stopPropagation(),e.preventDefault()},children:[(0,s.jsx)("div",{className:(0,Q.Z)("x_compPort absolute rounded-[5px] w-[10px] h-[10px] group-hover:shadow border border-black",C&&"bg-teal-400",!C&&"bg-orange-400")}),(0,s.jsx)("div",{className:(0,Q.Z)("font-mono absolute whitespace-nowrap",j===i.Top&&"rotate-[60deg] right-1 bottom-1 origin-right",j===i.Bottom&&"rotate-[60deg] left-1 top-1 origin-left",j===i.Left&&"right-4",j===i.Right&&"left-4"),children:a.id}),S&&(0,s.jsx)(U.z,{className:"cursor-crosshair"})]})});function ef(e,t,o,n){function i(e,t){if(e<0||e>=n.length)return null;let i=n.map(()=>0),r=n[e].linePos;for(let s=e;s>=0&&s<n.length;s+=t){let e=n[s];if(e.linePos!==r)break;i[s]=t;let l=e.linePos+t;if(l<1||l>o-1)return null;r=l}return i}let r=(0,m.uZ)(Math.round(t),1,o-1),s=n.findIndex(e=>e.linePos===r);if(s>=0){var l,a;let e=n[s].linePos,o=null;if(!(o=t<e?null!==(l=i(s,1))&&void 0!==l?l:i(s,-1):null!==(a=i(s,-1))&&void 0!==a?a:i(s,1)))return!1;for(let e=0;e<n.length;e++){let t=n[e],i=o[e];t.linePos+=i}}return e.linePos=r,n.push(e),!0}function eh(e,t){let o=1===e||3===e,n=1===e||2===e?t:new d.AO(0,0);return{fixedXPos:o,edgeLen:o?t.y:t.x,fixedPos:o?n.x:n.y}}function ex(e,t,o){let n=1===t||3===t,i=1===t||2===t?o:new d.AO(0,0);return ea(e.map((e,t)=>({srcIdx:t,pos:e.pos,linePos:n?e.pos.y:e.pos.x})).filter(e=>n?e.pos.x===i.x:e.pos.y===i.y),[e=>e.linePos])}(n=i||(i={}))[n.Top=0]="Top",n[n.Right=1]="Right",n[n.Bottom=2]="Bottom",n[n.Left=3]="Left";var eg=o(8450);function ey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.qn.None,o="";return(0,m.yE)(t,H.qn.CtrlOrCmd)&&(o+="Ctrl"),(0,m.yE)(t,H.qn.Alt)&&(o+=" Alt"),(0,m.yE)(t,H.qn.Shift)&&(o+=" Shift"),(o+" "+e).trim()}r||(r={});var ev=o(2484);let eb=e=>{let{className:t}=e;return(0,s.jsx)("div",{className:(0,Q.Z)(t,"w-[1px] bg-slate-300 my-1 mx-2")})},eS=e=>{let{className:t,icon:o,text:n,disabled:i,notImpl:r,tip:l,children:a,onClick:d}=e,c=(0,s.jsxs)("button",{className:(0,Q.Z)(t,"group self-stretch min-w-[3rem] flex items-center justify-center disabled:opacity-40 rounded-md my-1",!i&&"hover:bg-blue-300 active:bg-blue-400",r&&"bg-red-100"),disabled:i,onClick:d,children:[n,o&&(0,s.jsx)(O.G,{icon:o,className:(0,Q.Z)("text-gray-600 disabled:text-gray-300",n&&"ml-3")}),a]});return l?(0,s.jsx)(ev.u,{tip:l,children:c}):c},ew=()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(eS,{className:"px-4",children:[(0,s.jsx)(O.G,{icon:D.r8p,className:"mr-2"}),"Add Component"]})}),eI=e=>{let{readonly:t,toolbars:o}=e,{editorState:n,setEditorState:i}=(0,f._i)();function r(){i((0,f.wK)(n))}function l(){i((0,f.b)(n))}(0,H.qi)(H.Cf.MainPage,e=>{(0,H.Kc)(e,"z",H.qn.CtrlOrCmd)&&r(),((0,H.Kc)(e,"y",H.qn.CtrlOrCmd)||(0,H.Kc)(e,"z",H.qn.CtrlOrCmd|H.qn.Shift))&&l()});let a=n.undoStack.length>0,d=n.redoStack.length>0;return t?(0,s.jsxs)("div",{className:"top-1 left-1 h-12 bg-white drop-shadow-md flex",children:[(null==o?void 0:o.includes(h.eu.PlayPause))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eN,{}),(0,s.jsx)(eb,{})]}),(null==o?void 0:o.includes(h.eu.Viewport))&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eP,{})})]}):(0,s.jsxs)("div",{className:"h-12 bg-white drop-shadow-md flex",children:[(0,s.jsx)(eS,{icon:D.EdJ,onClick:function(){n.activeSchematicId&&n.schematicLibrary.saveToLocalStorage(n.activeSchematicId)},tip:"Save (".concat(ey("S",H.qn.CtrlOrCmd),")")}),(0,s.jsx)(eS,{icon:D.MDP,onClick:function(){},notImpl:!0,tip:"Duplicate (".concat(ey("S",H.qn.CtrlOrCmd|H.qn.Shift),")")}),(0,s.jsx)(eS,{icon:D.ISu,onClick:function(){n.activeSchematicId&&n.schematicLibrary.saveToFile(n.activeSchematicId,n.snapshot)},tip:"Save To File"}),(0,s.jsx)(eb,{}),(0,s.jsx)(eS,{icon:D.X7o,disabled:!a,onClick:r,tip:"Undo (".concat(ey("Z",H.qn.CtrlOrCmd),")")}),(0,s.jsx)(eS,{icon:D.XSV,disabled:!d,onClick:l,tip:"Redo (".concat(ey("Y",H.qn.CtrlOrCmd),", ").concat(ey("Z",H.qn.CtrlOrCmd|H.qn.Shift),")")}),(0,s.jsx)(eb,{}),(0,s.jsx)(eS,{className:"whitespace-nowrap px-4",onClick:function(){i(e=>(0,m.v4)(e,{compLibraryVisible:!e.compLibraryVisible}))},text:"Library",icon:D.FL8}),(0,s.jsx)(eb,{}),(0,s.jsx)(eN,{}),(0,s.jsx)(eb,{}),(0,s.jsx)(eP,{}),(0,s.jsx)(eb,{}),(0,s.jsx)(ew,{}),(0,s.jsx)(eb,{}),(0,s.jsxs)("div",{className:"min-w-[200px] h-full flex items-center",children:[(0,s.jsx)("div",{className:"mr-2",children:"Name:"}),(0,s.jsx)(eC,{value:n.snapshot.mainSchematic.name,setValue:function(e,t,o){i((0,f.pd)(o,e=>(0,m.v4)(e,{name:t})))}})]})]})},eC=e=>{let{value:t,setValue:o}=e,[n,i]=(0,l.useState)(null),r=(0,m.DX)(n),[a,d]=(0,l.useState)(null);function c(e){o(e,n,!0),i(null)}function u(e){o(e,t,!0),i(null)}return(0,l.useEffect)(()=>{a&&(a.focus(),a.select())},[a]),(0,s.jsxs)(s.Fragment,{children:[!r&&(0,s.jsx)("div",{className:"hover:bg-slate-300 bg-slate-100 my-1 px-2 py-1 rounded flex-1",onClick:()=>i(t),children:t}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{ref:d,type:"text",className:"bg-slate-300 px-2 py-1 mr-1 my-1 rounded focus:outline-none focus:border-slate-500 w-[16rem] max-w-[20rem] flex-shrink",value:n||"",onChange:e=>i(e.target.value),onKeyDown:function(e){r&&((0,H.Kc)(e,"Enter")?(c(e),e.stopPropagation(),e.preventDefault()):(0,H.Kc)(e,"Escape")&&(u(e),e.stopPropagation(),e.preventDefault())),e.stopPropagation()},onKeyUp:e=>e.stopPropagation()}),(0,s.jsx)("button",{className:"px-1 mx-1 hover:text-slate-200",onClick:c,children:(0,s.jsx)(O.G,{icon:D.LEp})}),(0,s.jsx)("button",{className:"px-1 mx-1 hover:text-slate-200",onClick:u,children:(0,s.jsx)(O.G,{icon:D.NBC})})]})]})},eN=()=>{let{editorState:e,setEditorState:t,exeModel:o}=(0,f._i)();function n(){b(o,{hardReset:!1}),y(o),t(e=>({...e}))}function i(){o.runArgs.halt||v(o),o.runArgs.halt||y(o),t(e=>({...e}))}(0,H.qi)(H.Cf.MainPage,e=>{(0,H.Kc)(e," ",H.qn.None)&&i(),(0,H.Kc)(e,"Backspace",H.qn.None)&&n()});let r=(0,m.DX)(e.stepSpeed),a=r&&e.stepSpeed<60,d=(0,m.DX)(e.stepSpeed)?1e3/e.stepSpeed:0,c=r&&!a;function u(){return o.runArgs.halt?(t(e=>(0,m.v4)(e,{stepSpeed:void 0})),!1):(o.runArgs.halt||v(o),y(o),t(e=>({...e})),!o.runArgs.halt)}(0,F.Yz)(a,d,()=>{u()},{runImmediately:!0});let p=(0,l.useRef)(0);c||(p.current=0),(0,F.gQ)(c,t=>{let o=performance.now(),n=e.stepSpeed*t/1;p.current+=n;let i=Math.floor(p.current);for(let e=0;e<i;e++){if(!u()||performance.now()>o+16){p.current=0;break}p.current-=1}});let h=o.runArgs.halt&&!r;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eS,{icon:D.oTz,disabled:!1,onClick:function(){b(o,{hardReset:!0}),y(o),t(e=>({...e}))},tip:"Hard reset: clear all memory"}),(0,s.jsx)(eS,{icon:D.On6,disabled:!1,onClick:n,tip:"Soft reset: clear RAM & registers (".concat(ey("Backspace"),")")}),(0,s.jsx)(eS,{icon:D._tD,disabled:h,onClick:i,className:"px-4",text:"Step",tip:"Take single step (".concat(ey("Space"),")")}),(0,s.jsx)(eS,{icon:r?D.XQY:D.zc,disabled:h,onClick:r?function(){t(e=>(0,m.v4)(e,{stepSpeed:void 0}))}:function(){t(e=>(0,m.v4)(e,{stepSpeed:1}))},tip:"Step slowly: 1 Hz"}),(0,s.jsx)(eS,{icon:D.irl,disabled:h,onClick:function(){t(e=>(0,m.v4)(e,{stepSpeed:20}))},tip:"Step medium: 20 Hz"}),(0,s.jsx)(eS,{icon:D.cZy,disabled:h,onClick:function(){t(e=>(0,m.v4)(e,{stepSpeed:1e5}))},tip:"Step fast as possible"})]})},eP=()=>{let{editorState:e,setEditorState:t,exeModel:o}=(0,f._i)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eS,{icon:D.TL5,disabled:!1,onClick:function(){t(e=>(0,m.v4)(e,{needsZoomExtent:!0}))},tip:"Zoom Extent"})})};var ej=o(1528);let eA=()=>{var e;let{editorState:t,setEditorState:o}=(0,f._i)(),n=(0,f.kt)(),i=(null!==(e=t.snapshotTemp)&&void 0!==e?e:t.snapshot).mainSchematic.compBbox;function r(e,t,n){o((0,f.pd)(e,e=>{let o=e.compBbox,i=o.min.clone(),r=o.max.clone();return t===W.Jd.Left||t===W.Jd.Right?t===W.Jd.Left?i.x=n.x:r.x=n.x:t===W.Jd.Top?i.y=n.y:r.y=n.y,i=eL(i),r=eL(r),(0,m.v4)(e,{compBbox:new d.bR(i,r)})}))}function l(e,t,n){o((0,f.pd)(e,e=>{let o=e.compBbox,i=o.min.clone(),r=o.max.clone();return t&W.yj.IsLeft?i.x=n.x:r.x=n.x,t&W.yj.IsTop?i.y=n.y:r.y=n.y,i=eL(i),r=eL(r),(0,m.v4)(e,{compBbox:new d.bR(i,r)})}))}let a=n.mtx.a,c=[W.Jd.Top,W.Jd.Right,W.Jd.Bottom,W.Jd.Left],u=[W.yj.TopLeft,W.yj.TopRight,W.yj.BottomRight,W.yj.BottomLeft];return(0,s.jsxs)("div",{style:{position:"absolute",transformOrigin:"top left",transform:"scale(".concat(1/a,")")},children:[c.map(e=>(0,s.jsx)(eO,{bb:i,side:e,viewLayout:n,onEdgeDrag:r},e)),u.map(e=>(0,s.jsx)(eD,{bb:i,corner:e,viewLayout:n,onCornerDrag:l},e))]})},eO=e=>{let t,{bb:o,side:n,onEdgeDrag:i,viewLayout:r}=e,[a,d]=(0,l.useState)(null),[c,u]=(0,I.gU)(a,e=>(e.stopPropagation(),e.preventDefault(),0),(e,t,o)=>{i(o,n,eT(r,e)),e.stopPropagation(),e.preventDefault()}),p=n===W.Jd.Left||n===W.Jd.Right,m=o.size(),f=r.mtx.a;if(p){let e=n===W.Jd.Left?o.min.x:o.max.x;t="translate(".concat(e*f,"px, ").concat(o.min.y*f,"px) translateX(-50%)")}else{let e=n===W.Jd.Top?o.min.y:o.max.y;t="translate(".concat(o.min.x*f,"px, ").concat(e*f,"px) translateY(-50%)")}return(0,s.jsx)("div",{ref:d,className:(0,Q.Z)("pointer-events-auto absolute"),style:{cursor:p?"ew-resize":"ns-resize",transform:t,width:p?"".concat(16,"px"):"".concat(m.x*f,"px"),height:p?"".concat(m.y*f,"px"):"".concat(16,"px")},onMouseDown:u,children:c&&(0,s.jsx)(U.z,{className:p?"cursor-ew-resize":"cursor-ns-resize"})})},eD=e=>{let{bb:t,corner:o,viewLayout:n,onCornerDrag:i}=e,[r,a]=(0,l.useState)(null),[d,c]=(0,I.gU)(r,e=>(e.stopPropagation(),e.preventDefault(),0),(e,t,r)=>{i(r,o,eT(n,e)),e.stopPropagation(),e.preventDefault()}),u=o===W.yj.TopLeft||o===W.yj.BottomRight,p=o&W.yj.IsLeft?t.min.x:t.max.x,m=o&W.yj.IsTop?t.min.y:t.max.y,f=n.mtx.a;return(0,s.jsx)("div",{ref:a,className:(0,Q.Z)("pointer-events-auto absolute"),style:{cursor:u?"nwse-resize":"nesw-resize",transform:"translate(".concat(p*f,"px, ").concat(m*f,"px) translate(-50%, -50%)"),width:"".concat(16,"px"),height:"".concat(16,"px")},onMouseDown:c,children:d&&(0,s.jsx)(U.z,{className:u?"cursor-nwse-resize":"cursor-nesw-resize"})})};function eT(e,t){var o;let n;return n=e.el.getBoundingClientRect(),o=new d.AO(t.clientX-n.left,t.clientY-n.top),e.mtx.mulVec3Inv(o)}function eL(e){return new d.AO(Math.round(e.x-.5)+.5,Math.round(e.y-.5)+.5)}var ek=o(2452);let eE=e=>{var t,o;let{}=e,{editorState:n,setEditorState:i}=(0,f._i)(),r=null!==(t=n.snapshotTemp)&&void 0!==t?t:n.snapshot,l=r.selected.length,a=1===l&&r.selected[0].type===h.ru.Comp?r.selected[0]:null,d=a?(0,g.f1)(n,a.id):null,c=d?n.compLibrary.getCompDef(d.defId):null,u=d?(0,g.N_)(n,d):null;return(0,s.jsxs)("div",{className:"flex flex-col flex-1",children:[0===l&&(0,s.jsx)("div",{children:"No component selected"}),1===l&&d&&c&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mt-2 mb-2 mx-2",children:(0,s.jsx)("b",{children:d.name})}),(0,s.jsxs)("div",{className:"mx-2",children:[(0,s.jsx)(eR,{label:"Id",children:(0,s.jsx)("code",{children:d.id})}),(0,s.jsx)(eR,{label:"Def Id",children:(0,s.jsx)("code",{children:d.defId})}),(0,s.jsx)(eR,{label:"Name",children:(0,s.jsx)(ek.E,{className:"bg-slate-100 rounded flex-1",value:d.name,update:function(e,t){i((0,f.R$)({idPrefix:""},e,d,e=>(0,m.v4)(e,{name:t})))}})}),(0,s.jsx)(eR,{label:"Ext Id",children:(0,s.jsx)(ek.E,{className:"bg-slate-100 rounded font-mono flex-1",value:null!==(o=d.extId)&&void 0!==o?o:"",update:function(e,t){i((0,f.R$)({idPrefix:""},e,d,e=>(0,m.v4)(e,{extId:t})))}})}),(0,s.jsx)(eR,{label:"Pos",children:"".concat(d.pos)}),(0,s.jsx)(eR,{label:"Size",children:"".concat(d.size)})]}),(0,s.jsxs)("div",{className:"m-2",children:[(0,s.jsx)("div",{className:"mb-2",children:"Internal Schematic"}),!u&&(0,s.jsxs)("button",{className:"rounded border-gray-400 border border-solid py-1 px-2 hover:bg-slate-100",onClick:function(){let e=n.schematicLibrary.addCustomSchematic("New Schematic");e.model.mainSchematic.parentCompDefId=d.defId,i((0,f.R$)({idPrefix:""},!0,d,t=>(0,m.v4)(t,{subSchematicId:e.id})))},children:[(0,s.jsx)(O.G,{icon:D.r8p,className:"mr-2"}),"Add New"]}),d.subSchematicId&&(0,s.jsx)(eR,{label:"Id",children:(0,s.jsx)("code",{children:d.subSchematicId})}),u&&(0,s.jsx)(eR,{label:"Name",children:(0,s.jsx)("code",{children:null==u?void 0:u.name})})]})]})]})},eR=e=>{let{label:t,children:o}=e;return(0,s.jsxs)("div",{className:"flex flex-row items-center my-1",children:[(0,s.jsx)("div",{className:"w-[5rem] mr-2",children:t}),(0,s.jsx)("div",{className:"flex-1",children:o})]})},e_=e=>{var t,o,n;let{schematicId:i,readonly:r,embedded:c,toolbars:v,children:b}=e,[S,w]=(0,l.useState)(null),I=(0,l.useContext)(ej.Y0),[N,P]=(0,l.useState)(()=>(0,eg.ry)(I)),[,j]=(0,l.useReducer)(e=>e+1,0),[A,O]=(0,l.useState)(!1);(0,l.useEffect)(()=>O(!0),[]),(0,l.useEffect)(()=>{i&&P(e=>(0,m.v4)(e,{desiredSchematicId:null!=i?i:null}))},[i]),(0,l.useLayoutEffect)(()=>{if(S){let e=S.canvas.getBoundingClientRect();P(t=>{if(!t.needsZoomExtent)return t;let o=(0,eg.pf)(t.snapshot);o.empty&&(o=new d.bR(new d.AO(0,0),new d.AO(20,20)));let n=(0,eg.ip)(o,new d.bR(new d.AO(r?0:330,r?50:0),new d.AO(e.width,e.height)),.05);return(0,m.v4)(t,{mtx:n,needsZoomExtent:!1})})}},[S,N.needsZoomExtent,r]),(0,l.useEffect)(()=>{let e=null!=I?I:(0,ej.y7)();P(t=>(0,m.v4)(t,{sharedContext:e,codeLibrary:e.codeLibrary,schematicLibrary:e.schematicLibrary,compLibrary:e.compLibrary,snapshot:(0,m.v4)(t.snapshot,{mainSchematic:(0,m.v4)(t.snapshot.mainSchematic,{comps:e.compLibrary.updateAllCompsFromDefs(t.snapshot.mainSchematic.comps)})}),needsZoomExtent:!0}))},[I]),(0,l.useEffect)(()=>{if(N.activeSchematicId!==N.desiredSchematicId&&N.desiredSchematicId&&N.schematicLibrary.localStorageSchematicsLoaded){let n=N.schematicLibrary.getSchematic(N.desiredSchematicId);if(n){var e,t,o;P(i=>(0,m.v4)(i,{activeSchematicId:n.id,snapshot:n.model,undoStack:null!==(e=n.undoStack)&&void 0!==e?e:[],redoStack:null!==(t=n.redoStack)&&void 0!==t?t:[],mtx:null!==(o=n.mtx)&&void 0!==o?o:new p.t,needsZoomExtent:!0}))}else P(e=>(0,m.v4)(e,{desiredSchematicId:null}))}},[N.desiredSchematicId,N.schematicLibrary,N.activeSchematicId,N.schematicLibrary.localStorageSchematicsLoaded]),(0,a.T)(null==S?void 0:null===(t=S.canvas)||void 0===t?void 0:t.parentElement,j);let D=(0,l.useRef)(null),L=(0,l.useMemo)(()=>{var e,t,o;let n,i,r=D.current,s=r&&r.id===N.activeSchematicId,l=(e=N.sharedContext,t=N.snapshot,o=r&&s?r.system:null,n={compLibrary:e.compLibrary,comps:[],nets:[],executionSteps:[],latchSteps:[],lookup:{compIdToIdx:new Map,wireIdToNetIdx:new Map},runArgs:{halt:!1}},function e(t,o,n,i,r,s){let l=t.compLibrary,a=i.wires,d=i.comps,c=new Map;for(let e=0;e<d.length;e++)c.set(d[e].id,e);let u=new Map,p=new Map;for(let a of i.comps){let i=l.getCompDef(a.defId),d=(0,g.sH)(t,o,a);d&&e(t,o,n,d,r+a.id+"|",s);let c=r+a.id,m=l.build(a);if(m.compFullId=c,s){let e=s.lookup.compIdToIdx.get(c),t=s.comps[e];if(t){var f;null===(f=i.copyStatefulData)||void 0===f||f.call(i,t.data,m.data)}}let h=n.comps.length;if(m.idx=h,u.set(a,h),n.lookup.compIdToIdx.set(c,h),n.comps.push(m),d){let e=r+a.id+"|",t=d.comps.filter(e=>e.defId===x.rS),o=m.ports.map(o=>{let i=m.comp.ports[o.portIdx],r=t.find(e=>e.args.portId===i.id);return r?n.comps[n.lookup.compIdToIdx.get(e+r.id)]:null});p.set(m.comp,o)}}for(let e of a){let t=e.nodes.map(e=>e.ref).filter(m.DX),o=n.nets.length,i=h.bS.None,s=!1,l=1,a=[],f=[];for(let e of t){let t=d[c.get(e.id)];if(!t)continue;let r=t.ports.findIndex(t=>t.id===e.compNodeId);if(r<0)continue;let x=n.comps[u.get(t)],g=x.ports[r];g.netIdx=o;let y=p.get(x.comp),v=!0;if(y){let e=y[r];if(e){e.data.externalPortBound=!0;let t=e.ports[1];t.netIdx=o;let n={comp:e.comp,portIdx:1,exeComp:e,exePort:t,valid:!0};(0,m.yE)(g.type,h.bS.In)&&a.push(n),(0,m.yE)(g.type,h.bS.Out)&&(f.push(n),v=!1)}}(0,m.yE)(g.type,h.bS.In)&&a.push({comp:t,portIdx:r,exeComp:x,exePort:g,valid:!0}),(0,m.yE)(g.type,h.bS.Out)&&v&&f.push({comp:t,portIdx:r,exeComp:x,exePort:g,valid:!0}),(0,m.yE)(g.type,h.bS.Tristate)&&(s=!0),l=g.width,i|=g.type}let x=r+e.id,g={idx:o,width:l,wireFullId:x,wire:e,tristate:s,inputs:a,outputs:f,value:0,enabledCount:0,type:i};n.lookup.wireIdToNetIdx.set(x,o),n.nets.push(g)}}(e,t,n,t.mainSchematic,"",o),i=function(e,t){let o=e.length+t.length,n=new Map,i=(e,t)=>e+t*o,r=(t,n)=>e.length+t+n*o,s=t=>{let n=t%o;return n>=e.length?null:{compIdx:n,phaseIdx:Math.floor(t/o)}},l=t=>{let n=t%o;return n<e.length?null:{netIdx:n-e.length,phaseIdx:Math.floor(t/o)}},a=new Map;for(let e=0;e<t.length;e++){let o=t[e],n=1;for(let e of o.inputs)(e.exePort.type&h.bS.InOutTri)===h.bS.InOutTri&&(n=2);a.set(e,n)}let d=[],c=new Map,u=0;for(let o=0;o<e.length;o++){let s=e[o];for(let e=0;e<s.phases.length;e++){let l=s.phases[e],d=i(o,e),p=e<s.phases.length-1;n.set(d,0);let f=(0,m.Dw)(c,d,()=>[]);if(p){let t=i(o,e+1);f.push(t)}for(let o of(u+=1,l.writePortIdxs)){let n=s.ports[o];if(!t[n.netIdx])continue;let i=a.get(n.netIdx),l=0;i>1&&(0,m.yE)(n.type,h.bS.InOutTri)&&(l=function(e,t,o){for(let n=0;n<=o;n++)if(t.phases[n].readPortIdxs.includes(e.portIdx))return 1;return 0}(n,s,e));let d=r(n.netIdx,l);f.push(d)}}}for(let e=0;e<t.length;e++){let o=t[e],s=a.get(e);for(let t=0;t<s;t++){let l=r(e,t);n.set(l,0);let a=(0,m.Dw)(c,l,()=>[]);for(let e of o.inputs){let o=e.exeComp,n=o.phases.findIndex(t=>t.readPortIdxs.includes(e.portIdx)),r=o.phases.findIndex(t=>t.writePortIdxs.includes(e.portIdx));if(n<0||s>0&&r>=0&&!(t>0!=r>=n))continue;let l=i(e.exeComp.idx,n);a.push(l)}}}for(let[,e]of c)for(let t of e){var p;let e=null!==(p=n.get(t))&&void 0!==p?p:0;n.set(t,e+1)}let f=[];for(let[e,t]of n)0===t&&f.push(e);for(;f.length>0;){let e=f.splice(0,1)[0];d.push(e);let t=c.get(e);if(t)for(let e of t){let t=n.get(e);t--,n.set(e,t),0===t&&f.push(e)}}let x=e.map(e=>0),g=[],y=[];for(let t of d){let o=s(t);if(o){let{compIdx:t,phaseIdx:n}=o;x[t]=n+1;let i=e[t].phases[n],r={compIdx:t,phaseIdx:n,netIdx:-1};i.isLatch?y.push(r):g.push(r)}else{let{netIdx:e,phaseIdx:o}=l(t),n={compIdx:-1,phaseIdx:o,netIdx:e};g.push(n)}}let v=[...g,...y].filter(e=>e.compIdx>=0).length;return v!==u&&(console.log("detected a cycle; execution order may be incorrect: expected exe nodes",u,"got",v),console.log(e,t)),{executionSteps:g,latchSteps:y}}(n.comps,n.nets),n.executionSteps=i.executionSteps,n.latchSteps=i.latchSteps,n);return A&&y(l),l},[N.sharedContext,N.snapshot,N.activeSchematicId,A]);D.current={system:L,id:N.activeSchematicId};let k=(0,l.useCallback)(e=>{w(e?{canvas:e,ctx:e.getContext("2d"),size:new d.AO(1,1),scale:1,region:new d.bR(new d.AO(0,0),new d.AO(1,1)),tileCanvases:new Map,mtx:p.t.identity()}:null)},[]);(0,l.useLayoutEffect)(()=>{var e;if(!S)return;let{canvas:t,ctx:o}=S,n=t.parentElement.getBoundingClientRect(),i=n.width,r=n.height;t.width=Math.floor(i*window.devicePixelRatio),t.height=Math.floor(r*window.devicePixelRatio),t.style.width="".concat(i,"px"),t.style.height="".concat(r,"px"),S.size.x=i,S.size.y=r,S.region=new d.bR(new d.AO(0,0),new d.AO(i,r)),S.scale=1/N.mtx.a,S.mtx=N.mtx;let s=window.devicePixelRatio;o.save(),o.clearRect(0,0,t.width,t.height),o.scale(s,s),o.transform(...N.mtx.toTransformParams()),o.save(),function e(t,o,n,i){var r,s,l,a,c;let u,p,f;let x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",y=t.ctx,v=null!==(r=o.snapshotTemp)&&void 0!==r?r:o.snapshot;for(let e of((0,_.Kw)(o.mtx,y,t,"#aaa",!!x),n.wires)){let n=i.nets[null!==(s=i.lookup.wireIdToNetIdx.get(x+e.id))&&void 0!==s?s:-1];!function(e,t,o,n,i,r){var s,l,a,d;let c=e.ctx,u=!1,p=r+o.id,f=!1,x=new Map,g=new Set,y=new Set,v=(e,t)=>"".concat(e,":").concat(t),b=0;if(n){f=0!==n.value;let e=(e,t)=>"".concat(e,":").concat(t);for(let t of[...n.inputs,...n.outputs]){let o=t.exeComp,n=t.exePort,i=o.comp,r=i.ports[n.portIdx];r&&x.set(e(i.id,r.id),{comp:i,port:i.ports[n.portIdx],exePort:n,nodeId:-1})}let t=new Map;for(let n of o.nodes)if((null===(l=n.ref)||void 0===l?void 0:l.type)===h.ru.CompNode){let o=x.get(e(n.ref.id,n.ref.compNodeId));if(o){let e=o.port;(0,m.yE)(e.type,h.bS.Ctrl)&&(u=!0),(0,m.yE)(e.type,h.bS.Data),(0,m.yE)(e.type,h.bS.Addr),t.set(n.id,o),o.nodeId=n.id}}let i=[],r=[];for(let e of t.values())(0,m.yE)(e.port.type,h.bS.In)&&e.exePort.ioDir!==h.H.Out&&e.exePort.dataUsed&&i.push(e.nodeId),(0,m.yE)(e.port.type,h.bS.Out)&&e.exePort.ioDir!==h.H.In&&e.exePort.dataUsed&&r.push(e.nodeId);for(let e of i){let t=new Set,n=new Map,i=[e];for(;i.length>0;){let e=i.shift();if(!t.has(e))for(let r of(t.add(e),o.nodes[e].edges)){let s=o.nodes[r];t.has(s.id)||(n.set(s.id,e),i.push(s.id))}}for(let t of r){let o=t;for(;o!==e;){let e=n.get(o);if(void 0===e)break;g.add(v(e,o)),y.add(e),o=e}}}b=r.length}let S=u||(null==n?void 0:n.width)<32?1:3,w=null===(s=t.hovered)||void 0===s?void 0:s.ref,I=((null==w?void 0:w.type)===h.ru.WireSeg||(null==w?void 0:w.type)===h.ru.WireNode)&&w.id===p,C=!1,N=new Set,P=new Set;for(let e of t.snapshot.selected)(e.type===h.ru.WireNode||e.type===h.ru.WireSeg)&&e.id===p&&(C=!0,e.type===h.ru.WireNode&&N.add(e.wireNode0Id),e.type===h.ru.WireSeg&&P.add(v(e.wireNode0Id,e.wireNode1Id)));if(c.lineCap="square",c.lineJoin="round",b>1&&(c.save(),(0,B.Tb)(o,(t,o)=>{c.beginPath(),c.strokeStyle="#f00",c.lineWidth=(S+5)*e.scale,c.moveTo(t.pos.x,t.pos.y),c.lineTo(o.pos.x,o.pos.y),c.stroke()}),c.restore()),C){for(let t of(c.save(),c.beginPath(),(0,B.Tb)(o,(e,t)=>{C&&P.has(v(e.id,t.id))&&(c.moveTo(e.pos.x,e.pos.y),c.lineTo(t.pos.x,t.pos.y))}),c.strokeStyle="#00f",c.lineWidth=(S+3)*e.scale,c.stroke(),c.beginPath(),o.nodes))C&&N.has(t.id)&&(c.moveTo(t.pos.x,t.pos.y),c.arc(t.pos.x,t.pos.y,3*e.scale,0,2*Math.PI));c.strokeStyle="#00f",c.lineWidth=S*e.scale,c.stroke(),c.restore()}I&&(c.save(),(0,B.Tb)(o,(t,o)=>{(c.beginPath(),I&&w.type===h.ru.WireSeg&&w.wireNode0Id===t.id&&w.wireNode1Id===o.id)?c.strokeStyle="#55f":c.strokeStyle="#000",c.lineWidth=S*e.scale,c.filter="blur(3px)",c.moveTo(t.pos.x,t.pos.y),c.lineTo(o.pos.x,o.pos.y),c.stroke()}),c.restore());let j="#D3D3D3",A=f?"#d95f0e":"#fec44f";for(let t of((0,B.Tb)(o,(t,o)=>{c.beginPath();let n=g.has(v(t.id,o.id)),i=g.has(v(o.id,t.id));c.strokeStyle=j,(n||i)&&(c.strokeStyle=A),c.lineWidth=S*e.scale,c.moveTo(t.pos.x,t.pos.y),c.lineTo(o.pos.x,o.pos.y),c.stroke()}),o.nodes)){let n=new Set;for(let e of t.edges){let i=o.nodes[e].pos.sub(t.pos).normalize(),r="".concat(i.x.toFixed(2),",").concat(i.y.toFixed(2));n.add(r)}if(n.size>2){let o=t.pos.x,n=t.pos.y,i=1.7*Math.max(S,2)*e.scale;c.beginPath(),c.arc(o,n,i,0,2*Math.PI);let r=y.has(t.id);c.fillStyle=r?A:j,c.fill()}if(C)for(let t of(c.fillStyle="#666",c.font=(0,_.We)(18*e.scale,_.Ky.Mono),c.textBaseline="bottom",c.textAlign="left",o.nodes))c.fillText(t.id.toString(),t.pos.x+.1,t.pos.y-.1)}for(let t of o.nodes)a=t.pos,(d=I&&(0,m.kK)(null==w?void 0:w.wireNode1Id)&&(null==w?void 0:w.wireNode0Id)===t.id)&&(c.beginPath(),c.arc(a.x,a.y,5*e.scale,0,2*Math.PI),c.strokeStyle=d?"#f00":"#000",c.lineWidth=2*e.scale,c.stroke());if(t.showExeOrder){let t=i.lookup.wireIdToNetIdx.get(p),n=i.executionSteps.findIndex(e=>e.netIdx===t);if(n>=0)for(let t of o.nodes)c.fillStyle="#666",c.font=(0,_.We)(18*e.scale,_.Ky.Mono),c.textBaseline="bottom",c.textAlign="left",c.fillText(n.toString(),t.pos.x+.1,t.pos.y-.1)}}(t,o,e,n,i,x)}let b=new Map,S=0;for(let e of i.executionSteps)(0,m.Dw)(b,e.compIdx,()=>[]).push(S++);let w=1===o.snapshot.selected.length?o.snapshot.selected[0]:null;for(let r of(y.save(),y.globalAlpha=o.transparentComps?.5:1,n.comps)){let n=x+r.id,s=null!==(a=i.lookup.compIdToIdx.get(n))&&void 0!==a?a:-1,u=i.comps[s],p=o.compLibrary.getCompDef(r.defId),m=(null===(l=o.hovered)||void 0===l?void 0:l.ref.type)===h.ru.Comp&&o.hovered.ref.id===n,f=!!u;y.fillStyle=f?ed.D.compBg:"#aaa",y.strokeStyle=m?"#a00":"#000",y.lineWidth=1*t.scale,(null==p?void 0:p.renderAll)!==!0&&(y.beginPath(),y.rect(r.pos.x,r.pos.y,r.size.x,r.size.y),y.fill(),y.stroke());let v={comp:r,ctx:y,cvs:t,exeComp:u,editCtx:{idPrefix:x},styles:{fontSize:1.6,lineHeight:2,fillColor:f?"#8a8":"#aaa",strokeColor:m?"#a00":"#000",lineWidth:1*t.scale},isActive:!!w&&w.type===h.ru.Comp&&w.id===n};if(null==p?void 0:p.render)p.render(v);else if(null==p?void 0:p.renderDom);else{let e=r.name;y.font=(0,_.We)(3/4),y.textAlign="center",y.textBaseline="middle",y.fillStyle="#000",y.fillText(e,r.pos.x+r.size.x/2,r.pos.y+r.size.y/2)}for(let e of r.ports)(function(e,t,o,n){var i,r;let s=null===(i=t.hovered)||void 0===i?void 0:i.ref,l=(null==s?void 0:s.type)===h.ru.CompNode&&s.id===o.id&&s.compNodeId===n.id,a=null!==(r=n.type)&&void 0!==r?r:0,d=(a&h.bS.In)!=0,c=(a&h.bS.Tristate)!=0,u=e.ctx,p=o.pos.x+n.pos.x,m=o.pos.y+n.pos.y,f=Math.min(e.scale,1/15);if(u.beginPath(),u.arc(p,m,3*f,0,2*Math.PI),u.strokeStyle=l?"#f00":"#000",u.fillStyle=d?"#fff":c?"#a3f":"#00fa",u.fill(),u.stroke(),n.name){let e=0===n.pos.y,t=n.pos.y===o.size.y,i=0===n.pos.x,r=n.pos.x===o.size.x,s=n.name;u.font=(0,_.We)(12*f),u.textAlign=e||t?"center":i?"start":"end",u.textBaseline=i||r?"middle":e?"top":"bottom",u.fillStyle="#000";let l=8*f,a=i?l:r?-l:0,d=e?l:t?-l:0;u.fillText(s,p+a,m+d)}})(t,o,r,e);let S=(0,g.N_)(o,r);if(p&&S){y.save();let n=(0,g.hz)(r,S);y.transform(...n.toTransformParams());let s=t.mtx.mul(n.inv());e({...t,mtx:t.mtx.mul(n),scale:t.scale/n.a,region:s.mulBb(new d.bR(r.pos,r.pos.add(r.size)))},o,S,i,x+r.id+"|"),y.restore()}if(o.showExeOrder){let e=(null!==(c=b.get(s))&&void 0!==c?c:[]).join(", ");y.save(),y.fillStyle="#a3a",y.strokeStyle="#000",y.lineWidth=3*t.scale,y.font=(0,_.We)(30*t.scale),y.textAlign="center",y.textBaseline="middle";let o=r.pos.x+r.size.x/2,n=r.pos.y+r.size.y/2;y.strokeText(e,o,n),y.fillText(e,o,n),y.restore()}}y.restore(),y.save(),y.beginPath();let I=new Set(o.snapshot.selected.filter(e=>e.type===h.ru.Comp).map(e=>e.id));for(let e of n.comps.filter(e=>I.has(x+e.id)))y.rect(e.pos.x,e.pos.y,e.size.x,e.size.y);y.strokeStyle="#77f",y.lineWidth=2*t.scale,y.filter="blur(1px)",y.stroke(),y.restore(),function(e,t,o){if(!t.selectRegion||t.selectRegion.idPrefix!==o)return;let n=t.selectRegion,i=e.ctx,r=n.bbox.min,s=n.bbox.max;i.save(),i.strokeStyle="#000",i.lineWidth=1*e.scale,i.beginPath(),i.rect(r.x,r.y,s.x-r.x,s.y-r.y),i.stroke(),i.restore()}(t,o,x),(u=t.ctx).save(),f=(p=v.mainSchematic.compBbox).size(),u.beginPath(),u.rect(p.min.x,p.min.y,f.x,f.y),u.lineWidth=1*t.scale,u.strokeStyle="#000",u.stroke(),u.restore()}(S,N,(null!==(e=N.snapshotTemp)&&void 0!==e?e:N.snapshot).mainSchematic,L),o.restore(),o.restore()});let E=(0,l.useMemo)(()=>({editorState:N,setEditorState:P,cvsState:S,exeModel:L}),[N,P,S,L]),M=1===N.snapshot.selected.length?N.snapshot.selected[0]:null,z=function e(t,o){let n=t.comps.map(e=>{let t=N.compLibrary.getCompDef(e.defId);return(t.renderDom||t.subLayout||e.subSchematicId)&&S?{comp:e,def:t,renderDom:t.renderDom}:null}).filter(m.DX).map(t=>{var n,i,r;S.mtx=N.mtx;let a=o+t.comp.id,d=null,c=(0,g.N_)(N,t.comp);if(c){let n=(0,g.hz)(t.comp,c);d=(0,s.jsx)("div",{className:"absolute origin-top-left",style:{transform:"matrix(".concat(n.toTransformParams().join(","),")")},children:e(c,o+t.comp.id+"|")})}return(0,s.jsxs)(l.Fragment,{children:[null!==(r=null===(n=t.renderDom)||void 0===n?void 0:n.call(t,{comp:t.comp,ctx:null==S?void 0:S.ctx,cvs:S,editCtx:{idPrefix:o},exeComp:L.comps[null!==(i=L.lookup.compIdToIdx.get(a))&&void 0!==i?i:-1],styles:null,isActive:!!M&&M.type===h.ru.Comp&&M.id===a}))&&void 0!==r?r:null,d]},t.comp.id)});return(0,s.jsxs)(s.Fragment,{children:[n,(0,s.jsx)(eA,{})]})}((null!==(o=N.snapshotTemp)&&void 0!==o?o:N.snapshot).mainSchematic,""),W=(0,l.useMemo)(()=>{var e;return{el:null!==(e=null==S?void 0:S.canvas)&&void 0!==e?e:null,mtx:N.mtx}},[S,N.mtx]);return(0,s.jsx)(f.rU.Provider,{value:E,children:(0,s.jsxs)(f.rA.Provider,{value:W,children:[!c&&(0,s.jsx)(eI,{readonly:r,toolbars:v}),(0,s.jsxs)($.w,{className:"flex-1 flex flex-row",id:"cpu-tools-right",defaultFraction:.9,children:[(0,s.jsxs)("div",{className:"relative touch-none flex-1 overflow-hidden",children:[(0,s.jsx)("canvas",{className:"absolute touch-none w-full h-full",ref:k}),S&&(0,s.jsx)(K,{cvsState:S,embedded:c,children:(0,s.jsxs)("div",{className:"overflow-hidden absolute left-0 top-0 w-full h-full pointer-events-none",children:[(0,s.jsx)("div",{className:"absolute origin-top-left",style:{transform:"matrix(".concat(N.mtx.toTransformParams().join(","),")")},children:z}),N.transparentComps&&(0,s.jsx)("div",{className:"absolute w-full h-full pointer-events-auto top-0 left-0"})]})}),(0,s.jsxs)("div",{className:u().toolsLeftTop,children:[!c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{}),(0,s.jsx)(T,{}),(0,s.jsx)(V,{})]}),!N.snapshotTemp&&!N.maskHover&&(0,s.jsx)(R,{canvasEl:null!==(n=null==S?void 0:S.canvas)&&void 0!==n?n:null})]}),c&&(0,s.jsx)("div",{className:"absolute left-2 top-2 pointer-events-auto",children:(0,s.jsx)(eI,{readonly:r,toolbars:v})}),(0,s.jsx)("div",{className:"cls_toolsTopRight absolute top-0 right-0",children:!r&&(0,s.jsx)(ec,{})}),N.compLibraryVisible&&(0,s.jsx)(eo,{}),b]}),!r&&(0,s.jsx)("div",{className:"flex-1 flex flex-col",children:(0,s.jsx)(eE,{})})]})]})})}},4603:function(e,t,o){"use strict";var n,i,r,s,l,a,d,c;o.d(t,{H:function(){return n},bS:function(){return s},eu:function(){return i},ru:function(){return r}}),(l=n||(n={}))[l.None=0]="None",l[l.In=1]="In",l[l.Out=2]="Out",(a=i||(i={})).PlayPause="PlayPause",a.Viewport="Viewport",(d=r||(r={}))[d.Comp=0]="Comp",d[d.WireSeg=1]="WireSeg",d[d.WireNode=2]="WireNode",d[d.CompNode=3]="CompNode",(c=s||(s={}))[c.None=0]="None",c[c.In=1]="In",c[c.Out=2]="Out",c[c.Tristate=4]="Tristate",c[c.Data=8]="Data",c[c.Addr=16]="Addr",c[c.Ctrl=32]="Ctrl",c[c.OutTri=6]="OutTri",c[c.InOutTri=7]="InOutTri"},2442:function(e,t,o){"use strict";o.d(t,{DG:function(){return x},QQ:function(){return c},R$:function(){return u},Rq:function(){return p},WR:function(){return m},_i:function(){return b},b:function(){return y},kt:function(){return w},pd:function(){return f},rA:function(){return S},rU:function(){return v},uT:function(){return i},wK:function(){return g},yC:function(){return h}});var n,i,r=o(2265),s=o(9107),l=o(7104),a=o(2348),d=o(527);function c(e,t,o,n,i){return u(e,t,o,e=>(0,s.v4)(e,{args:n(e.args)}),i)}function u(e,t,o,n,r){return p(e,t,(e,t)=>{var a;let d=e.comps.find(e=>e.id===o.id);if(!d)return console.log("unable to edit comp!!"),e;let c=n(d);return c===d?e:(e=(0,s.v4)(e,{comps:e.comps.map(e=>e.id===o.id?c:e)}),t.compLibrary.updateCompFromDef(c),e=(0,l.dE)(e,c,null!==(a=null==r?void 0:r.portHandling)&&void 0!==a?a:i.Move))})}function p(e,t,o){return n=>{let i=m(n,e,n.snapshot,e=>o(e,n,n.snapshot));if(t){if(i===n.snapshot)return(0,s.v4)(n,{snapshotTemp:null});n=(0,s.v4)(n,{snapshot:i,snapshotTemp:null,undoStack:[...n.undoStack,n.snapshot],redoStack:[]})}else n=(0,s.v4)(n,{snapshotTemp:i});return n}}function m(e,t,o,n){if(!t.idPrefix)return(0,s.v4)(o,{mainSchematic:n(o.mainSchematic)});{let i=(0,d.kn)(e.sharedContext,o,t.idPrefix);if(i)return(0,s.v4)(o,{subSchematics:(0,s.v4)(o.subSchematics,{[i.id]:n(i)})})}return o}function f(e,t){return p({idPrefix:""},e,t)}function h(e,t){return o=>{let n=t(o.snapshot,o);if(e){if(n===o.snapshot)return(0,s.v4)(o,{snapshotTemp:null});o=(0,s.v4)(o,{snapshot:n,snapshotTemp:null,undoStack:[...o.undoStack,o.snapshot],redoStack:[]})}else o=(0,s.v4)(o,{snapshotTemp:n});return o}}function x(e){return t=>{let o=e(t.snapshot,t);return(0,s.v4)(t,{snapshot:o,snapshotTemp:null})}}function g(e){return 0===e.undoStack.length?e:(0,s.v4)(e,{snapshot:e.undoStack[e.undoStack.length-1],undoStack:e.undoStack.slice(0,e.undoStack.length-1),redoStack:[...e.redoStack,e.snapshot]})}function y(e){return 0===e.redoStack.length?e:(0,s.v4)(e,{snapshot:e.redoStack[e.redoStack.length-1],undoStack:[...e.undoStack,e.snapshot],redoStack:e.redoStack.slice(0,e.redoStack.length-1)})}(n=i||(i={}))[n.Detach=0]="Detach",n[n.Move=1]="Move";let v=(0,r.createContext)(null);function b(){let e=(0,r.useContext)(v);if(!e)throw Error("EditorContext not found");return e}let S=(0,r.createContext)(null);function w(){return(0,r.useContext)(S)}new class{setValue(e){this.value=e,this.subs.notify()}constructor(e){this.value=e,this.subs=new a.tH}}(null)},2845:function(e,t,o){"use strict";function n(e){let t=e.subarray(0,4);if(127!==t[0]||69!==t[1]||76!==t[2]||70!==t[3])throw Error("Invalid ELF file (magic was ".concat(t,", but should be 0x7F 'E' 'L' 'F')"));let o=e[4],n=e[5],i=e[6],l=e[7],a=e[8];if(1!==o||1!==n||1!==i)throw Error("Invalid ELF file: (class, endian, version) was (".concat(o,", ").concat(n,", ").concat(i,"), but should be (1 [32bit], 1 [little endian], 1)"));let d=e[16],c=e[18],u=r(e,20);if(2!==d&&1!==d||243!==c)throw Error("Invalid ELF file: (type, machine) was (".concat(d,", 0x").concat(c.toString(16),"), but should be (1 [relocatable] or 2 [exe], 0xf3 [RISC-V])"));return{magic:t,class:o,endian:n,version:i,osAbi:l,abiVersion:a,type:d,machine:c,version2:u,entryPoint:r(e,24),phOff:r(e,28),shOff:r(e,32),flags:r(e,36),ehSize:s(e,40),phEntSize:s(e,42),phNum:s(e,44),shEntSize:s(e,46),shNum:s(e,48),shStrNdx:s(e,50)}}function i(e,t){let o=[],n=t.shOff,i=t.shEntSize,s=t.shNum,l=r(e,t.shOff+t.shStrNdx*t.shEntSize+16);for(let t=0;t<s;t++){let s=n+t*i,a=r(e,s+0),d=r(e,s+4),c=r(e,s+8),u=r(e,s+16),p=r(e,s+20);if(1===d&&6===c&&p>0){let t=function(e,t){let o="";for(let n=t;n<e.length&&0!==e[n];n++)o+=String.fromCharCode(e[n]);return o}(e,l+a);o.push({name:t,offset:u,size:p,arr:e.subarray(u,u+p)})}}return o}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]|e[t+1]<<8)>>>0}o.d(t,{Qf:function(){return i},X4:function(){return n}})},6624:function(e,t,o){"use strict";o.d(t,{dk:function(){return a},oo:function(){return d},u1:function(){return l},vz:function(){return c}});var n=o(9107),i=o(9158),r=o(4603),s=o(7104);function l(e){let t="#wire-schema 1\n";for(let o=0;o<e.comps.length;o++){let n=e.comps[o],i=n.args?" c:"+JSON.stringify(n.args):"";t+="C ".concat(n.id," ").concat(n.defId," p:").concat(n.pos.x,",").concat(n.pos.y).concat(i,"\n")}for(let n=0;n<e.wires.length;n++){let i=e.wires[n];t+="W ".concat(i.id," ns:[");for(let e=0;e<i.nodes.length;e++){var o;let n=i.nodes[e],s="";e>0&&(s+="|"),s+=[n.pos.x,n.pos.y].concat(n.edges.filter(t=>t<e)).join(","),(null===(o=n.ref)||void 0===o?void 0:o.type)===r.ru.CompNode&&(s+=" p:".concat(n.ref.id,"/").concat(n.ref.compNodeId)),t+=s}t+="]\n"}return t}function a(e){let t={issues:null},o=e.split("\n");function n(e,n,i){t.issues=t.issues||[],t.issues.push({issue:e,lineNo:n+1,lineContent:o[n],colNo:i})}if(0===o.length||!o[0].startsWith("#wire-schema"))return n("Invalid file format: first line must be #wire-schema <version>",0),t;if(1!==parseInt(o[0].split(" ")[1]))return n("Invalid file format: only version 1 is supported",0),t;function s(e){let t,o=[],n=/\s*(?:([\w]+):)?(\[[^\]]+\]|\{.*\}|[^\[\]: ]+)/g;for(;t=n.exec(e);){let e=t[2].trim();e.startsWith("[")&&e.endsWith("]")&&(e=e.substring(1,e.length-1)),o.push({text:t[0].trim(),label:t[1],value:e})}return o}let a=[],d=[];for(let e=0;e<o.length;e++){let t=o[e].trim();if(!t||t.startsWith("#"))continue;let l=s(t);if("C"===l[0].text){if(l.length<3){n("Invalid component line: must have at least 3 parts",e);continue}let t=l[1].text,o=l[2].text,r={id:t,name:t,pos:new i.AO(0,0),size:new i.AO(0,0),defId:o,ports:[],args:null,resolved:!1,hasSubSchematic:!1};for(let t=3;t<l.length;t++){let o=l[t];if("p"===o.label){let t=o.value.split(",");if(2!==t.length){n("Invalid component line: p: must have 2 parts",e);continue}let s=parseFloat(t[0]),l=parseFloat(t[1]);if(isNaN(s)||isNaN(l)){n("Invalid component line: p: must have 2 numbers",e);continue}r.pos=new i.AO(s,l)}else if("c"===o.label)r.args=JSON.parse(o.value);else{n("Invalid component line: unknown part [".concat(o.label,"] [").concat(o.value,"]"),e);continue}}a.push(r)}else if("W"===l[0].text){if(l.length<3){n("Invalid wire line: must have at least 3 space-separated parts",e);continue}let t=l[1].text,o=[];for(let t of l)if("ns"===t.label)for(let l of t.value.split("|")){let t,a=s(l),d=a[0].text.split(",");if(d.length<2){n("Invalid wire node: must have at least 2 parts",e);continue}let c=parseFloat(d[0]),u=parseFloat(d[1]);if(isNaN(c)||isNaN(u)){n("Invalid wire node: must have 2 numbers",e);continue}let p=[];for(let t=2;t<d.length;t++){let o=parseInt(d[t]);if(isNaN(o)){n("Invalid wire node: edge must be a number",e);continue}p.push(o)}for(let o of a)if("p"===o.label){let i=o.value.split("/");if(2!==i.length){n("Invalid wire node: c: must have 2 parts",e);continue}let s=i[0],l=i[1];t={type:r.ru.CompNode,id:s,compNodeId:l}}o.push({id:o.length,pos:new i.AO(c,u),edges:p,ref:t})}for(let e of o)for(let t of e.edges)e.id>t&&o[t].edges.push(e.id);d.push({id:t,nodes:o})}else{n("Unexpected line start letter: '".concat(t[0],"'"),e);continue}}let c={comps:a,wires:d,compBbox:new i.bR},u=l(c);return u.replaceAll(/\r/g,"")!==e.replaceAll(/\r/g,"")&&(n("Exported data does not match imported data",0),console.log("--- str:\n",e),console.log("--- outStr:\n",u)),null!==t.issues&&console.log(t.issues),t.issues||(t.schematic=c),t}function d(e,t,o){let r=0,l=t.wires.map(e=>({id:""+r++,nodes:e.nodes.map(e=>({id:e.id,pos:new i.AO(e.x,e.y),edges:e.edges,ref:e.ref}))})),a=0;for(let e of l)a=Math.max(a,parseInt(e.id));(0,s.C9)(l,"wiresFromLsState");let d=new Map;for(let e of t.comps)d.set(e.id,e);let c=t.comps.map(e=>{let t=o.create(e.defId,e.args);return t.id=e.id,t.pos=new i.AO(e.x,e.y),t.subSchematicId=e.subSchematicId,t}),u=0;for(let e of c)u=Math.max(u,parseInt(e.id));return(0,n.v4)(e,{mainSchematic:(0,n.v4)(e.mainSchematic,{nextWireId:a+1,nextCompId:u+1,parentCompDefId:t.parentCompDefId,wires:l,comps:c})})}function c(e){return{wires:e.wires.filter(e=>e.nodes.length>0).map(e=>({nodes:e.nodes.map(e=>({id:e.id,x:e.pos.x,y:e.pos.y,edges:e.edges,ref:e.ref}))})),comps:e.comps.map(e=>({id:e.id,defId:e.defId,x:e.pos.x,y:e.pos.y,args:e.args,subSchematicId:e.subSchematicId}))}}},8450:function(e,t,o){"use strict";o.d(t,{c4:function(){return c},ip:function(){return a},pf:function(){return l},ry:function(){return d}});var n=o(2343),i=o(9158),r=o(8022),s=o(1528);function l(e,t){let o=new i.bR;for(let n of e.mainSchematic.comps)null!=t&&t.excludePorts&&n.defId===r.rS||(o.addInPlace(n.pos),o.addInPlace(n.pos.add(n.size)));for(let t of e.mainSchematic.wires)for(let e of t.nodes)o.addInPlace(e.pos);return!e.mainSchematic.compBbox||(null==t?void 0:t.excludePorts)||o.combineInPlace(e.mainSchematic.compBbox),o}function a(e,t,o){let r=new i.bR(e.min,e.max);r.expandInPlace(e.size().mul(o).len());let s=r.size(),l=t.size();return n.t.multiply(n.t.translateVec(t.center()),n.t.scale1(Math.min(l.x/s.x,l.y/s.y)),n.t.translateVec(r.center().mul(-1)))}function d(e){return null!=e||(e=(0,s.y7)()),{snapshot:c(),snapshotTemp:null,mtx:n.t.multiply(n.t.scale1(10),n.t.translateVec(new i.AO(960,540).round())),sharedContext:e,compLibrary:e.compLibrary,schematicLibrary:e.schematicLibrary,codeLibrary:e.codeLibrary,desiredSchematicId:null,activeSchematicId:null,redoStack:[],undoStack:[],hovered:null,maskHover:null,selectRegion:null,addLine:!1,showExeOrder:!1,transparentComps:!1,compLibraryVisible:!1,needsZoomExtent:!0}}function c(){return{focusedIdPrefix:"",selected:[],mainSchematic:{id:"",name:"",nextWireId:0,nextCompId:0,wires:[],comps:[],compPorts:[],compSize:new i.AO(0,0),compBbox:new i.bR},subSchematics:{}}}},1325:function(e,t,o){"use strict";var n,i,r,s,l,a,d,c,u,p,m,f,h,x;o.d(t,{FC:function(){return l},HO:function(){return r},MN:function(){return s},gZ:function(){return n},yi:function(){return i}}),(c=n||(n={}))[c.OPIMM=19]="OPIMM",c[c.OP=51]="OP",c[c.BRANCH=99]="BRANCH",c[c.LUI=55]="LUI",c[c.AUIPC=23]="AUIPC",c[c.JAL=111]="JAL",c[c.JALR=103]="JALR",c[c.SYSTEM=115]="SYSTEM",c[c.LOAD=3]="LOAD",c[c.STORE=35]="STORE",c[c.FENCE=15]="FENCE",(u=i||(i={}))[u.ADDI=0]="ADDI",u[u.SLTI=2]="SLTI",u[u.SLTIU=3]="SLTIU",u[u.XORI=4]="XORI",u[u.ORI=6]="ORI",u[u.ANDI=7]="ANDI",u[u.SLLI=1]="SLLI",u[u.SRLI=5]="SRLI",u[u.SRAI=5]="SRAI",u[u.SUB=0]="SUB",u[u.ADD=0]="ADD",u[u.SLL=1]="SLL",u[u.SLT=2]="SLT",u[u.SLTU=3]="SLTU",u[u.XOR=4]="XOR",u[u.SRL=5]="SRL",u[u.SRx=5]="SRx",u[u.OR=6]="OR",u[u.AND=7]="AND",(p=r||(r={}))[p.ADDI=0]="ADDI",p[p.SLTI=2]="SLTI",p[p.SLTIU=3]="SLTIU",p[p.XORI=4]="XORI",p[p.ORI=6]="ORI",p[p.ANDI=7]="ANDI",p[p.SLLI=1]="SLLI",p[p.SRxI=5]="SRxI",(m=s||(s={}))[m.BEQ=0]="BEQ",m[m.BNE=1]="BNE",m[m.BLT=4]="BLT",m[m.BGE=5]="BGE",m[m.BLTU=6]="BLTU",m[m.BGEU=7]="BGEU",(f=l||(l={}))[f.LB=0]="LB",f[f.LH=1]="LH",f[f.LW=2]="LW",f[f.LBU=4]="LBU",f[f.LHU=5]="LHU",f[f.SB=0]="SB",f[f.SH=1]="SH",f[f.SW=2]="SW",(h=a||(a={}))[h.CSRRW=1]="CSRRW",h[h.CSRRS=2]="CSRRS",h[h.CSRRC=3]="CSRRC",h[h.CSRRWI=5]="CSRRWI",h[h.CSRRSI=6]="CSRRSI",h[h.CSRRCI=7]="CSRRCI",(x=d||(d={}))[x.mstatus=768]="mstatus",x[x.misa=769]="misa",x[x.mdeleg=770]="mdeleg",x[x.mideleg=771]="mideleg",x[x.mie=772]="mie",x[x.mtvec=773]="mtvec",x[x.mcounteren=774]="mcounteren",x[x.mstatush=784]="mstatush",x[x.mscratch=832]="mscratch",x[x.mepc=833]="mepc",x[x.mcause=834]="mcause",x[x.mtval=835]="mtval",x[x.mip=836]="mip",x[x.mtinst=842]="mtinst",x[x.mtval2=843]="mtval2"},527:function(e,t,o){"use strict";o.d(t,{C8:function(){return a},N_:function(){return u},TM:function(){return s},UB:function(){return l},c5:function(){return c},f1:function(){return h},hz:function(){return d},kn:function(){return f},sH:function(){return m},yM:function(){return p}});var n=o(2343),i=o(9158),r=o(9107);function s(e){let t=e.id.lastIndexOf("|");return{idPrefix:t>=0?e.id.substring(0,t+1):""}}function l(e){let t=e.id.lastIndexOf("|");return(0,r.v4)(e,{id:e.id.substring(t+1)})}function a(e,t){var o;let i=e.idPrefix.split("|"),r=(null!==(o=t.snapshotTemp)&&void 0!==o?o:t.snapshot).mainSchematic,s=t.mtx;for(let e=0;e<i.length-1;e++){let o=i[e],l=r.comps.find(e=>e.id===o);if(!l)break;let a=u(t,l);if(!a)break;let c=d(l,a);s=n.t.multiply(s,c),r=a}return s}function d(e,t){var o,r;let s=null!==(r=null===(o=t.compBbox)||void 0===o?void 0:o.clone())&&void 0!==r?r:new i.bR;if(s.empty){for(let e of t.comps)s.addInPlace(e.pos),s.addInPlace(e.pos.add(e.size));s.expandInPlace(.1*Math.min(s.size().x,s.size().y))}s.empty&&(s=new i.bR(new i.AO,e.size.mul(2.5)));let l=s.size(),a=Math.min(e.size.x/l.x,e.size.y/l.y);return n.t.multiply(n.t.translateVec(e.pos.mulAdd(e.size,.5)),n.t.scale1(a),n.t.translateVec(s.min.mul(-1).mulAdd(l,-.5)))}function c(e){var t,o;let n=null!==(t=e.snapshotTemp)&&void 0!==t?t:e.snapshot,i=null!==(o=n.focusedIdPrefix)&&void 0!==o?o:"",r=f(e.sharedContext,n,i);return r?[i,r]:["",n.mainSchematic]}function u(e,t){var o;if(!t.hasSubSchematic&&!t.subSchematicId)return null;let n=null!==(o=e.snapshotTemp)&&void 0!==o?o:e.snapshot;return m(e.sharedContext,n,t)}function p(e,t){let o=s(t),n=l(t),i=f(e.sharedContext,e.snapshot,o.idPrefix);return[n,null!=i?i:e.snapshot.mainSchematic]}function m(e,t,o){var n,i,r,s;if(!o.hasSubSchematic&&!o.subSchematicId)return null;if(o.subSchematicId){let n=t.subSchematics[o.subSchematicId];if(n)return n;let r=e.schematicLibrary.getSchematic(o.subSchematicId);return null!==(i=null==r?void 0:r.model.mainSchematic)&&void 0!==i?i:null}let l=e.compLibrary.getCompDef(o.defId);return t.subSchematics[null!==(r=o.defId)&&void 0!==r?r:""]||(null!==(s=null==l?void 0:null===(n=l.subLayout)||void 0===n?void 0:n.layout)&&void 0!==s?s:null)}function f(e,t,o){let n=o.split("|"),i=t.mainSchematic;for(let o=0;o<n.length-1;o++){let r=n[o],s=i.comps.find(e=>e.id===r);if(!s)return null;let l=m(e,t,s);if(!l)return null;i=l}return i}function h(e,t){var o,n;let i=t.split("|"),r=(null!==(o=e.snapshotTemp)&&void 0!==o?o:e.snapshot).mainSchematic;for(let t=0;t<i.length-1;t++){let o=i[t],n=r.comps.find(e=>e.id===o);if(!n)return null;let s=u(e,n);if(!s)return null;r=s}let s=i[i.length-1];return null!==(n=r.comps.find(e=>e.id===s))&&void 0!==n?n:null}},7104:function(e,t,o){"use strict";o.d(t,{AW:function(){return p},C9:function(){return m},Ib:function(){return b},Jp:function(){return x},M5:function(){return l},Tb:function(){return h},U0:function(){return g},Vn:function(){return S},dE:function(){return a},kV:function(){return I},qs:function(){return u},sH:function(){return d},uT:function(){return y},x0:function(){return f}});var n=o(9107),i=o(9158),r=o(4603),s=o(2442);function l(e,t,o){if(o.dist(i.AO.zero)<b)return e;m(e.wires,"moveSelectedComponents (pre)");let s=new Map;for(let t of e.wires)s.set(t.id,t);let l=new Map,a=new Set(t.map(d)),u=new Set,p=new Map;for(let t of e.comps){var f;if(a.has(d({type:r.ru.Comp,id:t.id})))for(let e of null!==(f=t.ports)&&void 0!==f?f:[]){let o=t.pos.add(e.pos),n={type:r.ru.CompNode,id:t.id,compNodeId:e.id};l.set(d(n),{pos:o,ref:n})}}for(let e of t)e.type===r.ru.Comp&&u.add(e.id);for(let n of e.wires){let e=new Map;for(let t of n.nodes){let i=d({type:r.ru.WireNode,id:n.id,wireNode0Id:t.id});if(a.has(i)){e.set(t.id,o);continue}if(t.ref){let n=d(t.ref);l.has(n)&&e.set(t.id,o)}}for(let s of t)if(s.type===r.ru.WireSeg&&s.id===n.id){let t=n.nodes[s.wireNode0Id],r=n.nodes[s.wireNode1Id],l=r.pos.sub(t.pos).normalize(),a=new i.AO(-l.y,l.x,0),d=(0,i.n3)(o,a);e.has(t.id)||e.set(t.id,d),e.has(r.id)||e.set(r.id,d)}p.set(n.id,e)}return(0,n.v4)(e,{comps:e.comps.map(e=>u.has(e.id)?(0,n.v4)(e,{pos:N(e.pos.add(o))}):e),wires:e.wires.map(e=>{let t=p.get(e.id);return t&&(e=c(e,t)),e})})}function a(e,t,o){return o===s.uT.Move?(0,n.v4)(e,{wires:e.wires.map(e=>{let o=new Map,n=new Set;for(let i of e.nodes){if(!i.ref||i.ref.type!==r.ru.CompNode||i.ref.id!==t.id)continue;let e=t.ports.find(e=>e.id===i.ref.compNodeId);if(!e){n.add(i.id);continue}let s=t.pos.add(e.pos).sub(i.pos);o.set(i.id,s)}if(n.size>0)for(let t of(e=f(e),n))e.nodes[t].ref=void 0;return o.size>0&&(e=c(e,o)),e})}):e}function d(e){switch(e.type){case r.ru.Comp:return"C|".concat(e.id);case r.ru.CompNode:return"CP|".concat(e.id,"|").concat(e.compNodeId);case r.ru.WireNode:return"WN|".concat(e.id,"|").concat(e.wireNode0Id);case r.ru.WireSeg:return"W|".concat(e.id,"|").concat(e.wireNode0Id,"|").concat(e.wireNode1Id)}}function c(e,t){e=f(e);let o=new Set(t.keys());function s(t){var n;return(null===(n=e.nodes[t].ref)||void 0===n?void 0:n.type)===r.ru.CompNode&&!o.has(t)}for(let[o,n]of t){if(n.len()<b)continue;let r=e.nodes[o];for(let o of[...r.edges]){let l=e.nodes[o],a=l.pos.sub(r.pos).normalize(),d=new i.AO(-a.y,a.x,0);if(d.len()<b)continue;let c=(0,i.n3)(n,d),u=new Map,p=!1;if(function(e,t,o,n){let i=new Set,r=[t];for(;r.length>0;){let t=r.pop(),s=e.nodes[t];if(!i.has(s.id))for(let t of(i.add(s.id),n(s),s.edges))Math.abs(e.nodes[t].pos.sub(s.pos).normalize().dot(o))>1-b&&r.push(t)}}(e,o,a,e=>{let o=t.get(e.id);s(e.id)&&(p=!0),o?Math.abs(o.dot(c))<b&&u.set(e.id,o.add(c)):u.set(e.id,c)}),p){if(!s(o)){let t={id:e.nodes.length,pos:N(l.pos.add(c)),edges:[]};I(r,l),w(r,t),w(t,l),e.nodes.push(t)}}else for(let e of u)t.set(e[0],e[1])}}for(let[o,i]of t)e.nodes[o]=(0,n.v4)(e.nodes[o],{pos:N(e.nodes[o].pos.add(i))});return e}function u(e,t,o,i){let r=e.nodes[t],s=e.nodes[o].pos.sub(r.pos).normalize(),l=new Set,a=[t,o],d=new Set,c=[...e.nodes];for(;a.length>0;){let t=a.pop(),o=e.nodes[t];if(!d.has(o.id))for(let n of(d.add(o.id),l.add(t),o.edges))Math.abs(e.nodes[n].pos.sub(o.pos).normalize().dot(s))>1-b&&a.push(n)}for(let e of l)c[e]=(0,n.v4)(c[e],{pos:N(c[e].pos.add(i))});return(0,n.v4)(e,{nodes:c})}function p(e,t,o){let[i,s]=function(e,t,o){let n=(t=[...t])[o],i=new Set;m(t,"fixWires (pre-merge)");for(let e=0;e<t.length;e++){if(e===o)continue;let r=t[e],s=!1;h(r,(t,o)=>{let r={p0:t.pos,p1:o.pos};return h(n,(t,o)=>{var n;if(C(r,(n={p0:t.pos,p1:o.pos}).p0)||C(r,n.p1)||C(n,r.p0)||C(n,r.p1))return s=!0,i.add(e),!1}),!s})}if(i.size>0){let e=v(n);for(let o of i)for(let n of v(t[o]).segments)e.segments.push(n);t[o]=y(e);let r=Array.from(i).filter(e=>e<o).length;t=t.filter((e,t)=>!i.has(t)),o-=r}m(t,"fixWires (pre-fixWire)"),t[o]=S(t[o]);let s=t[o],l=function(e){let t=new Map;for(let o of e.comps)for(let e of o.ports){let n=o.pos.add(e.pos),i={type:r.ru.CompNode,id:o.id,compNodeId:e.id},s="".concat(n.x,",").concat(n.y);t.set(s,{pos:n,ref:i})}return t}(e);for(let e of s.nodes){let t="".concat(e.pos.x,",").concat(e.pos.y),o=l.get(t);o&&(e.ref=o.ref)}m(t,"fixWires (pre-splitIntoIslands)");let a=x(s);t.splice(o,1,a[0]),t=t.filter(e=>!!e);let d=a.slice(1);return m(t,"fixWires (post-splitIntoIslands)"),m(d,"fixWires (post-splitIntoIslands new)"),[t,d]}(e,t,o),l=e.nextWireId;for(let e of s)e.id=""+l++;let a=[...i,...s];return m(i,"applyWires (post-fixWires edited)"),m(s,"applyWires (post-fixWires new)"),(0,n.v4)(e,{nextWireId:l,wires:a})}function m(e,t){for(let o of e){if(o.nodes.some(e=>e.edges.some(e=>(0,n.kK)(e)||(0,n.kK)(o.nodes[e]))))throw console.log("wire:",o),Error("CHECK [".concat(t,"]: Wire ").concat(o.id," has dangling edges"));for(let e of o.nodes)for(let n of e.edges){let i=o.nodes[n];i.edges.includes(e.id)||(i.edges.push(e.id),console.log("CHECK [".concat(t,"]: Wire ").concat(o.id," has unidirectional edge ").concat(e.id," -> ").concat(i.id)))}}}function f(e){let t=e.nodes.map(e=>({...e,edges:e.edges.slice()}));return{...e,nodes:t}}function h(e,t){for(let o of e.nodes)for(let n of o.edges){let i=e.nodes[n];if(!i)throw Error("Couldn't find node ".concat(n));if(i.id>o.id&&!1===t(o,i))return}}function x(e){let t=[],o=new Set;for(let n=0;n<e.nodes.length;n++){let i=e.nodes[n];if(!o.has(i.id)){let n=[i],r=[];for(;n.length>0;){let t=n.pop();if(!o.has(t.id))for(let i of(r.push(t),o.add(t.id),t.edges))n.push(e.nodes[i])}r.length>1&&t.push(r)}}return 1===t.length?[e]:t.map(t=>g((0,n.v4)(e,{nodes:t})))}function g(e){let t=0,o=new Map,i=[];for(let r of e.nodes){if(0===r.edges.length)continue;let e=t++;o.set(r.id,e),i.push((0,n.v4)(r,{id:e}))}for(let e of i)e.edges=e.edges.map(e=>o.get(e));return(0,n.v4)(e,{nodes:i})}function y(e){let t=new Map;function o(e,o){let i="".concat(e.x.toFixed(5),",").concat(e.y.toFixed(5)),r=(0,n.Dw)(t,i,()=>({id:t.size,pos:e,edges:[]}));return r.ref=r.ref||o,r}for(let t of e.segments){let n=[{t:0,node:o(t.p0,t.comp0Ref)},{t:1,node:o(t.p1,t.comp1Ref)}];for(let r of e.segments)if(t!==r)for(let e of[r.p0,r.p1])(function(e,t){if(!C(e,t))return!1;let o=(0,i.AP)(e.p0,e.p1,t);return o>b&&o<1-b})(t,e)&&n.push({t:(0,i.AP)(t.p0,t.p1,e),node:o(e)});n.sort((e,t)=>e.t-t.t);for(let e=0;e<n.length-1;e++){let t=n[e],o=n[e+1];t.node!==o.node&&(t.node.edges.push(o.node.id),o.node.edges.push(t.node.id))}}return{id:e.id,nodes:Array.from(t.values())}}function v(e){let t=[];for(let o of e.nodes)for(let n of o.edges){let i=e.nodes[n];i.id>o.id&&t.push({p0:o.pos,p1:i.pos,comp0Ref:o.ref,comp1Ref:i.ref})}return{id:e.id,segments:t}}let b=.001;function S(e){m([e],"fixWire (pre-segment split)");let t=v(e),o=t.segments.map(e=>({...e})),i=new Set;for(let e=0;e<t.segments.length;e++){let n=o[e];for(let r=0;r<t.segments.length;r++){let t=o[r];if(n!==t){if(n.p0.dist(t.p0)<b&&n.p1.dist(t.p1)<b||n.p0.dist(t.p1)<b&&n.p1.dist(t.p0)<b){r>e&&i.add(r);continue}C(n,t.p0)&&(C(n,t.p1)?i.add(r):C(t,n.p0)?t.p0=n.p0:C(t,n.p1)&&(t.p0=n.p1))}}}let r=o.filter((e,t)=>!i.has(t)).filter(e=>e.p0.distSq(e.p1)>b*b),s=y(t=(0,n.v4)(t,{segments:r}));h(s,(e,t)=>{for(let o of s.nodes)o!==e&&o!==t&&C({p0:e.pos,p1:t.pos},o.pos)&&(I(e,t),w(e,o),w(o,t))});let l=!1;for(let e of s.nodes){if(2!==e.edges.length)continue;let t=s.nodes[e.edges[0]],o=s.nodes[e.edges[1]],n=t.pos.sub(e.pos).normalize(),i=o.pos.sub(e.pos).normalize();n.dot(i)<-1+b&&(I(t,e),I(o,e),w(t,o),l=!0)}return l&&(s=g(s)),s}function w(e,t){e.edges.includes(t.id)||e.edges.push(t.id),t.edges.includes(e.id)||t.edges.push(e.id)}function I(e,t){e.edges=e.edges.filter(e=>e!==t.id),t.edges=t.edges.filter(t=>t!==e.id)}function C(e,t){return(0,i.s4)(e.p0,e.p1,t).distSq(t)<b*b}function N(e){return e.round()}},8756:function(e,t,o){"use strict";o.d(t,{_c:function(){return a}});var n,i,r=o(9107),s=o(9158),l=o(4603);(n=i||(i={}))[n.Builtin=0]="Builtin",n[n.UserDefined=1]="UserDefined";class a{addComp(e){let t={id:e.defId,altIds:e.altDefIds,name:e.name,compDef:e};this.addLibraryItem(t)}addLibraryItem(e){var t;for(let o of(this.libraryLookup.set(e.id,e),null!==(t=e.altIds)&&void 0!==t?t:[]))this.libraryLookup.set(o,e)}getCompDef(e){let t=this.libraryLookup.get(e);return t&&t.compDef?t.compDef:null}create(e,t){var o;let n=this.getCompDef(e);if(!n)return{id:"",defId:e,name:"<unknown>",args:t,ports:[],pos:new s.AO(0,0),size:new s.AO(4,4),resolved:!1,hasSubSchematic:!1};let i=n.initConfig?n.initConfig({}):null;i&&t&&(i=(0,r.v4)(i,t));let l={id:"",defId:n.defId,name:n.name,ports:n.ports instanceof Function?n.ports(i,n):n.ports,pos:new s.AO(0,0),size:n.size,args:i,resolved:!0,hasSubSchematic:!!n.subLayout};return null===(o=n.applyConfig)||void 0===o||o.call(n,l,l.args),l}updateCompFromDef(e){var t,o;let n=this.getCompDef(e.defId);n&&(null!==(o=e.name)&&void 0!==o||(e.name=n.name),e.ports=n.ports instanceof Function?n.ports(e.args,n):n.ports,e.size=n.size,e.hasSubSchematic=!!n.subLayout,null===(t=n.applyConfig)||void 0===t||t.call(n,e,e.args))}updateAllCompsFromDefs(e){for(let t of e)this.updateCompFromDef(t);return e}build(e){let t=this.getCompDef(e.defId);if(null==t?void 0:t.build){let o=new d(e);return t.build(o)}return function(e){let t=new d(e);t.valid=!1;let o=t.ports.filter(e=>(0,r.yE)(e.type,l.bS.In)),n=t.ports.filter(e=>(0,r.yE)(e.type,l.bS.Out));for(let e of[...o,...n])e.ioEnabled=!1;return t.addPhase(c,o,n),t.build({})}(e)}constructor(){this.libraryLookup=new Map}}class d{getPort(e){let t=this.portNameToIdx.get(e);if((0,r.kK)(t)){let t="Valid ports are ["+Array.from(this.portNameToIdx.keys()).join(", ")+"]";throw Error("Port ".concat(e," not found on component ").concat(this.comp.name," (").concat(this.comp.id,"). ")+t)}return this.ports[t]}createExternalPort(e,t,o){let n=this.ports.length;this.portNameToIdx.set(e,n);let i={portIdx:n,netIdx:-1,dataUsed:!0,ioEnabled:!0,ioDir:l.H.None,type:t,value:0,width:o};return this.ports.push(i),i}addData(e){return this.data=e,e}addLatchedPhase(e,t,o){return this.addPhase(e,t,o,!0)}addPhase(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.seenLatch)throw Error("Cannot add phase after latch phase");return n&&(this.seenLatch=!0),this.phases.push({readPortIdxs:t.map(e=>e.portIdx),writePortIdxs:o.map(e=>e.portIdx),func:e,isLatch:n}),this}build(e){var t;return{comp:this.comp,data:null!==(t=this.data)&&void 0!==t?t:e,phases:this.phases,ports:this.ports,compFullId:this.comp.id,idx:-1}}constructor(e){this.comp=e,this.ports=[],this.portNameToIdx=new Map,this.phases=[],this.seenLatch=!1,this.valid=!0,this.data=null,this.ports=e.ports.map((e,t)=>{var o,n;return{portIdx:t,netIdx:-1,ioEnabled:!0,ioDir:l.H.None,dataUsed:!0,type:null!==(o=e.type)&&void 0!==o?o:l.bS.In,value:0,width:null!==(n=e.width)&&void 0!==n?n:1}});for(let t=0;t<e.ports.length;t++)this.portNameToIdx.set(e.ports[t].id,t)}}function c(e){}},8022:function(e,t,o){"use strict";o.d(t,{N0:function(){return i},Yq:function(){return C},hT:function(){return w},qU:function(){return j},rS:function(){return I},t2:function(){return A}});var n,i,r=o(7437),s=o(2265),l=o(9107),a=o(9158),d=o(4603),c=o(3845),u=o(2442),p=o(6863),m=o(6425),f=o(1279),h=o(2759),x=o(7042),g=o(6554),y=o(2452),v=o(3589),b=o(1969),S=o(6608);function w(e,t,o){let n=Math.floor(t/2),r=Math.floor(o/2);switch(e){case i.Right:return new a.AO(t,r);case i.Bottom:return new a.AO(n,o);case i.Left:return new a.AO(0,r);case i.Top:return new a.AO(n,0);default:return new a.AO(t,r)}}(n=i||(i={}))[n.Right=0]="Right",n[n.Bottom=1]="Bottom",n[n.Left=2]="Left",n[n.Top=3]="Top";let I="core/comp/port";function C(e){return[{defId:"comp/port",name:"Port",size:new a.AO(6,6),ports:(e,t)=>{var o;let n;let i=(n=(o=e.type)&~(d.bS.In|d.bS.Out),(0,l.yE)(o,d.bS.In)&&(n|=d.bS.Out),(0,l.yE)(o,d.bS.Out)&&(n|=d.bS.In),n);return[{id:"a",name:"",pos:w(e.portPos,e.w,e.h),type:i,width:e.bitWidth}]},initConfig:()=>({portId:"",name:"",w:6,h:6,type:d.bS.Out,portPos:i.Right,bitWidth:1,signed:!1,valueMode:p.YM.Dec,inputOverride:!1,inputValueOverride:0}),applyConfig(e,t){e.size=new a.AO(t.w,t.h)},build:e=>{let t=e.comp.args,o=(0,l.yE)(t.type,d.bS.In),n=e.addData({port:e.getPort("a"),externalPort:e.createExternalPort("_b",t.type,t.bitWidth),externalPortBound:!1,value:o&&t.inputOverride?t.inputValueOverride:0});return o?e.addPhase(e=>{let{data:t}=e;t.externalPortBound&&(t.value=t.externalPort.value),t.port.value=t.value,t.port.ioEnabled=!0},[n.externalPort],[n.port]):e.addPhase(e=>{let{data:t}=e;t.value=t.port.value,t.externalPortBound&&(t.externalPort.value=t.value),t.port.ioEnabled=!0},[n.port],[n.externalPort]),e.build()},renderAll:!0,render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e;o.save();let r=(0,l.yE)(t.args.type,d.bS.In);o.fillStyle=r?v.D.portInputBg:v.D.portOutputBg,o.beginPath();let s=t.pos,a=t.size;o.roundRect(s.x,s.y,a.x,a.y,a.y/2),o.closePath(),o.fill(),o.stroke();let c=Math.min(n.scale,1/15);o.fillStyle="black",o.font=(0,S.We)(14*c),o.textAlign="center",o.textBaseline="top",o.fillText(t.args.name,s.x+a.x/2,s.y+a.y+.3),o.restore()},renderDom:e=>{let{comp:t,exeComp:o,ctx:n,styles:i,isActive:s,editCtx:l}=e;return(0,r.jsx)(P,{editCtx:l,comp:t,exeComp:o,isActive:s})}}]}function N(e,t,o,n){return(i,r)=>{e((0,u.QQ)(t,i,o,e=>(0,l.v4)(e,n(r,e))))}}let P=(0,s.memo)(function(e){var t,o,n,i;let{editCtx:s,comp:a,exeComp:m,isActive:f}=e,{setEditorState:h}=(0,u._i)(),x=N(h,s,a,e=>({inputOverride:e})),g=N(h,s,a,e=>({bitWidth:e,inputValueOverride:(0,p.qU)(null!==(t=a.args.inputValueOverride)&&void 0!==t?t:0,e,a.args.signed)})),v=N(h,s,a,e=>({signed:e,inputValueOverride:(0,p.qU)(null!==(o=a.args.inputValueOverride)&&void 0!==o?o:0,a.args.bitWidth,e)})),b=N(h,s,a,(e,t)=>{let o=t.type;return e?(o|=d.bS.In,o&=~d.bS.Out):(o|=d.bS.Out,o&=~d.bS.In),{type:o}});function S(e,t,o){h((0,u.QQ)(s,e,a,e=>(0,l.v4)(e,{inputValueOverride:(0,p.qU)(t,e.bitWidth,e.signed),valueMode:o})))}let w=(0,l.yE)(a.args.type,d.bS.In),I=a.args.inputOverride,C=null!==(n=null==m?void 0:m.data.externalPortBound)&&void 0!==n&&n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Uy,{comp:a,className:"",hideHover:!0,children:[w&&(0,r.jsx)(p.GN,{className:"absolute inset-0 px-2",inputType:a.args.valueMode,value:C?m.data.value:a.args.inputValueOverride,update:S,minimalBackground:!0,readonly:C,inputClassName:"text-center",maxBits:a.args.bitWidth,padBits:a.args.bitWidth,signed:a.args.signed,hidePrefix:!0}),!w&&(0,r.jsx)(p.GN,{className:"absolute inset-0 px-2",value:null!==(i=null==m?void 0:m.data.value)&&void 0!==i?i:0,minimalBackground:!0,inputClassName:"text-center",update:(e,t,o)=>S(e,a.args.inputValueOverride,o),inputType:a.args.valueMode,padBits:a.args.bitWidth,signed:a.args.signed,readonly:!0,hidePrefix:!0}),(0,r.jsxs)(c.AP,{className:"absolute top-[12px] right-[12px]",children:[(0,r.jsx)(c.jm,{title:"Label",children:(0,r.jsx)(y.E,{value:a.args.name,update:N(h,s,a,e=>({name:e}))})}),(0,r.jsx)(c.jm,{title:"Id",children:(0,r.jsx)(y.E,{className:"font-mono",value:a.args.portId,update:N(h,s,a,e=>({portId:e}))})}),(0,r.jsx)(c.jm,{title:(0,r.jsx)(c.Tc,{title:"Input",value:w,update:b})}),(0,r.jsx)(c.jm,{title:(0,r.jsx)(c.Tc,{title:"Override Value",value:I,update:x}),disabled:!w,children:(0,r.jsx)(p.GN,{inputType:a.args.valueMode,value:a.args.inputValueOverride,update:S,maxBits:a.args.bitWidth,padBits:a.args.bitWidth,signed:a.args.signed})}),(0,r.jsx)(c.jm,{title:"Bit Width",children:(0,r.jsx)(p.GN,{inputType:p.YM.Dec,hidePrefix:!0,value:a.args.bitWidth,update:g})}),(0,r.jsx)(c.jm,{title:(0,r.jsx)(c.Tc,{title:"Signed",value:a.args.signed,update:v})})]})]}),f&&(0,r.jsx)(j,{editCtx:s,comp:a})]})}),j=(0,s.memo)(function(e){let{editCtx:t,comp:o}=e,{editorState:n,setEditorState:i}=(0,u._i)();(0,m.qi)(m.Cf.Element,e=>{(0,m.Kc)(e,"r")&&(i((0,u.QQ)(t,!0,o,e=>(0,l.v4)(e,{portPos:(e.portPos+1)%4}))),e.preventDefault(),e.stopPropagation())});let s=n.mtx.a;function a(e,n,r){i((0,u.R$)(t,e,o,e=>(0,l.v4)(e,{pos:n,args:(0,l.v4)(e.args,{w:r.x,h:r.y}),size:r})))}return(0,r.jsx)("div",{className:"absolute origin-top-left",style:{transform:"translate(".concat(o.pos.x,"px, ").concat(o.pos.y,"px) scale(").concat(1/s,")"),width:o.size.x*s,height:o.size.y*s},children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsx)(A,{gripPos:t,size:o.size,pos:o.pos,onResize:a,centerY:!0},t))})}),A=e=>{let{gripPos:t,pos:o,size:n,onResize:l,centerY:d}=e,{mtx:c}=(0,u.kt)(),[p,m]=s.useState(null);function y(e){return c.mulVec3Inv(new a.AO(e.clientX,e.clientY))}let[v,S]=(0,g.gU)(p,e=>({size:n,pos:o}),(e,o,n)=>{let r=o.data.pos,s=o.data.size,a=y(e).sub(y(o)).round();t===i.Left||t===i.Right?a.y=0:a.x=0,t===i.Left?l(n,r.add(a),s.sub(a)):t===i.Right?l(n,r,s.add(a)):t===i.Top?l(n,r.add(a),s.mulAdd(a,d?-2:-1)):l(n,r.mulAdd(a,d?-1:0),s.mulAdd(a,d?2:1)),e.stopPropagation(),e.preventDefault()}),w=t===i.Left||t===i.Right,I=(0,x.Z)("group absolute pointer-events-auto flex items-center justify-center",w?"cursor-ew-resize my-auto top-0 bottom-0 h-12 w-6":"cursor-ns-resize mx-auto left-0 right-0 h-6 w-12",t===i.Left&&"left-0 -translate-x-1/2",t===i.Right&&"right-0 translate-x-1/2",t===i.Top&&"top-0 -translate-y-1/2",t===i.Bottom&&"bottom-0 translate-y-1/2"),C=(0,x.Z)("bg-blue-200 hover:bg-blue-300 rounded-xs flex items-center justify-center",w?"h-6 w-2":"h-2 w-6");return(0,r.jsxs)("div",{className:I,ref:m,onMouseDown:function(e){S(e),e.preventDefault(),e.stopPropagation()},children:[(0,r.jsx)("div",{className:C,children:(0,r.jsx)(f.G,{icon:w?h.Uwo:h.S6C,className:"text-md text-white group-hover:text-gray-100"})}),v&&(0,r.jsx)(b.z,{className:w?"cursor-ew-resize":"cursor-ns-resize"})]})}},7290:function(e,t,o){"use strict";o.d(t,{Om:function(){return p},Sr:function(){return u},b5:function(){return m},ei:function(){return l},id:function(){return f}});var n=o(9158),i=o(4603),r=o(3845),s=o(6608);function l(e){return[{defId:"riscv/reg32",altDefIds:["reg32Riscv"],name:"RISCV Registers",size:new n.AO(40,66),ports:[{id:"ctrl",name:"Ctrl",pos:new n.AO(4,0),type:i.bS.In|i.bS.Ctrl,width:18},{id:"in",name:"In",pos:new n.AO(0,3),type:i.bS.In,width:32},{id:"outA",name:"A",pos:new n.AO(40,3),type:i.bS.Out,width:32},{id:"outB",name:"B",pos:new n.AO(40,6),type:i.bS.Out,width:32}],build:e=>{let t=e.addData({inCtrlPort:e.getPort("ctrl"),inDataPort:e.getPort("in"),outAPort:e.getPort("outA"),outBPort:e.getPort("outB"),file:new Uint32Array(32),writeEnabled:!1,writeReg:0,writeData:0,readAReg:-1,readBReg:-1});return e.addPhase(a,[t.inCtrlPort],[t.outAPort,t.outBPort]),e.addPhase(d,[t.inCtrlPort,t.inDataPort],[]),e.addLatchedPhase(c,[],[]),e.build(t)},render:x,copyStatefulData:(e,t)=>{t.file.set(e.file)},reset:e=>{e.data.file.fill(0)}},{defId:"flipflop/reg1",altDefIds:["reg1"],name:"Register",size:new n.AO(40,6),ports:[{id:"in",name:"I",pos:new n.AO(0,3),type:i.bS.In,width:32},{id:"out",name:"O",pos:new n.AO(40,3),type:i.bS.Out,width:32}],build:e=>{let t=e.addData({inPort:e.getPort("in"),outPort:e.getPort("out"),value:0});return e.addPhase(e=>{let{data:t}=e;t.outPort.value=t.value},[],[t.outPort]),e.addLatchedPhase(e=>{let{data:t}=e;t.value=t.inPort.value},[t.inPort],[]),e.build(t)},copyStatefulData:(e,t)=>{t.value=e.value},reset:e=>{e.data.value=0},render:h}]}function a(e){let{data:t}=e,{inCtrlPort:o,outAPort:n,outBPort:i,file:r}=t,s=o.value,l=s>>1&31,a=s>>7&31,d=1&s,c=s>>6&1;n.ioEnabled=!!d,i.ioEnabled=!!c,n.value=d?r[l]:0,i.value=c?r[a]:0,t.readAReg=d?l:-1,t.readBReg=c?a:-1}function d(e){let{data:t}=e,o=t.inCtrlPort.value,n=t.inDataPort.value,i=o>>13&31,r=o>>12&1;t.writeEnabled=!!r,t.writeReg=i,t.writeData=n,t.inDataPort.ioEnabled=!!r&&0!==i}function c(e){let{data:t}=e;t.writeEnabled&&0!==t.writeReg&&(t.file[t.writeReg]=t.writeData)}let u=["zero","ra","sp","gp","tp","t0","t1","t2","s0","s1","a0","a1","a2","a3","a4","a5","a6","a7","s2","s3","s4","s5","s6","s7","s8","s9","s10","s11","t3","t4","t5","t6"],p="#ee39",m="#3f39",f="#33f9";function h(e){var t,o;let{ctx:i,comp:l,exeComp:a,styles:d}=e,c=null!==(t=null==a?void 0:a.data.value)&&void 0!==t?t:0,u=new n.AO(l.size.x-2.4,d.lineHeight),p=new n.AO(1.2,l.size.y/2-u.y/2);i.beginPath(),i.rect(l.pos.x+p.x,l.pos.y+p.y,u.x,u.y),i.fillStyle="#fff",i.strokeStyle="#0004",i.fill(),i.stroke(),i.font=(0,s.We)(d.fontSize,s.Ky.Mono),i.textAlign="end",i.textBaseline="middle",i.fillStyle="#000";let m=l.pos.x+p.x+u.x-r.qP.innerPadX,f=l.pos.y+p.y+u.y/2,h=(0,r.Y1)(c);i.fillText(h,m,f),i.textAlign="start",i.fillText("pc",l.pos.x+1.2+r.qP.innerPadX,f);let x=m-i.measureText(h).width-3.5999999999999996;i.textAlign="end";let g=(0,r.Y1)(null!==(o=null==a?void 0:a.data.inPort.value)&&void 0!==o?o:0);i.fillStyle="#44c9",i.fillText(g,x,f)}function x(e){let{ctx:t,comp:o,exeComp:i,styles:l}=e,a=l.lineHeight;t.save(),t.beginPath(),t.rect(o.pos.x,o.pos.y,o.size.x,o.size.y),t.clip();for(let e=0;e<32;e++){var d;let c=null!==(d=null==i?void 0:i.data.file[e])&&void 0!==d?d:0,h=new n.AO(o.size.x,a).sub(new n.AO(2.4)),x=new n.AO(1.2,1+a*e);t.beginPath(),t.rect(o.pos.x+x.x,o.pos.y+x.y,h.x,h.y),t.fillStyle=0===e?"#ddd":"#fff",t.strokeStyle="#0004",t.fill(),t.stroke();let g=(e,n,i)=>{t.beginPath(),t.roundRect(e,o.pos.y+x.y+.2,n-e,h.y-.4,.4),t.fillStyle=i,t.fill()};t.font=(0,s.We)(l.fontSize,s.Ky.Mono),t.textAlign="end",t.textBaseline="middle";let y=o.pos.y+1+a*(e+.5),v=(0,r.Y1)(c),b=t.measureText(v).width,S=o.pos.x+x.x+h.x-r.qP.innerPadX,w=S-b,I=(null==i?void 0:i.data.readAReg)===e,C=(null==i?void 0:i.data.readBReg)===e,N=(w+S)/2;if(I&&g(w,C?N:S,m),C&&g(I?N:w,S,f),t.fillStyle=e>0&&0===c?"#0007":"#000",t.fillText(v,S,y+.1),e>0&&(null==i?void 0:i.data.writeEnabled)&&e===i.data.writeReg){let e=(0,r.Y1)(i.data.writeData),o=t.measureText(e).width,n=S-b-3.5999999999999996;g(n-o-.2,n+.2,p),t.textAlign="end",t.fillStyle="#883f",t.fillText(e,n,y)}t.fillStyle="#000";let P=u[e];t.textAlign="start",t.fillText(P,o.pos.x+x.x+r.qP.innerPadX,y)}t.restore()}},3845:function(e,t,o){"use strict";o.d(t,{AP:function(){return w},MW:function(){return g},Nc:function(){return y},Tc:function(){return S},Uy:function(){return x},Y1:function(){return f},jT:function(){return v},jm:function(){return b},qP:function(){return h}});var n=o(7437),i=o(2265),r=o(2695),s=o(9965),l=o.n(s),a=o(7042),d=o(2442),c=o(9107),u=o(9225),p=o(2759),m=o(1279);function f(e){let t=(0,r.aj)(e),o=(0,r.Vw)(e),n="0x"+t.toString(16).toUpperCase().padStart(8,"0");return o.toString().padStart(2,"0")+"  "+n}let h={innerPadX:.4},x=(0,i.memo)(function(e){let{comp:t,className:o,children:i,hideHover:r}=e,{setEditorState:s}=(0,d._i)();function u(e){r&&s(o=>(0,c.v4)(o,{maskHover:e?t.id:o.maskHover===t.id?null:o.maskHover}))}return(0,n.jsx)("div",{className:(0,a.Z)(l().baseComp,o),style:g(t),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onMouseDown:e=>e.stopPropagation(),onContextMenu:e=>e.stopPropagation(),children:i})});function g(e){return{width:15*e.size.x,height:15*e.size.y,transform:"translate(".concat(e.pos.x,"px, ").concat(e.pos.y,"px) scale(").concat(.06666666666666667,")")}}let y=(0,i.memo)(function(e){let{comp:t,hideHover:o,children:i}=e,r=(0,d.kt)(),{setEditorState:s}=(0,d._i)();function l(e){o&&s(o=>(0,c.v4)(o,{maskHover:e?t.id:o.maskHover===t.id?null:o.maskHover}))}let a=Math.max(r.mtx.a,15);return(0,n.jsx)("div",{className:"absolute origin-top-left",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),style:{transform:"translate(".concat(t.pos.x,"px, ").concat(t.pos.y,"px) scale(").concat(1/a,")"),width:t.size.x*a,height:t.size.y*a},children:i})});function v(e,t,o,n){return(i,r)=>{e((0,d.QQ)(t,i,o,e=>(0,c.v4)(e,n(r,e))))}}let b=e=>{let{title:t,children:o,disabled:i}=e;return(0,n.jsxs)("div",{className:(0,a.Z)("flex flex-col mx-4 my-2",i&&"opacity-50"),children:[(0,n.jsx)("div",{className:"text-sm",children:t}),(0,n.jsx)("div",{className:"",children:o})]})},S=e=>{let{title:t,value:o,update:i}=e;return(0,n.jsxs)("label",{className:"text-sm flex items-center group cursor-pointer",children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2 relative group-hover:drop-shadow",checked:o,onChange:e=>i(!0,e.target.checked)}),t]})},w=e=>{let{className:t,children:o}=e,[r,s]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:(0,a.Z)(l().configMenuBtn,t),ref:s,onClick:()=>c(!0),children:(0,n.jsx)(m.G,{icon:p.b7W})}),d&&(0,n.jsx)(u.GI,{targetEl:r,placement:u.O6.BottomLeft,className:"tex-lg shadow-lg border-gray-700 bg-gray-400 rounded",onClose:()=>c(!1),closeBackdrop:!0,children:o})]})}},2695:function(e,t,o){"use strict";o.d(t,{Az:function(){return s},Ge:function(){return g},Gy:function(){return y},Vw:function(){return f},aj:function(){return h},am:function(){return c},cy:function(){return a}});var n=o(9158),i=o(4603),r=o(1325);function s(e){return[{defId:"riscv/insDecode0",altDefIds:["insDecodeRiscv32_0"],name:"Instruction Decoder",size:new n.AO(40,20),ports:[{id:"ins",name:"Ins",pos:new n.AO(0,1),type:i.bS.In|i.bS.Data,width:32},{id:"loadStoreCtrl",name:"LS",pos:new n.AO(40,1),type:i.bS.Out|i.bS.Ctrl,width:5},{id:"addrOffset",name:"Addr Offset",pos:new n.AO(40,2),type:i.bS.Out|i.bS.Addr,width:32},{id:"rhsImm",name:"RHS Imm",pos:new n.AO(40,6),type:i.bS.Out|i.bS.Data,width:32},{id:"rhsSel",name:"RHS Sel",pos:new n.AO(40,8),type:i.bS.Out|i.bS.Ctrl,width:1},{id:"pcRegMuxCtrl",name:"Mux",pos:new n.AO(1,20),type:i.bS.Out|i.bS.Ctrl,width:1},{id:"regCtrl",name:"Reg",pos:new n.AO(4,20),type:i.bS.Out|i.bS.Ctrl,width:18},{id:"pcAddImm",name:"PC+Imm",pos:new n.AO(7,20),type:i.bS.Out|i.bS.Addr,width:32},{id:"pcBranchCtrl",name:"PC Branch",pos:new n.AO(11,20),type:i.bS.Out|i.bS.Ctrl,width:1},{id:"lhsSel",name:"LHS Sel",pos:new n.AO(15,20),type:i.bS.Out|i.bS.Ctrl,width:1},{id:"aluCtrl",name:"ALU",pos:new n.AO(18,20),type:i.bS.Out|i.bS.Ctrl,width:5}],build:e=>{let t=e.addData({ins:e.getPort("ins"),addrOffset:e.getPort("addrOffset"),rhsImm:e.getPort("rhsImm"),regCtrl:e.getPort("regCtrl"),loadStoreCtrl:e.getPort("loadStoreCtrl"),aluCtrl:e.getPort("aluCtrl"),pcRegMuxCtrl:e.getPort("pcRegMuxCtrl"),pcAddImm:e.getPort("pcAddImm"),lhsSel:e.getPort("lhsSel"),rhsSel:e.getPort("rhsSel"),pcBranchCtrl:e.getPort("pcBranchCtrl")});return e.addPhase(l,[t.ins],[t.addrOffset,t.rhsImm,t.regCtrl,t.loadStoreCtrl,t.aluCtrl,t.pcRegMuxCtrl,t.lhsSel,t.rhsSel,t.pcAddImm]),e.build(t)},render:x}]}function l(e,t){let{data:o}=e,n=o.ins.value>>>0,i=127&n,s=n>>>12&7,l=n>>>7&31,a=n>>>15&31,c=n>>>20&31;if(o.regCtrl.value=0,o.pcRegMuxCtrl.value=1,o.pcAddImm.value=0,o.rhsImm.value=0,o.lhsSel.value=1,o.pcBranchCtrl.value=0,o.aluCtrl.value=0,o.loadStoreCtrl.value=0,o.rhsSel.value=1,0!==n){if(i===r.gZ.OPIMM||i===r.gZ.OP){let e=!1;i===r.gZ.OP?(p(!0,c,1),e=(n>>>30&1)==1):(s===r.yi.SLLI||s===r.yi.SRLI||s===r.yi.SRAI?o.rhsImm.value=c:o.rhsImm.value=d(n>>>20),o.rhsSel.value=0),p(!0,a,0),m(!0,!1,s,e),p(!0,l,2)}else if(i===r.gZ.LUI)o.rhsImm.value=u(n>>>12)<<12,o.rhsSel.value=0,p(!0,0,0),m(!0,!1,r.yi.ADD,!1),p(!0,l,2);else if(i===r.gZ.AUIPC)o.rhsImm.value=u(n>>>12)<<12,o.rhsSel.value=0,o.lhsSel.value=0,m(!0,!1,r.yi.ADD,!1),p(!0,l,2);else if(i===r.gZ.JAL){let e=(n>>>21&1023)<<0|(n>>>20&1)<<10|(n>>>12&255)<<11|(n>>>31&1)<<19;o.lhsSel.value=0,o.rhsImm.value=u(e)<<1,o.rhsSel.value=0,o.pcRegMuxCtrl.value=0,p(!0,l,2),m(!0,!1,r.yi.ADD,!1)}else if(i===r.gZ.JALR){let e=d(n>>>20);p(!0,a,0),o.rhsImm.value=e,o.rhsSel.value=0,o.pcRegMuxCtrl.value=0,p(!0,l,2),m(!0,!1,r.yi.ADD,!1)}else if(i===r.gZ.BRANCH){p(!0,a,0),p(!0,c,1),m(!0,!0,s,!1);let e=(n>>>8&15)<<0|(n>>>25&63)<<4|(n>>>7&1)<<10|(n>>>31&1)<<11;o.pcAddImm.value=d(e)<<1,o.lhsSel.value=1,o.pcBranchCtrl.value=0}else if(i===r.gZ.LOAD){let e=d(n>>>20);f(!0,!0,s),o.addrOffset.value=e,p(!0,a,0),p(!0,0,1),p(!0,l,2),m(!1,!1,r.yi.ADD,!1)}else if(i===r.gZ.STORE){let e=d(n>>>7&31|(n>>>25&127)<<5);f(!0,!1,3&s),o.addrOffset.value=e,p(!0,a,0),p(!0,c,1),p(!0,0,2),m(!1,!1,r.yi.ADD,!1)}else i===r.gZ.SYSTEM?t.halt=!0:0===n||(t.halt=!0);o.lhsSel.value}function p(e,t,n){let i=o.regCtrl.value;i=i&~(63<<6*n)|((e?1:0)|(31&t)<<1)<<6*n,o.regCtrl.value=i}function m(e,t,n,i){o.aluCtrl.value=(e?1:0)<<5|(t?1:0)<<4|n<<1|(i?1:0)<<0}function f(e,t,n){o.loadStoreCtrl.value=(e?1:0)<<0|(t?1:0)<<1|n<<2}}function a(e){return(128&e)!=0?e-256:e}function d(e){return(2048&e)!=0?e-4096:e}function c(e){return(32768&e)!=0?e-65536:e}function u(e){return 524288&e?e-1048576:e}o(7318),o(7290),o(9107),o(6608);let p=new Uint32Array(1),m=new Int32Array(1);function f(e){return m[0]=e,m[0]}function h(e){return p[0]=e,p[0]}function x(e){let{ctx:t,comp:o,exeComp:n,cvs:i,styles:r}=e}r.MN.BEQ,r.MN.BNE,r.MN.BLT,r.MN.BGE,r.MN.BLTU,r.MN.BGEU;let g={[r.MN.BEQ]:"==",[r.MN.BNE]:"!=",[r.MN.BLT]:"<",[r.MN.BGE]:">=",[r.MN.BLTU]:"<",[r.MN.BGEU]:">="},y={[r.yi.ADD]:"+",[r.yi.SLL]:"<<",[r.yi.SLT]:"<",[r.yi.SLTU]:"<",[r.yi.XOR]:"^",[r.yi.SRL]:">>",[r.yi.OR]:"|",[r.yi.AND]:"&"}},8602:function(e,t,o){"use strict";o.d(t,{Jd:function(){return r},n6:function(){return h},yj:function(){return s}});var n,i,r,s,l=o(7437),a=o(9158),d=o(7318),c=o(9107),u=o(2265),p=o(3845),m=o(1279),f=o(2759);function h(e,t,o,n){let i={defId:e,name:t,ports:e=>n.ports,size:n.size,applyConfig:(e,t)=>{e.size=n.size},build:e=>(e.addData({}),e.build()),renderAll:!0,render:e=>{let{comp:t,exeComp:o,ctx:n,cvs:i}=e;n.fillStyle,n.fillStyle="white",n.beginPath(),n.rect(t.pos.x,t.pos.y,t.size.x,t.size.y),n.fill(),n.stroke(),n.save(),function(e,t,o,n){let i=t.max.x-t.min.x,r=t.max.y-t.min.y;for(let l=0;l<4;l++){let u=l%2==0,p=1===l||2===l,m=p?t.max:t.min,f=u?0:p?-o:o,h=u?p?-o:o:0,x=(u?new a.AO(i,0):new a.AO(0,r)).mul(p?-1:1),g=e.createLinearGradient(m.x,m.y,m.x+f,m.y+h);function s(e,t){let o=Math.pow(1-t,2);return d.ZP(e).formatHex()+(0,c.uZ)(255*o>>0,0,255).toString(16).padStart(2,"0")}g.addColorStop(0,s(n,0)),g.addColorStop(.25,s(n,.25)),g.addColorStop(.5,s(n,.5)),g.addColorStop(.75,s(n,.75)),g.addColorStop(1,s(n,1)),e.fillStyle=g,e.beginPath(),u?(e.moveTo(m.x,m.y),e.lineTo(m.x+x.x,m.y+x.y),e.lineTo(m.x+x.x-.95*h,m.y+h),e.lineTo(m.x+.95*h,m.y+h)):(e.moveTo(m.x,m.y),e.lineTo(m.x+x.x,m.y+x.y),e.lineTo(m.x+x.x+f,m.y+x.y-.95*f),e.lineTo(m.x+f,m.y+.95*f)),e.closePath(),e.fill()}}(n,new a.bR(t.pos,t.pos.add(t.size)),20*i.scale,"#06b6d4"),n.lineWidth=1*i.scale,n.beginPath(),n.rect(t.pos.x,t.pos.y,t.size.x,t.size.y),n.strokeStyle="black",n.stroke(),n.restore()},renderDom:e=>{let{comp:t,exeComp:o,isActive:n}=e;return(0,l.jsx)(x,{comp:t,exeComp:o,isActive:n,compDef:i})},subLayout:{layout:o,ports:n.ports,bb:new a.bR}};return{compDef:i,id:e,name:t,schematic:o}}(n=r||(r={}))[n.Top=0]="Top",n[n.Right=1]="Right",n[n.Bottom=2]="Bottom",n[n.Left=3]="Left",(i=s||(s={}))[i.TopLeft=1]="TopLeft",i[i.TopRight=2]="TopRight",i[i.BottomRight=4]="BottomRight",i[i.BottomLeft=8]="BottomLeft",i[i.IsLeft=9]="IsLeft",i[i.IsTop=3]="IsTop";let x=(0,u.memo)(function(e){let{comp:t,exeComp:o,isActive:n,compDef:i}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.Uy,{comp:t}),(0,l.jsx)(p.Nc,{hideHover:!0,comp:t,children:(0,l.jsxs)("div",{className:"absolute top-0 right-0 m-2 bg-white rounded shadow pointer-events-auto flex h-10 overflow-hidden shadow-[rgba(0,0,0,0.2)] opacity-10 hover:opacity-100 transition-opacity",children:[(0,l.jsx)("div",{className:"relative flex items-center px-2",children:i.name}),(0,l.jsxs)("button",{className:"relative px-2 hover:bg-blue-300 min-w-[2.5rem] text-slate-700",children:[(0,l.jsx)(m.G,{icon:f.EdJ}),(0,l.jsx)("div",{className:"absolute -top-1 -right-0 text-red-500 text-2xl",children:"*"})]}),(0,l.jsx)("button",{className:"px-2 hover:bg-blue-300 min-w-[2.5rem] text-slate-700",title:"Branch this instance",children:(0,l.jsx)(m.G,{icon:f.mh3})}),(0,l.jsx)("button",{className:"px-2 hover:bg-blue-300 min-w-[2.5rem] text-slate-700",children:(0,l.jsx)(m.G,{icon:f.Y$T})})]})})]})})},6863:function(e,t,o){"use strict";o.d(t,{GN:function(){return m},YM:function(){return i},qU:function(){return h}});var n,i,r=o(7437),s=o(2759),l=o(1279),a=o(7042),d=o(2265),c=o(449),u=o.n(c),p=o(6425);(n=i||(i={}))[n.Hex=0]="Hex",n[n.Dec=1]="Dec",n[n.Bin=2]="Bin";let m=e=>{let{className:t,value:o,inputType:n,hidePrefix:c,fixedInputType:m,readonly:x,minimalBackground:g,padBits:y,update:v,maxBits:b,signed:S,inputClassName:w}=e,[I,C]=(0,d.useState)(null),[N,P]=(0,d.useState)(f(o,n,y)),j=n===i.Hex?"0x":n===i.Bin?"0b":"";function A(e){return!isNaN(O(e))}function O(e){return n===i.Hex?parseInt(e,16):n===i.Bin?parseInt(e,2):parseInt(e,10)}function D(e){return b?h(e,b,null!=S&&S):e}function T(e,t){let i=e.target.value;i.startsWith(j)&&(i=i.substring(j.length));let r=A(i);if(r){let e=O(i);e!==D(e)&&(i=f(D(e),n,y)),v(t,D(e),n)}t&&!r&&(i=f(o,n,y)),P(i)}(0,d.useLayoutEffect)(()=>{var e;let t=null!==(e=null==I?void 0:I.selectionStart)&&void 0!==e?e:0;P(f(o,n,y)),null==I||I.setSelectionRange(t,t)},[o,n,y,I]);let L=A(N);return(0,r.jsxs)("div",{className:(0,a.Z)(u().hexValueEditor,t),children:[!c&&(0,r.jsxs)("button",{className:u().prefix,onClick:function(){v(!0,o,(n+1)%3)},children:[!m&&(0,r.jsx)(l.G,{icon:s.onQ}),j||"\xa0",!m&&(0,r.jsx)(l.G,{icon:s.gc2})]}),(0,r.jsx)("input",{ref:C,className:(0,a.Z)(u().input,!L&&u().invalid,g&&u().minimal,x&&u().readonly,w),type:"text",value:N,readOnly:x,onChange:e=>T(e,!1),onBlur:e=>T(e,!0),onKeyDown:function(e){e.stopPropagation(),(0,p.vI)(e,"up")&&L&&(v(!0,D(o+1),n),e.preventDefault()),(0,p.vI)(e,"down")&&L&&(v(!0,D(o-1),n),e.preventDefault())},onKeyUp:e=>e.stopPropagation()})]})};function f(e,t,o){return t===i.Hex?e.toString(16).padStart(o?Math.ceil(o/4):1,"0"):t===i.Bin?e.toString(2).padStart(o||1,"0"):e.toString(10)}function h(e,t,o){let n=Math.pow(2,t);return o&&(n=Math.floor(n/2)),e>n-1&&(e=n-1),o&&e<-n&&(e=-n),!o&&e<0&&(e=0),e}},2452:function(e,t,o){"use strict";o.d(t,{E:function(){return r}});var n=o(7437),i=o(7042);o(2265);let r=e=>{let{className:t,value:o,update:r}=e;return(0,n.jsx)("label",{className:(0,i.Z)("flex flex-row",t),children:(0,n.jsx)("input",{type:"text",className:(0,i.Z)("hover:outline-none focus:outline-none px-1 rounded h-8 text-lg w-full bg-inherit"),value:o,onChange:function(e){r(!1,e.target.value)},onBlur:function(e){r(!0,e.target.value)},onKeyDown:e=>e.stopPropagation(),onKeyUp:e=>e.stopPropagation()})})}},6822:function(e,t,o){"use strict";o.d(t,{d:function(){return s},u:function(){return r}});var n=o(2348),i=o(2845);class r{registerSuite(e,t){this.suites.set(e,{title:t,fileName:e,entries:[],loaded:!1})}getSuite(e){return this.ensureSuiteLoaded(e),this.suites.get(e)}ensureSuiteLoaded(e){var t;let o=this.suites.get(e);return!o||o.loaded?null==o?void 0:o.loadPromise:(null!==(t=o.loadPromise)&&void 0!==t||(o.loadPromise=this.loadSuite(o)),o.loadPromise)}async loadSuite(e){let t;{let o=await fetch("/riscv/examples/"+e.fileName);if(!o.ok){let t=await o.text();e.loadError="Load failed: ".concat(o.status," ").concat(o.statusText," body:'").concat(t.slice(0,200),"'"),this.subs.notify();return}t=new Uint8Array(await o.arrayBuffer())}let o=(0,i.X4)(t),n=(0,i.Qf)(t,o).map(e=>{let t=e.name.slice(6)||e.name;return{name:t,elfSection:e,expectFail:t.startsWith("must_fail")}});e.entries=n,e.loaded=!0,this.suites.set(e.fileName,{...e}),this.subs.notify()}constructor(){this.subs=new n.tH,this.suites=new Map,this.registerSuite("add_tests.elf","Test Suite"),this.registerSuite("blinky.elf","Blinky"),this.registerSuite("blinky2.elf","Blinky 2")}}function s(e,t){return(0,n.Pd)(e.subs),e.getSuite(t)}},1528:function(e,t,o){"use strict";o.d(t,{Y0:function(){return R},y7:function(){return B},Qk:function(){return _}});var n,i,r=o(2265),s=o(6822),l=o(652),a=o(7437),d=o(9158),c=o(4603),u=o(2695),p=o(9965),m=o.n(p),f=o(7042),h=o(1325),x=o(3845);function g(e){let{data:{inCtrlPort:t,inAPort:o,inBPort:n,outPort:i,branchPort:r}}=e,s=t.value,l=(0,u.Vw)(o.value),a=(0,u.Vw)(n.value),d=(32&s)!=0,c=(16&s)!=0;if(o.ioEnabled=d,n.ioEnabled=d,i.ioEnabled=d&&!c,r.ioEnabled=!1,r.value=0,d){if(c){let e=s>>1&7,t=!1;switch(6&e){case 0:t=l===a;break;case 4:t=l<a;break;case 6:t=l>>>0<a>>>0}i.value=0,r.value=(t?1:0)^1&e,r.ioEnabled=!0}else{let e=(1&s)!=0,t=0;switch(s>>1&7){case 0:t=e?l-a:l+a;break;case 1:t=l<<a;break;case 2:t=(0,u.Vw)(l)<(0,u.Vw)(a)?1:0;break;case 3:t=(0,u.aj)(l)<(0,u.aj)(a)?1:0;break;case 4:t=l^a;break;case 5:t=e?l>>a:l>>>a;break;case 6:t=l|a;break;case 7:t=l&a}i.value=(0,u.Vw)(t)}}}var y=o(8756),v=o(7290),b=o(6608),S=o(9107);(n=i||(i={}))[n.Byte=0]="Byte",n[n.Half=1]="Half",n[n.Word=2]="Word";var w=o(2343),I=o(2442),C=o(6425);function N(e,t){return w.t.multiply(w.t.translateVec(t),function(e){switch(e){case 0:return new w.t(1,0,0,1,0,0);case 1:return new w.t(0,1,-1,0,0,0);case 2:return new w.t(-1,0,0,-1,0,0);case 3:return new w.t(0,-1,1,0,0,0);default:return new w.t}}(e),w.t.translateVec(t.mul(-1)))}let P=e=>{let{editCtx:t,comp:o,isActive:n}=e,{setEditorState:i}=(0,I._i)();return(0,C.qi)(C.Cf.Element,e=>{(0,C.Kc)(e,"r")&&(i((0,I.QQ)(t,!0,o,e=>(0,S.v4)(e,{rotate:(e.rotate+1)%4}))),e.preventDefault(),e.stopPropagation())},{isActive:n}),(0,a.jsx)("div",{className:"",onClick:function(){let e=(o.args.rotate+1)%4;i((0,I.QQ)(t,!0,o,t=>(0,S.v4)(t,{rotate:e})))}})};var j=o(6863);let A=e=>{let{editCtx:t,comp:o,exeComp:n}=e,{setEditorState:i}=(0,I._i)();return(0,a.jsxs)(x.Uy,{comp:o,className:m().compAddressing,hideHover:!0,children:[(0,a.jsx)(j.GN,{value:o.args.addrOffset,update:function(e,n){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{addrOffset:n})))},inputType:j.YM.Hex,fixedInputType:!0,minimalBackground:!0,padBits:32}),(0,a.jsx)(j.GN,{value:o.args.addrMask,update:function(e,n){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{addrMask:n})))},inputType:j.YM.Hex,fixedInputType:!0,minimalBackground:!0,padBits:32})]})};var O=o(8022);let D=(0,r.memo)(function(e){let{editCtx:t,comp:o,isActive:n}=e,{setEditorState:i}=(0,I._i)(),r=(0,x.jT)(i,t,o,e=>({bitWidth:e})),s=(0,x.jT)(i,t,o,e=>({signed:e,value:(0,j.qU)(o.args.value,o.args.bitWidth,e)}));function l(e,n,r){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{value:n,valueMode:r})))}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Uy,{comp:o,className:m().inputNumber,hideHover:!0,children:(0,a.jsx)(j.GN,{className:"absolute inset-0 px-2",inputType:o.args.valueMode,value:o.args.value,update:l,minimalBackground:!0,readonly:!1,inputClassName:"text-center",maxBits:o.args.bitWidth,signed:o.args.signed,hidePrefix:!0})}),n&&(0,a.jsx)(x.Nc,{comp:o,hideHover:!0,children:(0,a.jsxs)(x.AP,{className:"absolute top-1 right-1 text-2xl",children:[(0,a.jsx)(x.jm,{title:"Value",children:(0,a.jsx)(j.GN,{inputType:o.args.valueMode,value:o.args.value,update:l,maxBits:o.args.bitWidth,padBits:o.args.bitWidth,signed:o.args.signed})}),(0,a.jsx)(x.jm,{title:"Bit Width",children:(0,a.jsx)(j.GN,{inputType:j.YM.Dec,hidePrefix:!0,value:o.args.bitWidth,update:r})}),(0,a.jsx)(x.jm,{title:(0,a.jsx)(x.Tc,{title:"Signed",value:o.args.signed,update:s})})]})}),n&&(0,a.jsx)(O.qU,{editCtx:t,comp:o})]})}),T={regs:[function(e,t,o){return o&&(e.newValue=t),e.value},function(e,t,o){return o&&(e.newValue=e.value|t,e.bitsOn=t),0},function(e,t,o){return o&&(e.newValue=e.value&~t,e.bitsOff=t),0},function(e,t,o){return o&&(e.newValue=e.value^t,e.bitsToggle=t),0}]},L=(0,r.memo)(function(e){let{comp:t,exeComp:o,value:n}=e,i=[];for(let e=0;e<8;e++){let t=(n&1<<e)!=0;i.push(t)}return(0,a.jsxs)(x.Uy,{comp:t,className:m().compLedOutputSimple,hideHover:!0,children:[(0,a.jsx)("div",{children:"0x"+n.toString(16).padStart(8,"0")}),(0,a.jsx)("div",{className:m().ledOutput,children:i.map((e,t)=>(0,a.jsx)("div",{className:(0,f.Z)(m().ledOutputBit,e&&m().enabled)},t))})]})}),k=e=>{let{editCtx:t,comp:o,exeComp:n}=e,{setEditorState:i}=(0,I._i)();return(0,a.jsxs)(x.Uy,{comp:o,className:m().compRegFileCtrl,hideHover:!0,children:[(0,a.jsx)(E,{name:"In",enabled:o.args.inEnable,value:o.args.inReg,setValue:function(e,n,r){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{inReg:r,inEnable:n})))},color:v.Om}),(0,a.jsx)(E,{name:"OutA",enabled:o.args.outAEnable,value:o.args.outAReg,setValue:function(e,n,r){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{outAReg:r,outAEnable:n})))},color:v.b5}),(0,a.jsx)(E,{name:"OutB",enabled:o.args.outBEnable,value:o.args.outBReg,setValue:function(e,n,r){i((0,I.QQ)(t,e,o,e=>(0,S.v4)(e,{outBReg:r,outBEnable:n})))},color:v.id})]})},E=e=>{let{name:t,enabled:o,value:n,setValue:i,color:r}=e;return(0,a.jsxs)("div",{className:m().regSelect,children:[(0,a.jsxs)("label",{onDoubleClick:e=>e.preventDefault(),children:[(0,a.jsx)("div",{className:m().text,style:{backgroundColor:r},children:t}),(0,a.jsx)("input",{type:"checkbox",checked:o,onChange:e=>{i(!0,e.target.checked,n),e.stopPropagation(),e.preventDefault()}})]}),(0,a.jsx)(j.GN,{className:m().regHex,value:n,update:function(e,t){i(e,o,t)},inputType:j.YM.Dec,fixedInputType:!0,hidePrefix:!0,minimalBackground:!0,padBits:5})]})},R=(0,r.createContext)(null);function _(){let[e,t]=(0,r.useState)(()=>B(!0));return(0,r.useEffect)(()=>{t(B())},[]),e}function B(e){let t=new l.d,o=function(){var e;let t,o=new y._c,n={};for(let r of[...(0,v.ei)(n),{defId:"riscv/alu0",altDefIds:["aluRiscv32_0"],name:"ALU",size:new d.AO(16,12),ports:[{id:"ctrl",name:"Ctrl",pos:new d.AO(0,3),type:c.bS.In,width:6},{id:"lhs",name:"LHS",pos:new d.AO(3,0),type:c.bS.In,width:32},{id:"rhs",name:"RHS",pos:new d.AO(13,0),type:c.bS.In,width:32},{id:"branch",name:"Branch",pos:new d.AO(4,12),type:c.bS.Out,width:1},{id:"result",name:"Result",pos:new d.AO(8,12),type:c.bS.OutTri,width:32}],build:e=>{let t=e.addData({inCtrlPort:e.getPort("ctrl"),inAPort:e.getPort("lhs"),inBPort:e.getPort("rhs"),outPort:e.getPort("result"),branchPort:e.getPort("branch")});return e.addPhase(g,[t.inCtrlPort,t.inAPort,t.inBPort],[t.outPort,t.branchPort]),e.build()},renderDom:e=>{let{comp:t,exeComp:o}=e;if(!o)return(0,a.jsx)("div",{className:(0,f.Z)(m().baseComp,m().rectComp),style:{...(0,x.MW)(t)},children:(0,a.jsxs)("div",{children:["ALU ",(0,a.jsx)("span",{style:{fontFamily:"monospace"},children:"0".padStart(5,"0")})]})});let{inCtrlPort:n,inAPort:i,inBPort:r}=o.data,s=n.value,l=(0,u.Vw)(i.value),d=(0,u.Vw)(r.value),c=(32&s)!=0,p=(16&s)!=0,g=s>>1&7,y="";y=p?u.Ge[g]:(1&s)!=0&&g===h.yi.ADD?"-":u.Gy[g];let v=o.data.outPort.value,b=o.data.branchPort.value;return(0,a.jsxs)("div",{className:(0,f.Z)(m().baseComp,m().rectComp),style:{...(0,x.MW)(t),display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsxs)("div",{children:["ALU ",(0,a.jsx)("span",{style:{fontFamily:"monospace"},children:null==o?void 0:o.data.inCtrlPort.value.toString(2).padStart(5,"0")})]}),!c&&(0,a.jsx)("div",{children:"[disabled]"}),c&&(0,a.jsxs)(a.Fragment,{children:[!p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[l," ",y," ",d]}),(0,a.jsx)("div",{children:"v"}),(0,a.jsx)("div",{children:(0,u.Vw)(v).toString()})]}),p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[l," ",y," ",d]}),(0,a.jsx)("div",{children:"v"}),(0,a.jsx)("div",{children:b?"BRANCH":"(no branch)"})]})]})]})}},{defId:"riscv/loadStore0",altDefIds:["riscvLoadStore"],name:"Load/Store",size:new d.AO(24,12),ports:[{id:"ctrl",name:"Ctrl",pos:new d.AO(0,1),type:c.bS.In,width:5},{id:"addrOffset",name:"Addr Offset",pos:new d.AO(0,2),type:c.bS.In,width:12},{id:"addrBase",name:"Addr Base",pos:new d.AO(5,12),type:c.bS.In,width:32},{id:"dataIn",name:"Data In",pos:new d.AO(12,12),type:c.bS.In,width:32},{id:"dataOut",name:"Data Out",pos:new d.AO(24,6),type:c.bS.OutTri,width:32},{id:"busCtrl",name:"Bus Ctrl",pos:new d.AO(4,0),type:c.bS.Out|c.bS.Ctrl,width:4},{id:"busAddr",name:"Bus Addr",pos:new d.AO(8,0),type:c.bS.Out|c.bS.Addr,width:32},{id:"busData",name:"Bus Data",pos:new d.AO(12,0),type:c.bS.In|c.bS.Out|c.bS.Tristate,width:32}],build:e=>{let t=e.addData({ctrl:e.getPort("ctrl"),addrOffset:e.getPort("addrOffset"),addrBase:e.getPort("addrBase"),dataIn:e.getPort("dataIn"),dataOut:e.getPort("dataOut"),busCtrl:e.getPort("busCtrl"),busAddr:e.getPort("busAddr"),busData:e.getPort("busData")});return e.addPhase(e=>{let{data:{ctrl:t,addrOffset:o,addrBase:n,dataIn:i,busCtrl:r,busAddr:s,busData:l}}=e,a=t.value,d=(1&a)!=0,u=(2&a)!=0,p=(28&a)>>2,m=u&&d;if(l.ioEnabled=!1,l.ioDir=m?0:1,l.value=0,i.ioEnabled=!1,n.ioEnabled=d,o.ioEnabled=d,s.ioEnabled=d,r.ioEnabled=d,d){let e=n.value+o.value;if(s.value=e,r.value=p<<2|(m?3:1),!u&&d){let e=p===h.FC.SB?255:p===h.FC.SH?65535:4294967295;l.value=i.value&e,l.ioEnabled=!0,l.ioDir=c.H.Out,i.ioEnabled=!0,i.ioDir=c.H.In}else l.ioDir=c.H.In}else r.value=0,l.ioEnabled=!1},[t.ctrl,t.addrOffset,t.addrBase,t.dataIn],[t.busCtrl,t.busAddr,t.busData]),e.addPhase(e=>{let{data:{ctrl:t,busData:o,dataOut:n}}=e,i=t.value,r=(28&i)>>2,s=(2&i)!=0&&(1&i)!=0;n.ioEnabled=s,s&&(r===h.FC.LB?n.value=(0,u.cy)(o.value):r===h.FC.LH?n.value=(0,u.am)(o.value):n.value=o.value,o.ioEnabled=!0)},[t.ctrl,t.busData],[t.dataOut]),e.build()}},{defId:"riscv/insFetch0",altDefIds:["riscvInsFetch"],name:"Instruction Fetch",size:new d.AO(20,12),ports:[{id:"pc",name:"PC",pos:new d.AO(5,3),type:c.bS.In,width:32},{id:"ins",name:"Ins",pos:new d.AO(10,1),type:c.bS.Out,width:32},{id:"addr",name:"Addr",pos:new d.AO(0,1),type:c.bS.Out,width:32},{id:"data",name:"Data",pos:new d.AO(0,2),type:c.bS.In,width:32}],build:e=>{let t=e.addData({pc:e.getPort("pc"),ins:e.getPort("ins"),addr:e.getPort("addr"),data:e.getPort("data")});return e.addPhase(e=>{let{data:{pc:t,addr:o}}=e;o.value=t.value},[t.pc],[t.addr]),e.addPhase(e=>{let{data:{data:t,ins:o}}=e;o.value=t.value},[t.data],[t.ins]),e.build()},render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e;if(i){let e=t.pos.x+.3,n=t.pos.y+.3,r=i.data.data.value;o.fillStyle="black",o.font=(0,b.We)(.4,b.Ky.Mono),o.textAlign="left",o.textBaseline="top",o.fillText("0x"+r.toString(16).padStart(8,"0"),e,n)}}},...(0,u.Az)(n),{defId:"flow/mux2",altDefIds:["mux2"],name:"Mux",size:new d.AO(2,6),ports:[{id:"sel",name:"S",pos:new d.AO(1,1),type:c.bS.In,width:1},{id:"a",name:"0",pos:new d.AO(0,2),type:c.bS.In,width:32},{id:"b",name:"1",pos:new d.AO(0,4),type:c.bS.In,width:32},{id:"out",name:"Z",pos:new d.AO(2,3),type:c.bS.Out,width:32}],build:e=>{let t=e.addData({inSelPort:e.getPort("sel"),inAPort:e.getPort("a"),inBPort:e.getPort("b"),outPort:e.getPort("out")});return e.addPhase(e=>{let{data:{inSelPort:t,inAPort:o,inBPort:n,outPort:i}}=e,r=0===t.value;i.value=r?o.value:n.value,o.ioEnabled=r,n.ioEnabled=!r},[t.inSelPort,t.inAPort,t.inBPort],[t.outPort]),e.build()},renderAll:!0,render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e;o.beginPath();let r=t.pos.x,s=t.pos.y,l=t.size.x,a=t.size.y,d=s+1-.9*t.size.x/2,c=s+1+.9*t.size.x/2,u=s+a-1+.9*t.size.x/2,p=s+a-1-.9*t.size.x/2;o.moveTo(r,d),o.lineTo(r+l,c),o.lineTo(r+l,p),o.lineTo(r,u),o.closePath(),o.fill(),o.stroke();let m=t.ports[(null==i?void 0:i.data.inSelPort.value)?2:1].pos,f=t.ports[3].pos,h=t.size.x/2;n.scale,o.beginPath(),o.moveTo(r+m.x,s+m.y),o.lineTo(r+h,s+m.y),o.lineTo(r+h,s+f.y),o.lineTo(r+f.x,s+f.y),o.strokeStyle="red",o.lineWidth=2*n.scale,o.stroke(),o.setLineDash([])}},{defId:"math/adder",altDefIds:["adder"],name:"+",size:new d.AO(2,4),ports:[{id:"a",name:"A",pos:new d.AO(0,1),type:c.bS.In,width:32},{id:"b",name:"B",pos:new d.AO(0,3),type:c.bS.In,width:32},{id:"out",name:"O",pos:new d.AO(2,3),type:c.bS.Out,width:32}],build:e=>{let t=e.addData({inAPort:e.getPort("a"),inBPort:e.getPort("b"),outPort:e.getPort("out")});return e.addPhase(e=>{let{data:{inAPort:t,inBPort:o,outPort:n}}=e;n.value=t.value+o.value},[t.inAPort,t.inBPort],[t.outPort]),e.build()}},{defId:"mem/rom0",altDefIds:["rom0"],name:"ROM",size:new d.AO(35,30),ports:[{id:"addr",name:"Addr",pos:new d.AO(35,2),type:c.bS.In,width:32},{id:"data",name:"Data",pos:new d.AO(35,1),type:c.bS.Out,width:32}],build:e=>{let t=new Uint8Array(1024),o=e.addData({addr:e.getPort("addr"),data:e.getPort("data"),rom:t,rom32View:new Uint32Array(t.buffer),updateCntr:0});return e.addPhase((e,t)=>{let{data:{addr:o,data:n,rom32View:i}}=e,r=o.value>>>2;r<0||r>=i.length?(n.value=0,t.halt=!0):n.value=i[o.value>>>2]},[o.addr],[o.data]),e.build()},render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i,styles:r}=e;if(!i)return;o.save(),o.beginPath(),o.rect(t.pos.x,t.pos.y,t.size.x,t.size.y),o.clip(),o.font=(0,b.We)(.8*r.fontSize,b.Ky.Mono);let s=o.measureText("0").width,l=12*s,a=t.size.x-1,d=t.pos.x+.5,c=t.pos.y+.5,u=.8*r.lineHeight,p=4*Math.floor(a/l),m=-4&i.data.addr.value,f=c+(m/p>>>0)*u,h=d+m%p*s*3;o.fillStyle="#0005",o.beginPath(),o.roundRect(h-.3,f-.2,11*s+.6,u,.5),o.fill();for(let e=0;e<32;e++){let t=c+e*u,n="";for(let t=0;t<p;t++){let o=i.data.rom[e*p+t].toString(16).padStart(2,"0");n+="".concat(o[0]).concat(o[1]," ")}o.fillStyle=""===n?"#0005":"#000",o.textAlign="left",o.textBaseline="top",o.fillText(n,d,t)}o.restore()},renderDom:e=>{let{comp:t,exeComp:o,styles:n}=e;return t.args,o&&o.data.addr.value,null},reset:(e,t)=>{let{hardReset:o}=t;o&&(e.data.rom.fill(0),e.data.updateCntr=0)},copyStatefulData:(e,t)=>{t.rom.set(e.rom),t.updateCntr=0===t.updateCntr?1:0}},{defId:"mem/ram0",altDefIds:["ram0"],name:"RAM",size:new d.AO(35,30),ports:[{id:"ctrl",name:"Ctrl",pos:new d.AO(0,2),type:c.bS.In,width:5},{id:"addr",name:"Addr",pos:new d.AO(0,4),type:c.bS.In,width:32},{id:"data",name:"Data",pos:new d.AO(0,6),type:c.bS.Out|c.bS.In|c.bS.Tristate,width:32}],build:e=>{let t=new Uint8Array(1024),o=e.addData({ctrl:e.getPort("ctrl"),addr:e.getPort("addr"),data:e.getPort("data"),ram:t,ram32View:new Uint32Array(t.buffer),updateCntr:0});return e.addPhase(function(e){let{data:{ctrl:t,addr:o,data:n,ram32View:r}}=e,s=(3&t.value)==3,l=(3&t.value)==1,a=t.value>>2&3;if(n.ioDir=s?c.H.Out:c.H.In,n.ioEnabled=s||l,s){n.ioEnabled=!0;let e=r[o.value>>2],t=(3&o.value)*8;n.value=a===i.Byte?e>>t&255:a===i.Half?e>>t&65535:e}else l?n.ioEnabled=!0:n.ioEnabled=!1},[o.ctrl,o.addr,o.data],[o.data]),e.addLatchedPhase(function(e){let{data:t}=e,{ctrl:o,addr:n,data:r,ram32View:s}=t,l=(3&o.value)==1,a=o.value>>2&3;if(l){let e=s[n.value>>2],o=(3&n.value)*8,l=a===i.Byte?255<<o:a===i.Half?65535<<o:4294967295,d=e&~l|r.value<<o&l;s[n.value>>2]=d,t.updateCntr+=1}},[],[]),e.build()},copyStatefulData:(e,t)=>{t.ram.set(e.ram)},reset:e=>{e.data.ram.fill(0),e.data.updateCntr=0},renderDom:e=>{let{comp:t,exeComp:o,styles:n}=e;return null}},...(t=new d.AO(1,2),[{defId:"gate/or",altDefIds:["or"],name:"Or",size:new d.AO(3,4),ports:[{id:"a",name:"",pos:new d.AO(0,1),type:c.bS.In,width:1},{id:"b",name:"",pos:new d.AO(0,3),type:c.bS.In,width:1},{id:"o",name:"",pos:new d.AO(3,2),type:c.bS.Out,width:1}],initConfig:()=>({rotate:0}),applyConfig(e,o){let n=N(o.rotate,t);e.ports=e.ports.map(e=>({...e,pos:n.mulVec3(e.pos)}))},build:e=>{let t=e.addData({inAPort:e.getPort("a"),inBPort:e.getPort("b"),outPort:e.getPort("o")});return e.addPhase(e=>{let{data:{inAPort:t,inBPort:o,outPort:n}}=e;n.value=t.value|o.value},[t.inAPort,t.inBPort],[t.outPort]),e.build()},renderAll:!0,render:e=>{let{comp:o,ctx:n,cvs:i,exeComp:r}=e;n.save();let s=N(o.args.rotate,o.pos.add(t));n.transform(...s.toTransformParams()),n.beginPath();let l=o.pos.x-.2,a=o.pos.y+.5,d=l+o.size.x,c=o.size.x+.2,u=o.size.y-1,p=.9*u;n.moveTo(l,a),n.arcTo(d-1,a,l+c,a+u/2,p),n.lineTo(l+c,a+u/2),n.arcTo(d-1,a+u,l,a+u,p),n.lineTo(l,a+u),n.arcTo(l+.7,a+u/2,l,a,.8*u),n.closePath(),n.fill(),n.stroke(),n.restore()},renderDom:e=>{let{comp:t,exeComp:o,editCtx:n,isActive:i}=e;return(0,a.jsx)(x.Uy,{comp:t,hideHover:!0,children:(0,a.jsx)(P,{editCtx:n,comp:t,exeComp:o,isActive:i})})}},{defId:"gate/xor",altDefIds:["xor"],name:"Xor",size:new d.AO(3,4),ports:[{id:"a",name:"",pos:new d.AO(0,1),type:c.bS.In,width:1},{id:"b",name:"",pos:new d.AO(0,3),type:c.bS.In,width:1},{id:"o",name:"",pos:new d.AO(3,2),type:c.bS.Out,width:1}],initConfig:()=>({rotate:0}),applyConfig(e,o){let n=N(o.rotate,t);e.ports=e.ports.map(e=>({...e,pos:n.mulVec3(e.pos)}))},build:e=>{let t=e.addData({inAPort:e.getPort("a"),inBPort:e.getPort("b"),outPort:e.getPort("o")});return e.addPhase(e=>{let{data:{inAPort:t,inBPort:o,outPort:n}}=e;n.value=t.value^o.value},[t.inAPort,t.inBPort],[t.outPort]),e.build()},renderAll:!0,render:e=>{let{comp:o,ctx:n,cvs:i,exeComp:r}=e;n.save();let s=N(o.args.rotate,o.pos.add(t));n.transform(...s.toTransformParams()),n.beginPath();let l=o.pos.x-.2,a=o.pos.y+.5,d=l+o.size.x,c=o.size.x+.2,u=o.size.y-1,p=.9*u;n.moveTo(l,a),n.arcTo(d-1,a,l+c,a+u/2,p),n.lineTo(l+c,a+u/2),n.arcTo(d-1,a+u,l,a+u,p),n.lineTo(l,a+u),n.arcTo(l+.7,a+u/2,l,a,.8*u),n.closePath(),n.fill(),n.moveTo(l-.5,a+u),n.arcTo(l+.7-.5,a+u/2,l-.5,a,.8*u),n.lineTo(l-.5,a),n.stroke(),n.restore()},renderDom:e=>{let{comp:t,exeComp:o,editCtx:n,isActive:i}=e;return(0,a.jsx)(x.Uy,{comp:t,hideHover:!0,children:(0,a.jsx)(P,{editCtx:n,comp:t,exeComp:o,isActive:i})})}},{defId:"gate/and",altDefIds:["and"],name:"And",size:new d.AO(3,4),ports:[{id:"a",name:"",pos:new d.AO(0,1),type:c.bS.In,width:1},{id:"b",name:"",pos:new d.AO(0,3),type:c.bS.In,width:1},{id:"o",name:"",pos:new d.AO(3,2),type:c.bS.Out,width:1}],initConfig:()=>({rotate:0}),applyConfig(e,o){let n=N(o.rotate,t);e.ports=e.ports.map(e=>({...e,pos:n.mulVec3(e.pos)}))},build:e=>{let t=e.addData({inAPort:e.getPort("a"),inBPort:e.getPort("b"),outPort:e.getPort("o")});return e.addPhase(e=>{let{data:{inAPort:t,inBPort:o,outPort:n}}=e;n.value=t.value&o.value},[t.inAPort,t.inBPort],[t.outPort]),e.build()},renderAll:!0,render:e=>{let{comp:o,ctx:n,cvs:i,exeComp:r}=e;n.save();let s=N(o.args.rotate,o.pos.add(t));n.transform(...s.toTransformParams()),n.beginPath();let l=o.pos.x-0,a=o.pos.y+.5,d=l+o.size.x,c=o.size.x+0,u=o.size.y-1;n.moveTo(l,a),n.lineTo(l+.4*c,a),n.arc(d-u/2,a+u/2,u/2,-Math.PI/2,Math.PI/2),n.lineTo(l,a+u),n.lineTo(l,a),n.closePath(),n.fill(),n.stroke(),n.restore()},renderDom:e=>{let{comp:t,exeComp:o,editCtx:n,isActive:i}=e;return(0,a.jsx)(x.Uy,{comp:t,hideHover:!0,children:(0,a.jsx)(P,{editCtx:n,comp:t,exeComp:o,isActive:i})})}},{defId:"gate/not",altDefIds:["not"],name:"NOT",size:new d.AO(3,4),ports:[{id:"i",name:"",pos:new d.AO(0,2),type:c.bS.In,width:1},{id:"o",name:"",pos:new d.AO(3,2),type:c.bS.Out,width:1}],build:e=>{let t=e.addData({inPort:e.getPort("i"),outPort:e.getPort("o")});return e.addPhase(e=>{let{data:{inPort:t,outPort:o}}=e;o.value=t.value?0:1},[t.inPort],[t.outPort]),e.build()},renderAll:!0,render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e;o.beginPath();let r=t.pos.x,s=t.pos.y+.7,l=r+t.size.x-.5,a=t.size.x,d=t.size.y-1.4;o.moveTo(r,s),o.lineTo(l,s+d/2),o.lineTo(r,s+d),o.closePath(),o.moveTo(r+a,s+d/2),o.arc(l+.25,s+d/2,.25,0,2*Math.PI),o.moveTo(l+.45,s+d/2),o.arc(l+.25,s+d/2,.2,0,2*Math.PI),o.fill("evenodd"),o.stroke()}}]),{defId:"bus/addrMap",altDefIds:["addrMap"],name:"Address Map",size:new d.AO(10,12),ports:[{id:"busCtrl",name:"Bus Ctrl",pos:new d.AO(0,2),type:c.bS.In|c.bS.Ctrl,width:4},{id:"busAddr",name:"Bus Addr",pos:new d.AO(0,4),type:c.bS.In|c.bS.Addr,width:32},{id:"busData",name:"Bus Data",pos:new d.AO(0,6),type:c.bS.In|c.bS.Out|c.bS.Tristate,width:32},{id:"localCtrl",name:"Local Ctrl",pos:new d.AO(10,2),type:c.bS.Out|c.bS.Ctrl,width:4},{id:"localAddr",name:"Local Addr",pos:new d.AO(10,4),type:c.bS.Out|c.bS.Addr,width:32},{id:"localData",name:"Local Data",pos:new d.AO(10,6),type:c.bS.In|c.bS.Out|c.bS.Tristate,width:32}],initConfig:()=>({addrOffset:65536,addrMask:65535}),build:e=>{let t=e.addData({busCtrl:e.getPort("busCtrl"),busData:e.getPort("busData"),busAddr:e.getPort("busAddr"),localCtrl:e.getPort("localCtrl"),localData:e.getPort("localData"),localAddr:e.getPort("localAddr"),addrOffset:e.comp.args.addrOffset,addrMask:e.comp.args.addrMask});return e.addPhase(e=>{let{data:{busCtrl:o,busAddr:n,busData:i,localCtrl:r,localAddr:s,localData:l,addrOffset:a}}=e,d=o.value,u=(1&d)==1,p=(3&d)==1,m=n.value,f=m&~t.addrMask,h=m&t.addrMask,x=f===t.addrOffset;r.value=0,s.value=0,l.ioEnabled=u,l.ioDir=p?c.H.Out:c.H.In,i.ioEnabled=u,x&&u&&(r.value=d,s.value=h,p&&(l.value=i.value,l.ioEnabled=!0,l.ioDir=c.H.Out))},[t.busCtrl,t.busAddr,t.busData],[t.localCtrl,t.localAddr,t.localData]),e.addPhase(e=>{let{data:{localCtrl:t,localData:o,busData:n}}=e;n.ioDir=c.H.In;let i=t.value,r=(3&i)==3;r&&(n.value=o.value,n.ioDir=r?c.H.Out:c.H.In),n.ioEnabled=(1&i)==1},[t.localData,t.busCtrl],[t.busData]),e.build()},render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e},renderDom:e=>{let{comp:t,exeComp:o,editCtx:n}=e;return(0,a.jsx)(A,{editCtx:n,comp:t,exeComp:o})}},{defId:"io/output0",altDefIds:["output0"],name:"Output",size:new d.AO(6,4),ports:[{id:"x",name:"x",pos:new d.AO(0,2),type:c.bS.In,width:32}],build:e=>{let t=e.addData({inPort:e.getPort("x")});return e.addPhase(()=>{},[t.inPort],[]),e.build()},render:e=>{let{comp:t,cvs:o,ctx:n,exeComp:i,styles:r}=e;if(!i)return;n.save(),n.font=(0,b.We)(r.fontSize,b.Ky.Mono),n.fillStyle="#000",n.textAlign="center",n.textBaseline="middle";let s=i.data.inPort.value;n.fillText(s.toString(),t.pos.x+t.size.x/2,t.pos.y+t.size.y/2),n.restore()}},{defId:"io/const32",altDefIds:["const32"],name:"Const32",size:new d.AO(10,4),ports:(e,t)=>{let o=c.bS.Out;return[{id:"out",name:"",pos:(0,O.hT)(e.portPos,e.w,e.h),type:o,width:e.bitWidth}]},initConfig:()=>({value:4,valueMode:j.YM.Hex,bitWidth:32,h:4,w:10,portPos:O.N0.Right,signed:!1}),applyConfig:(e,t)=>{e.size=new d.AO(t.w,t.h)},build:e=>{let t=e.addData({value:e.comp.args.value,outPort:e.getPort("out")});return e.addPhase(e=>{let{data:t}=e;t.outPort.value=t.value},[],[t.outPort]),e.build()},render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i,styles:r}=e},renderDom:e=>{let{comp:t,exeComp:o,styles:n,editCtx:i,isActive:r}=e;return(0,a.jsx)(D,{editCtx:i,isActive:r,comp:t,exeComp:o,styles:n})}},{defId:"io/ledOutput0",altDefIds:["p_ledOutput"],name:"LED Output",size:new d.AO(30,8),ports:[{id:"busCtrl",name:"C",pos:new d.AO(0,2),type:c.bS.In|c.bS.Ctrl,width:4},{id:"busAddr",name:"A",pos:new d.AO(0,4),type:c.bS.In|c.bS.Addr,width:32},{id:"busData",name:"D",pos:new d.AO(0,6),type:c.bS.In|c.bS.Out|c.bS.Tristate,width:32}],copyStatefulData:(e,t)=>{t.value=e.value},reset:e=>{e.data.value=0},build:e=>{let t=e.addData({busCtrl:e.getPort("busCtrl"),busData:e.getPort("busData"),busAddr:e.getPort("busAddr"),value:0,bitsOn:0,bitsOff:0,bitsToggle:0,newValue:null});return e.addPhase(e=>{let{data:{busCtrl:o,busAddr:n,busData:i}}=e,r=o.value,s=n.value;if(t.bitsOn=0,t.bitsOff=0,t.bitsToggle=0,t.newValue=null,(3&r)==1){let e=T.regs[s];e&&e(t,i.value,!0)}i.ioEnabled=(1&r)==1,i.ioDir=(3&r)==3?c.H.Out:c.H.In},[t.busCtrl,t.busAddr,t.busData],[]),e.addPhase(e=>{let{data:{busCtrl:o,busAddr:n,busData:i}}=e,r=o.value;if((3&r)==3){let e=T.regs[n.value];e?i.value=e(t,0,!1):i.value=0}i.ioEnabled=(1&r)==1},[],[t.busData]),e.addLatchedPhase(e=>{let{data:{busCtrl:o,busAddr:n,busData:i}}=e;null!==t.newValue&&(t.value=t.newValue)},[],[]),e.build()},render:e=>{let{comp:t,ctx:o,cvs:n,exeComp:i}=e},renderDom:e=>{let{comp:t,exeComp:o}=e;return(0,a.jsx)(L,{comp:t,exeComp:o,value:o.data.value})}},{defId:"riscv/regFile0Input",altDefIds:["riscvRegFile0Input"],name:"Reg File Input",size:new d.AO(10,12),ports:[{id:"ctrl",name:"Ctrl",pos:new d.AO(5,12),type:c.bS.Out|c.bS.Ctrl,width:18}],initConfig:()=>({inEnable:!1,inReg:0,outAEnable:!1,outAReg:0,outBEnable:!1,outBReg:0}),build:e=>{let t=e.comp.args,o=e.addData({...t,ctrl:e.getPort("ctrl")});return e.addPhase(e=>{let{data:{ctrl:o}}=e;function n(e,t,n){let i=o.value;i=i&~(63<<6*n)|((e?1:0)|(31&t)<<1)<<6*n,o.value=i}n(t.outAEnable,t.outAReg,0),n(t.outBEnable,t.outBReg,1),n(t.inEnable,t.inReg,2)},[],[o.ctrl]),e.build()},renderDom:e=>{let{editCtx:t,comp:o,exeComp:n}=e;return(0,a.jsx)(k,{editCtx:t,comp:o,exeComp:n})}},...(0,O.Yq)(n)]){let t="core/"+r.defId;r.altDefIds=[...null!==(e=r.altDefIds)&&void 0!==e?e:[],r.defId],r.defId=t,o.addComp(r)}return o}();return t.populateSchematicLibrary(o,!e),{compLibrary:o,schematicLibrary:t,codeLibrary:new s.u}}},3589:function(e,t,o){"use strict";o.d(t,{$:function(){return d},D:function(){return a}});var n=o(740),i=o.n(n),r=o(5829),s=o.n(r);let l=i()(s()).theme.colors,a={compBg:l.cyan["500"],portInputBg:"rgb(45 212 191)",portOutputBg:"rgb(251 146 60)"},d={compBg:"bg-cyan-500",portInputBg:"bg-teal-400",portOutputBg:"bg-orange-400"}},652:function(e,t,o){"use strict";o.d(t,{d:function(){return c}});var n=o(2019),i=o(9158),r=o(6624),s=o(9107),l=o(8602);let a=[{id:"c-a7yetcbo",name:"PC Counter",model:{wires:[{nodes:[{id:0,x:41,y:-12,edges:[1],ref:{type:3,id:"8",compNodeId:"out"}},{id:1,x:44,y:-12,edges:[0,2]},{id:2,x:44,y:-6,edges:[1,3]},{id:3,x:47,y:-6,edges:[2],ref:{type:3,id:"7",compNodeId:"a"}}]},{nodes:[{id:0,x:41,y:-4,edges:[1],ref:{type:3,id:"6",compNodeId:"out"}},{id:1,x:45,y:-4,edges:[0,2]},{id:2,x:45,y:-4,edges:[1,3]},{id:3,x:47,y:-4,edges:[2],ref:{type:3,id:"7",compNodeId:"b"}}]},{nodes:[{id:0,x:49,y:-4,edges:[1],ref:{type:3,id:"7",compNodeId:"out"}},{id:1,x:52,y:-4,edges:[0,2]},{id:2,x:52,y:3,edges:[1,3]},{id:3,x:-2,y:3,edges:[2,4]},{id:4,x:-2,y:-4,edges:[3,5]},{id:5,x:1,y:-4,edges:[4],ref:{type:3,id:"6",compNodeId:"in"}}]}],comps:[{id:"6",defId:"core/flipflop/reg1",x:1,y:-7,args:null},{id:"7",defId:"core/math/adder",x:47,y:-7,args:null},{id:"8",defId:"core/io/const32",x:37,y:-14,args:{value:4,valueMode:0,bitWidth:32,h:4,w:4,portPos:0,signed:!1}}]}},{id:"reg-file-demo",name:"Reg File Demo",model:{wires:[{nodes:[{id:0,x:587,y:351,edges:[1],ref:{type:3,id:"1",compNodeId:"ctrl"}},{id:1,x:587,y:350,edges:[0,2]},{id:2,x:601,y:350,edges:[1,3]},{id:3,x:601,y:347,edges:[2],ref:{type:3,id:"0",compNodeId:"ctrl"}}]},{nodes:[{id:0,x:623,y:354,edges:[1],ref:{type:3,id:"1",compNodeId:"outA"}},{id:1,x:624,y:354,edges:[0,2]},{id:2,x:624,y:350,edges:[1,3]},{id:3,x:608,y:350,edges:[2,4]},{id:4,x:608,y:345,edges:[3,5]},{id:5,x:609,y:345,edges:[4],ref:{type:3,id:"3",compNodeId:"x"}}]},{nodes:[{id:0,x:623,y:357,edges:[1],ref:{type:3,id:"1",compNodeId:"outB"}},{id:1,x:625,y:357,edges:[0,2]},{id:2,x:625,y:349,edges:[1,3]},{id:3,x:616,y:349,edges:[2,4]},{id:4,x:616,y:345,edges:[3,5]},{id:5,x:617,y:345,edges:[4],ref:{type:3,id:"4",compNodeId:"x"}}]},{nodes:[{id:0,x:594,y:345,edges:[1,2]},{id:1,x:594,y:349,edges:[0,3]},{id:2,x:593,y:345,edges:[0],ref:{type:3,id:"2",compNodeId:"out"}},{id:3,x:582,y:349,edges:[1,4]},{id:4,x:582,y:354,edges:[3,5]},{id:5,x:583,y:354,edges:[4],ref:{type:3,id:"1",compNodeId:"in"}}]}],comps:[{id:"0",defId:"core/riscv/regFile0Input",x:596,y:335,args:{inEnable:!0,inReg:3,outAEnable:!0,outAReg:3,outBEnable:!0,outBReg:4}},{id:"1",defId:"core/riscv/reg32",x:583,y:351,args:null},{id:"2",defId:"core/io/const32",x:583,y:343,args:{value:7,valueMode:0,bitWidth:32,h:4,w:10,portPos:0,signed:!1}},{id:"3",defId:"core/io/output0",x:609,y:343,args:null},{id:"4",defId:"core/io/output0",x:617,y:343,args:null}]}},{id:"riscv-basic",name:"RISCV Basic",model:{wires:[{nodes:[{id:0,x:-6,y:44,edges:[1],ref:{type:3,id:"1",compNodeId:"in"}},{id:1,x:-11,y:44,edges:[0],ref:{type:3,id:"7",compNodeId:"out"}}]},{nodes:[{id:0,x:-14,y:31,edges:[1,2]},{id:1,x:-14,y:35,edges:[0,3,4]},{id:2,x:-13,y:31,edges:[0],ref:{type:3,id:"8",compNodeId:"b"}},{id:3,x:42,y:35,edges:[1,5]},{id:4,x:-14,y:43,edges:[1,6]},{id:5,x:42,y:30,edges:[3,7]},{id:6,x:-13,y:43,edges:[4],ref:{type:3,id:"7",compNodeId:"a"}},{id:7,x:41,y:30,edges:[5],ref:{type:3,id:"9",compNodeId:"out"}}]},{nodes:[{id:0,x:35,y:19,edges:[1],ref:{type:3,id:"13",compNodeId:"a"}},{id:1,x:31,y:19,edges:[0],ref:{type:3,id:"12",compNodeId:"out"}}]},{nodes:[{id:0,x:-2,y:41,edges:[1],ref:{type:3,id:"1",compNodeId:"ctrl"}},{id:1,x:-2,y:14,edges:[0],ref:{type:3,id:"5",compNodeId:"regCtrl"}}]},{nodes:[{id:0,x:36,y:17,edges:[1,2]},{id:1,x:36,y:18,edges:[0],ref:{type:3,id:"13",compNodeId:"sel"}},{id:2,x:41,y:17,edges:[0,3]},{id:3,x:41,y:26,edges:[2,4]},{id:4,x:53,y:26,edges:[3,5]},{id:5,x:53,y:25,edges:[4],ref:{type:3,id:"2",compNodeId:"branch"}}]},{nodes:[{id:0,x:34,y:-5,edges:[1],ref:{type:3,id:"5",compNodeId:"loadStoreCtrl"}},{id:1,x:40,y:-5,edges:[0],ref:{type:3,id:"14",compNodeId:"ctrl"}}]},{nodes:[{id:0,x:34,y:-4,edges:[1],ref:{type:3,id:"5",compNodeId:"addrOffset"}},{id:1,x:40,y:-4,edges:[0],ref:{type:3,id:"14",compNodeId:"addrOffset"}}]},{nodes:[{id:0,x:-11,y:30,edges:[1],ref:{type:3,id:"8",compNodeId:"out"}},{id:1,x:-6,y:30,edges:[0],ref:{type:3,id:"3",compNodeId:"in"}}]},{nodes:[{id:0,x:34,y:44,edges:[1],ref:{type:3,id:"1",compNodeId:"outA"}},{id:1,x:40,y:44,edges:[0],ref:{type:3,id:"10",compNodeId:"b"}}]},{nodes:[{id:0,x:37,y:20,edges:[1],ref:{type:3,id:"13",compNodeId:"out"}},{id:1,x:38,y:20,edges:[0,2]},{id:2,x:38,y:28,edges:[1,3]},{id:3,x:39,y:28,edges:[2],ref:{type:3,id:"9",compNodeId:"a"}}]},{nodes:[{id:0,x:34,y:30,edges:[1],ref:{type:3,id:"3",compNodeId:"out"}},{id:1,x:36,y:30,edges:[0,2,3,4]},{id:2,x:36,y:24,edges:[1,5]},{id:3,x:36,y:42,edges:[1,6]},{id:4,x:39,y:30,edges:[1],ref:{type:3,id:"9",compNodeId:"b"}},{id:5,x:-12,y:24,edges:[2,7]},{id:6,x:40,y:42,edges:[3],ref:{type:3,id:"10",compNodeId:"a"}},{id:7,x:-12,y:-4,edges:[5,8]},{id:8,x:-19,y:-4,edges:[7],ref:{type:3,id:"11",compNodeId:"addr"}}]},{nodes:[{id:0,x:-12,y:42,edges:[1],ref:{type:3,id:"7",compNodeId:"sel"}},{id:1,x:-9,y:42,edges:[0,2]},{id:2,x:-9,y:28,edges:[1,3,4]},{id:3,x:-12,y:28,edges:[2],ref:{type:3,id:"8",compNodeId:"sel"}},{id:4,x:-9,y:18,edges:[2,5]},{id:5,x:-5,y:18,edges:[4,6]},{id:6,x:-5,y:14,edges:[5],ref:{type:3,id:"5",compNodeId:"pcRegMuxCtrl"}}]},{nodes:[{id:0,x:64,y:0,edges:[1],ref:{type:3,id:"14",compNodeId:"dataOut"}},{id:1,x:67,y:0,edges:[0,2]},{id:2,x:67,y:27,edges:[1,3]},{id:3,x:57,y:27,edges:[2,4,5]},{id:4,x:57,y:37,edges:[3,6]},{id:5,x:57,y:25,edges:[3],ref:{type:3,id:"2",compNodeId:"result"}},{id:6,x:-16,y:37,edges:[4,7,8]},{id:7,x:-16,y:45,edges:[6,9]},{id:8,x:-16,y:29,edges:[6,10]},{id:9,x:-13,y:45,edges:[7],ref:{type:3,id:"7",compNodeId:"b"}},{id:10,x:-13,y:29,edges:[8],ref:{type:3,id:"8",compNodeId:"a"}}]},{nodes:[{id:0,x:-66,y:29,edges:[1],ref:{type:3,id:"16",compNodeId:"busCtrl"}},{id:1,x:-68,y:29,edges:[0,2,3]},{id:2,x:-68,y:-8,edges:[1,4]},{id:3,x:-68,y:62,edges:[1,5]},{id:4,x:44,y:-8,edges:[2,6]},{id:5,x:-66,y:62,edges:[3],ref:{type:3,id:"17",compNodeId:"busCtrl"}},{id:6,x:44,y:-6,edges:[4],ref:{type:3,id:"14",compNodeId:"busCtrl"}}]},{nodes:[{id:0,x:-66,y:31,edges:[1],ref:{type:3,id:"16",compNodeId:"busAddr"}},{id:1,x:-70,y:31,edges:[0,2,3]},{id:2,x:-70,y:-10,edges:[1,4]},{id:3,x:-70,y:64,edges:[1,5]},{id:4,x:48,y:-10,edges:[2,6]},{id:5,x:-66,y:64,edges:[3],ref:{type:3,id:"17",compNodeId:"busAddr"}},{id:6,x:48,y:-6,edges:[4],ref:{type:3,id:"14",compNodeId:"busAddr"}}]},{nodes:[{id:0,x:-66,y:33,edges:[1],ref:{type:3,id:"16",compNodeId:"busData"}},{id:1,x:-72,y:33,edges:[0,2,3]},{id:2,x:-72,y:-12,edges:[1,4]},{id:3,x:-72,y:66,edges:[1,5]},{id:4,x:52,y:-12,edges:[2,6]},{id:5,x:-66,y:66,edges:[3],ref:{type:3,id:"17",compNodeId:"busData"}},{id:6,x:52,y:-6,edges:[4],ref:{type:3,id:"14",compNodeId:"busData"}}]},{nodes:[{id:0,x:-56,y:29,edges:[1],ref:{type:3,id:"16",compNodeId:"localCtrl"}},{id:1,x:-54,y:29,edges:[0],ref:{type:3,id:"15",compNodeId:"ctrl"}}]},{nodes:[{id:0,x:-56,y:31,edges:[1],ref:{type:3,id:"16",compNodeId:"localAddr"}},{id:1,x:-54,y:31,edges:[0],ref:{type:3,id:"15",compNodeId:"addr"}}]},{nodes:[{id:0,x:-56,y:33,edges:[1],ref:{type:3,id:"16",compNodeId:"localData"}},{id:1,x:-54,y:33,edges:[0],ref:{type:3,id:"15",compNodeId:"data"}}]},{nodes:[{id:0,x:34,y:22,edges:[1,2]},{id:1,x:1,y:22,edges:[0,3]},{id:2,x:34,y:21,edges:[0,4]},{id:3,x:1,y:14,edges:[1],ref:{type:3,id:"5",compNodeId:"pcAddImm"}},{id:4,x:35,y:21,edges:[2],ref:{type:3,id:"13",compNodeId:"b"}}]},{nodes:[{id:0,x:-56,y:62,edges:[1],ref:{type:3,id:"17",compNodeId:"localCtrl"}},{id:1,x:-54,y:62,edges:[0],ref:{type:3,id:"18",compNodeId:"busCtrl"}}]},{nodes:[{id:0,x:-56,y:64,edges:[1],ref:{type:3,id:"17",compNodeId:"localAddr"}},{id:1,x:-54,y:64,edges:[0],ref:{type:3,id:"18",compNodeId:"busAddr"}}]},{nodes:[{id:0,x:-56,y:66,edges:[1],ref:{type:3,id:"17",compNodeId:"localData"}},{id:1,x:-54,y:66,edges:[0],ref:{type:3,id:"18",compNodeId:"busData"}}]},{nodes:[{id:0,x:38,y:9,edges:[1,2]},{id:1,x:38,y:0,edges:[0,3]},{id:2,x:41,y:9,edges:[0],ref:{type:3,id:"19",compNodeId:"a"}},{id:3,x:34,y:0,edges:[1],ref:{type:3,id:"5",compNodeId:"rhsImm"}}]},{nodes:[{id:0,x:43,y:10,edges:[1],ref:{type:3,id:"19",compNodeId:"out"}},{id:1,x:52,y:10,edges:[0,2,3]},{id:2,x:52,y:6,edges:[1],ref:{type:3,id:"14",compNodeId:"dataIn"}},{id:3,x:62,y:10,edges:[1,4]},{id:4,x:62,y:13,edges:[3],ref:{type:3,id:"2",compNodeId:"rhs"}}]},{nodes:[{id:0,x:47,y:47,edges:[1,2]},{id:1,x:34,y:47,edges:[0],ref:{type:3,id:"1",compNodeId:"outB"}},{id:2,x:47,y:14,edges:[0,3]},{id:3,x:38,y:14,edges:[2,4]},{id:4,x:38,y:11,edges:[3,5]},{id:5,x:41,y:11,edges:[4],ref:{type:3,id:"19",compNodeId:"b"}}]},{nodes:[{id:0,x:36,y:7,edges:[1,2]},{id:1,x:42,y:7,edges:[0,3]},{id:2,x:36,y:2,edges:[0,4]},{id:3,x:42,y:8,edges:[1],ref:{type:3,id:"19",compNodeId:"sel"}},{id:4,x:34,y:2,edges:[2],ref:{type:3,id:"5",compNodeId:"rhsSel"}}]},{nodes:[{id:0,x:9,y:14,edges:[1],ref:{type:3,id:"5",compNodeId:"lhsSel"}},{id:1,x:9,y:16,edges:[0,2]},{id:2,x:43,y:16,edges:[1,3]},{id:3,x:43,y:40,edges:[2,4]},{id:4,x:41,y:40,edges:[3,5]},{id:5,x:41,y:41,edges:[4],ref:{type:3,id:"10",compNodeId:"sel"}}]},{nodes:[{id:0,x:49,y:16,edges:[1],ref:{type:3,id:"2",compNodeId:"ctrl"}},{id:1,x:12,y:16,edges:[2,0]},{id:2,x:12,y:14,edges:[1],ref:{type:3,id:"5",compNodeId:"aluCtrl"}}]},{nodes:[{id:0,x:-19,y:-5,edges:[1],ref:{type:3,id:"11",compNodeId:"data"}},{id:1,x:-6,y:-5,edges:[0],ref:{type:3,id:"5",compNodeId:"ins"}}]},{nodes:[{id:0,x:45,y:6,edges:[1],ref:{type:3,id:"14",compNodeId:"addrBase"}},{id:1,x:45,y:7,edges:[0,2]},{id:2,x:45,y:7,edges:[1,3]},{id:3,x:45,y:12,edges:[4,5,2]},{id:4,x:52,y:12,edges:[3,6]},{id:5,x:45,y:43,edges:[3,7]},{id:6,x:52,y:13,edges:[4],ref:{type:3,id:"2",compNodeId:"lhs"}},{id:7,x:42,y:43,edges:[5],ref:{type:3,id:"10",compNodeId:"out"}}]}],comps:[{id:"1",defId:"core/riscv/reg32",x:-6,y:41,args:null},{id:"2",defId:"core/riscv/alu0",x:49,y:13,args:null},{id:"3",defId:"core/flipflop/reg1",x:-6,y:27,args:null},{id:"5",defId:"core/riscv/insDecode0",x:-6,y:-6,args:null},{id:"7",defId:"core/flow/mux2",x:-13,y:41,args:null},{id:"8",defId:"core/flow/mux2",x:-13,y:27,args:null},{id:"9",defId:"core/math/adder",x:39,y:27,args:null},{id:"10",defId:"core/flow/mux2",x:40,y:40,args:null},{id:"11",defId:"core/mem/rom0",x:-54,y:-6,args:null},{id:"12",defId:"core/io/const32",x:21,y:17,args:{value:4,valueMode:0,bitWidth:32,h:4,w:10,portPos:0,signed:!1}},{id:"13",defId:"core/flow/mux2",x:35,y:17,args:null},{id:"14",defId:"core/riscv/loadStore0",x:40,y:-6,args:null},{id:"15",defId:"core/mem/ram0",x:-54,y:27,args:null},{id:"16",defId:"core/bus/addrMap",x:-66,y:27,args:{addrOffset:65536,addrMask:65535}},{id:"17",defId:"core/bus/addrMap",x:-66,y:60,args:{addrOffset:1073872896,addrMask:65535}},{id:"18",defId:"core/io/ledOutput0",x:-54,y:60,args:null},{id:"19",defId:"core/flow/mux2",x:41,y:7,args:null}]}},{id:"c-s1m3zs3x",name:"ROM Usage",model:{wires:[{nodes:[{id:0,x:40,y:15,edges:[1],ref:{type:3,id:"7",compNodeId:"addr"}},{id:1,x:44,y:15,edges:[0,2]},{id:2,x:44,y:26,edges:[1,3]},{id:3,x:92,y:26,edges:[2,4]},{id:4,x:92,y:32,edges:[3,5,6]},{id:5,x:98,y:32,edges:[4],ref:{type:3,id:"10",compNodeId:"b"}},{id:6,x:89,y:32,edges:[4],ref:{type:3,id:"9",compNodeId:"out"}}]},{nodes:[{id:0,x:100,y:32,edges:[1],ref:{type:3,id:"10",compNodeId:"out"}},{id:1,x:101,y:32,edges:[0,2]},{id:2,x:101,y:39,edges:[1,3]},{id:3,x:44,y:39,edges:[2,4]},{id:4,x:44,y:32,edges:[3,5]},{id:5,x:49,y:32,edges:[4],ref:{type:3,id:"9",compNodeId:"in"}}]},{nodes:[{id:0,x:96,y:27,edges:[1],ref:{type:3,id:"11",compNodeId:"out"}},{id:1,x:96,y:30,edges:[0,2]},{id:2,x:98,y:30,edges:[1],ref:{type:3,id:"10",compNodeId:"a"}}]},{nodes:[{id:0,x:49,y:14,edges:[1,2]},{id:1,x:49,y:18,edges:[0,3]},{id:2,x:40,y:14,edges:[0],ref:{type:3,id:"7",compNodeId:"data"}},{id:3,x:60,y:18,edges:[1],ref:{type:3,id:"8",compNodeId:"a"}}]}],comps:[{id:"7",defId:"core/mem/rom0",x:5,y:13,args:null},{id:"8",defId:"core/comp/port",x:60,y:16,args:{portId:"data",name:"Data Out",w:14,h:4,type:2,portPos:2,bitWidth:32,signed:!0,valueMode:0,inputOverride:!1,inputValueOverride:0}},{id:"9",defId:"core/flipflop/reg1",x:49,y:29,args:null},{id:"10",defId:"core/math/adder",x:98,y:29,args:null},{id:"11",defId:"core/io/const32",x:94,y:23,args:{value:4,valueMode:0,bitWidth:32,h:4,w:4,portPos:1,signed:!1}}]}}];var d=o(8450);class c{populateSchematicLibrary(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.builtinSchematics.clear(),this.customSchematics.clear(),this.addLocalSchematics(e),t&&this.readFromLocalStorage(e),this.addSchematicsToCompLibrary(e),this.resolveSchematicRefs(e)}addSchematicsToCompLibrary(e){for(let t of[...this.builtinSchematics.values(),...this.customSchematics.values()])if(t.compArgs){let o=(0,l.n6)(t.id,t.name,t.model.mainSchematic,t.compArgs);e.addLibraryItem(o)}}addLocalSchematics(e){for(let t of a)this.builtinSchematics.set(t.id,this.lsSchematicToSchematicDef(t,e))}deleteCustomSchematic(e){this.customSchematics.delete(e),localStorage.removeItem(this.schematicLocalStorageKey(e))}getSchematic(e){return this.builtinSchematics.get(e)||this.customSchematics.get(e)}readFromLocalStorage(e){let t=this.customSchematics;(0,n.hB)((o,n)=>{let i;if(o.startsWith("schematic-")){try{i=JSON.parse(n)}catch(e){console.error("Error parsing schematic ".concat(o,": ").concat(e));return}i&&t.set(i.id,this.lsSchematicToSchematicDef(i,e))}}),this.localStorageSchematicsLoaded=!0}lsSchematicToSchematicDef(e,t){var o,n;let l=(o=e.compArgs)?{size:new i.AO(o.w,o.h),ports:o.ports.map(e=>({id:e.id,name:e.name,type:e.type,pos:new i.AO(e.x,e.y),width:e.width}))}:null,a=(0,d.c4)();return(a=(0,r.oo)(a,e.model,t)).mainSchematic=(n=a.mainSchematic,l?(0,s.v4)(n,{compSize:l.size,compPorts:l.ports}):n),a.mainSchematic.id=e.id,a.mainSchematic.name=e.name,{id:e.id,name:e.name,model:a,compArgs:l||void 0,hasEdits:!1,schematicStr:""}}resolveSchematicRefs(e){for(let t of this.customSchematics.values())for(let o=0;o<t.model.mainSchematic.comps.length;o++){let n=t.model.mainSchematic.comps[o];if(!n.resolved){let i=e.create(n.defId,n.args);if(i.id=n.id,i.pos=n.pos,!i.resolved){console.error("Schematic ".concat(t.id," references unknown component ").concat(n.defId));continue}t.model.mainSchematic.comps[o]=i}}}addCustomSchematic(e){let t="c-".concat(Math.random().toString(36).substring(2,10)),o={id:t,name:e,model:(0,d.c4)(),hasEdits:!1};return o.model.mainSchematic.id=t,this.customSchematics.set(t,o),this.saveToLocalStorage(o.id),o}saveToLocalStorage(e){let t=this.customSchematics.get(e);if(t){let o=u(e,t.model);localStorage.setItem(this.schematicLocalStorageKey(t.id),JSON.stringify(o))}else this.builtinSchematics.get(e)||console.error("Schematic ".concat(e," not found"))}async saveToFile(e,t){let o=JSON.stringify(u(e,t)),n=(0,r.u1)(t.mainSchematic),i=(t.mainSchematic.name||e).replace(/[^a-z0-9]/gi,"_").toLowerCase().replace(/[_ ^]([a-z])/g,e=>e[1].toUpperCase()),s='\nimport { ILSSchematic } from "@/src/cpu/schematics/SchematicLibrary";\nexport const '.concat(i,"Schematic: ILSSchematic = ").concat(o,";\n\nexport const ").concat(i,"SchematicStr = `").concat(n,"`;\n");await fetch("/cpu/api/save-schematic-to-file?filename=".concat(i),{method:"POST",headers:{"Content-Type":"text/plain"},body:s})}schematicLocalStorageKey(e){return"schematic-".concat(e)}constructor(){this.builtinSchematics=new Map,this.customSchematics=new Map,this.localStorageSchematicsLoaded=!1}}function u(e,t){return{id:e,name:t.mainSchematic.name,model:(0,r.vz)(t.mainSchematic),compArgs:function(e){let t=e.mainSchematic;if(!(.001>t.compSize.len()))return{w:t.compSize.x,h:t.compSize.y,ports:t.compPorts.map(e=>({id:e.id,name:e.name,type:e.type,x:e.pos.x,y:e.pos.y,width:e.width}))}}(t)}}},6679:function(e,t,o){"use strict";o.d(t,{h:function(){return s}});var n=o(7437),i=o(1396),r=o.n(i);o(2265);let s=e=>{let{title:t,children:o}=e;return(0,n.jsxs)("div",{className:"flex justify-between items-center px-2 py-1 bg-blue-950 text-white h-[2.5rem] flex-shrink-0",children:[(0,n.jsx)("div",{className:"flex items-center",children:o}),t&&(0,n.jsx)("div",{className:"text-2xl",children:t}),(0,n.jsx)("div",{className:"hover:underline",children:(0,n.jsx)(r(),{href:"/",children:"Home"})})]})}},2343:function(e,t,o){"use strict";o.d(t,{t:function(){return i}});var n=o(9158);class i{mul(e){return new i(this.a*e.a+this.c*e.b,this.b*e.a+this.d*e.b,this.a*e.c+this.c*e.d,this.b*e.c+this.d*e.d,this.a*e.e+this.c*e.f+this.e,this.b*e.e+this.d*e.f+this.f)}inv(){let e=1/(this.a*this.d-this.b*this.c);return new i(this.d*e,-this.b*e,-this.c*e,this.a*e,(this.c*this.f-this.d*this.e)*e,(this.b*this.e-this.a*this.f)*e)}mulVec3(e){return new n.AO(this.a*e.x+this.c*e.y+this.e,this.b*e.x+this.d*e.y+this.f,e.z)}mulVec3Inv(e){let t=1/(this.a*this.d-this.b*this.c),o=e.x-this.e,i=e.y-this.f;return new n.AO((this.d*o-this.b*i)*t,(this.a*i-this.c*o)*t,e.z)}mulBb(e){return new n.bR(this.mulVec3(e.min),this.mulVec3(e.max))}mulBbInv(e){return new n.bR(this.mulVec3Inv(e.min),this.mulVec3Inv(e.max))}toTransformParams(){return[this.a,this.b,this.c,this.d,this.e,this.f]}static identity(){return new i}static translateVec(e){return new i(1,0,0,1,e.x,e.y)}static scale1(e){return new i(e,0,0,e,0,0)}static scaleVec(e){return new i(e.x,0,0,e.y,0,0)}static translateScale(e,t,o,n){return new i(o,0,0,n,e,t)}static multiply(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];let n=t[0];for(let e=1;e<t.length;++e)n=n.mul(t[e]);return n}constructor(e=1,t=0,o=0,n=1,i=0,r=0){this.a=e,this.b=t,this.c=o,this.d=n,this.e=i,this.f=r}}},1969:function(e,t,o){"use strict";o.d(t,{z:function(){return l}});var n=o(7437),i=o(2265),r=o(9225),s=o(7042);let l=(0,i.memo)(function(e){let{className:t}=e;return(0,n.jsx)(r.h_,{children:(0,n.jsx)("div",{className:(0,s.Z)("fixed inset-0 z-50 pointer-events-auto",t)})})})},2484:function(e,t,o){"use strict";o.d(t,{u:function(){return m}});var n,i,r,s,l=o(7437),a=o(2265),d=o(9225),c=o(7042),u=o(5064),p=o(9107);(n=r||(r={}))[n.Top=1]="Top",n[n.Right=2]="Right",n[n.Left=4]="Left",n[n.Bottom=8]="Bottom",n[n.TopStart=16|n.Top]="TopStart",n[n.TopEnd=32|n.Top]="TopEnd",n[n.BottomStart=16|n.Bottom]="BottomStart",n[n.BottomEnd=32|n.Bottom]="BottomEnd",n[n.LeftStart=16|n.Left]="LeftStart",n[n.LeftEnd=32|n.Left]="LeftEnd",n[n.RightStart=16|n.Right]="RightStart",n[n.RightEnd=32|n.Right]="RightEnd",(i=s||(s={}))[i.Gray=0]="Gray";let m=e=>{let{tip:t,className:o,pos:n=r.Bottom,tipStyle:i=s.Gray,arrow:m=!0,children:f}=e,[h,x]=(0,a.useState)(!1),[g,y]=(0,a.useState)(null),[v,b]=(0,a.useState)(null),[S,w]=(0,a.useState)({});(0,u.T)(h?g:null,()=>{w(e=>(0,p.v4)(e,{targetBcr:null==g?void 0:g.getBoundingClientRect()}))}),(0,u.T)(h&&g?v:null,()=>{w(e=>(0,p.v4)(e,{tooltipBcr:null==v?void 0:v.getBoundingClientRect()}))});let{tooltipStyle:I,arrowStyle:C}=(0,a.useMemo)(()=>{if(!h||!S.targetBcr||!S.tooltipBcr)return{};let e=S.targetBcr,t=S.tooltipBcr,o=!!(n&r.Bottom),i=!!(16&n),s=!!(32&n),l=i?e.left:s?e.right-t.width:e.left+e.width/2-t.width/2,a=o?e.bottom+14:e.top-t.height-14;l=(0,p.uZ)(l,8,window.innerWidth-t.width-8);let d=i?e.left+8:s?e.right-8:e.left+e.width/2,c=(0,p.uZ)(d-l,8,t.width-8),u=o?1:t.height;return{tooltipStyle:{visibility:"visible",transform:"translate(".concat(l,"px, ").concat(a,"px)")},arrowStyle:{transform:"translate(-50%, -100%) translate(".concat(c,"px, ").concat(u,"px)")}}},[S,h,n]);return(0,l.jsxs)(l.Fragment,{children:[a.cloneElement(a.Children.only(f),{onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),ref:y}),h&&(0,l.jsx)(d.h_,{children:(0,l.jsxs)("div",{ref:b,className:(0,c.Z)(o,"invisible absolute pointer-events-auto flex justify-center items-center z-0 min-h-[2.5rem] rounded px-3 py-1 min-w-[2.5rem] shadow-lg",i===s.Gray&&"bg-gray-600 text-white"),style:I,children:[t,m&&(0,l.jsx)("div",{className:(0,c.Z)("absolute w-0 h-0 top-0 left-0 origin-center border-8 z-[1] shadow-lg",i===s.Gray&&"border-gray-600",n&r.Bottom&&"border-t-transparent border-l-transparent border-r-transparent"),style:C})]})})]})}},5829:function(e){"use strict";e.exports={content:["./src/**/*.{html,tsx}"],theme:{extend:{}},plugins:[]}},5945:function(e){e.exports={exampleView:"CompExampleView_exampleView__YNvvo",header:"CompExampleView_header__NiisV",body:"CompExampleView_body__ejAPo",entry:"CompExampleView_entry__ZImOR",divider:"CompExampleView_divider__uYgex",btn:"CompExampleView_btn__d1qh_",reloadBtn:"CompExampleView_reloadBtn__geR9u"}},9611:function(e){e.exports={libraryView:"CompLibraryView_libraryView__ai9XH",header:"CompLibraryView_header__oNb05",body:"CompLibraryView_body__5yhHo",entry:"CompLibraryView_entry__nWrNg"}},8035:function(e){e.exports={canvasWrap:"CpuCanvas_canvasWrap__6tK8U",canvas:"CpuCanvas_canvas__OVzQd",canvasEventSurface:"CpuCanvas_canvasEventSurface__y8I_h",toolsLeftTop:"CpuCanvas_toolsLeftTop__PPlvK",compDomElements:"CpuCanvas_compDomElements__8fzbz",compDomElementsInner:"CpuCanvas_compDomElementsInner__LkAII",compDomEventMask:"CpuCanvas_compDomEventMask__GVjxJ"}},8122:function(e){e.exports={hoverDisplay:"HoverDisplay_hoverDisplay__9Qo5P",numVal:"HoverDisplay_numVal__nROBg",hexVal:"HoverDisplay_hexVal__HNS2h",bitVal:"HoverDisplay_bitVal__BbL5C",compId:"HoverDisplay_compId__0PWXt",bitWidth:"HoverDisplay_bitWidth__wp3I0"}},9965:function(e){e.exports={baseComp:"CompStyles_baseComp__MsInX",rectComp:"CompStyles_rectComp__w8Btj",memTable:"CompStyles_memTable__Bfa8P",memRow:"CompStyles_memRow__sadPT",memRowAddr:"CompStyles_memRowAddr__ihs4N",memRowBytes:"CompStyles_memRowBytes__LGBva",allZeros:"CompStyles_allZeros__p2RqS",memRowByte:"CompStyles_memRowByte__U_vpL",byteRead:"CompStyles_byteRead__hh8TN",byteWrite:"CompStyles_byteWrite__XazFV",addrInput:"CompStyles_addrInput__0P4V_",inputNumber:"CompStyles_inputNumber__7yyVH",configMenuTopRight:"CompStyles_configMenuTopRight__ZfWya",inputNumber_configMenu:"CompStyles_inputNumber_configMenu__4L48g",compPopup:"CompStyles_compPopup__0CpBs",configMenuBtn:"CompStyles_configMenuBtn__epbEv",menuRow:"CompStyles_menuRow__QNGdo",title:"CompStyles_title__gOcAl",compAddressing:"CompStyles_compAddressing__DiWlT",compLedOutputSimple:"CompStyles_compLedOutputSimple__yjlib",ledOutput:"CompStyles_ledOutput__2fvHJ",ledOutputBit:"CompStyles_ledOutputBit__Wrsar",enabled:"CompStyles_enabled__mo3B6",compRegFileCtrl:"CompStyles_compRegFileCtrl__xbgWd",compBinGate:"CompStyles_compBinGate__KO2YZ",regSelect:"CompStyles_regSelect__2TQs_",text:"CompStyles_text__oHJZq",regHex:"CompStyles_regHex__KuwiW"}},449:function(e){e.exports={hexValueEditor:"HexValueEditor_hexValueEditor__esrQu",prefix:"HexValueEditor_prefix__9THK5",input:"HexValueEditor_input__P1ly_",readonly:"HexValueEditor_readonly__IXzXd",minimal:"HexValueEditor_minimal__VjDPd",invalid:"HexValueEditor_invalid__fkpdr"}},3915:function(e){e.exports={libraryView:"SchematicLibraryView_libraryView__Tk5z4",header:"SchematicLibraryView_header__suC_f",entry:"SchematicLibraryView_entry__zyAkt",name:"SchematicLibraryView_name__fwIqk",divider:"SchematicLibraryView_divider__miBJE",btn:"SchematicLibraryView_btn__gpiWg",btnIcon:"SchematicLibraryView_btnIcon__vuLFd",input:"SchematicLibraryView_input__Fbz72"}}}]);
//# sourceMappingURL=331-65b6c1f6d727812e.js.map